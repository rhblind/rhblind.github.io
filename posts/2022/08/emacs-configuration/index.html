<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="[Rolf Håvard Blindheim]"><meta name=description content="View on GitHub I wish I knew an inspirational quote to put here&amp;hellip;
Introduction Since everybody seems to be writing literate Emacs configs these days, I&amp;rsquo;m not going to be any worse! I&amp;rsquo;m not really very proficient on elisp, so this config is mostly a collection of code I&amp;rsquo;ve stolen from others.
I&amp;rsquo;ve been using a lots of different coding environments over the years, but they all seems to be missing some kind of crucial functionality."><meta name=keywords content=",org-mode"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://rhblind.github.io/posts/2022/08/emacs-configuration/><title>Emacs Configuration :: The stupid blog</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=https://rhblind.github.io/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css><link rel=apple-touch-icon sizes=180x180 href=https://rhblind.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://rhblind.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://rhblind.github.io/favicon-16x16.png><link rel=manifest href=https://rhblind.github.io/site.webmanifest><link rel=mask-icon href=https://rhblind.github.io/safari-pinned-tab.svg color><link rel="shortcut icon" href=https://rhblind.github.io/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Emacs Configuration"><meta itemprop=description content="View on GitHub I wish I knew an inspirational quote to put here&mldr;
Introduction Since everybody seems to be writing literate Emacs configs these days, I&rsquo;m not going to be any worse! I&rsquo;m not really very proficient on elisp, so this config is mostly a collection of code I&rsquo;ve stolen from others.
I&rsquo;ve been using a lots of different coding environments over the years, but they all seems to be missing some kind of crucial functionality."><meta itemprop=dateModified content="2022-08-15T00:06:20+02:00"><meta itemprop=wordCount content="11217"><meta itemprop=image content="https://rhblind.github.io/"><meta itemprop=keywords content="org-mode,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rhblind.github.io/"><meta name=twitter:title content="Emacs Configuration"><meta name=twitter:description content="View on GitHub I wish I knew an inspirational quote to put here&mldr;
Introduction Since everybody seems to be writing literate Emacs configs these days, I&rsquo;m not going to be any worse! I&rsquo;m not really very proficient on elisp, so this config is mostly a collection of code I&rsquo;ve stolen from others.
I&rsquo;ve been using a lots of different coding environments over the years, but they all seems to be missing some kind of crucial functionality."><meta property="og:title" content="Emacs Configuration"><meta property="og:description" content="View on GitHub I wish I knew an inspirational quote to put here&mldr;
Introduction Since everybody seems to be writing literate Emacs configs these days, I&rsquo;m not going to be any worse! I&rsquo;m not really very proficient on elisp, so this config is mostly a collection of code I&rsquo;ve stolen from others.
I&rsquo;ve been using a lots of different coding environments over the years, but they all seems to be missing some kind of crucial functionality."><meta property="og:type" content="article"><meta property="og:url" content="https://rhblind.github.io/posts/2022/08/emacs-configuration/"><meta property="og:image" content="https://rhblind.github.io/"><meta property="article:section" content="posts"><meta property="article:modified_time" content="2022-08-15T00:06:20+02:00"><meta property="article:section" content="emacs"><meta property="article:published_time" content="2022-08-15 00:06:20 +0200 +0200"></head><body><div class=container><header class=header><span class=header__inner><a href=https://rhblind.github.io/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>$ cd ~</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://rhblind.github.io/about/>About</a></li><li><a href=https://rhblind.github.io/posts/>Posts</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>53 minutes</p></div><article><h1 class=post-title><a href=https://rhblind.github.io/posts/2022/08/emacs-configuration/>Emacs Configuration</a></h1><hr><aside id=toc><div class=toc-title>Table of Contents</div><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#references>References</a></li><li><a href=#configuration>Configuration</a><ul><li><a href=#personal-preferences-the-random-config-dumping-ground>Personal preferences - The random config dumping ground</a></li><li><a href=#better-defaults>Better defaults</a></li><li><a href=#gpg-ssh-and-encryption>GPG, SSH and encryption</a></li><li><a href=#keybindings>Keybindings</a></li><li><a href=#doom-configuration>Doom configuration</a></li><li><a href=#visual-settings>Visual settings</a></li><li><a href=#other-things>Other things</a></li></ul></li><li><a href=#packages>Packages</a><ul><li><a href=#loading-instructions>Loading instructions</a></li><li><a href=#tools>Tools</a></li><li><a href=#visuals>Visuals</a></li></ul></li><li><a href=#language-configurations>Language configurations</a><ul><li><a href=#general>General</a></li><li><a href=#yaml>Yaml</a></li><li><a href=#plaintext>Plaintext</a></li><li><a href=#org>Org</a></li><li><a href=#web-javascript-typescript>Web/Javascript/Typescript</a></li><li><a href=#python>Python</a></li><li><a href=#elixir>Elixir</a></li><li><a href=#dotnet>Dotnet</a></li><li><a href=#rust>Rust</a></li></ul></li></ul></nav></aside><hr><div class=post-content><a href=https://github.com/rhblind/.doom.d target=_blank rel=noopener title=Github style=display:inline-flex;gap:.5em><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align:sub"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>View on GitHub</a><blockquote><p>I wish I knew an inspirational quote to put here&mldr;</p></blockquote><h2 id=introduction>Introduction</h2><p>Since everybody seems to be writing literate Emacs configs these days, I&rsquo;m not going to be any worse!
I&rsquo;m not really very proficient on <code>elisp</code>, so this config is mostly a collection of code I&rsquo;ve stolen from others.</p><p>I&rsquo;ve been using a lots of different coding environments over the years, but they all seems to be missing some
kind of crucial functionality. In my opinion Emacs is far from perfect, it just sucks a bit less than the others :)</p><p>I have always been using Vim for quick edits of random files, and are really fond of modal editing. So when I
decided to learn using Emacs, I was looking for a way to continue doing so. That lead me to the <a href=https://www.spacemacs.org/>Spacemacs</a>
distribution, which I was quite happy with for some time. However, I kept reading about this <a href=https://github.com/doomemacs/doomemacs>Doom Emacs</a>
that claimed to have an easier configuration scheme, faster startup times, and a lot of other good stuff.
So, one day I decided to give it a try (I don&rsquo;t regret it).</p><p>Lastly, since this document literally is my Emacs configuration, at times it may contain code that is a
work in progress, silly comments, <code>TODO</code> and <code>FIXME</code> comments and so on.</p><h2 id=references>References</h2><p>As many others I&rsquo;ve been using <a href=https://tecosaur.github.io/emacs-config/config.html>tecosaurs Emacs config</a> as my base configuration. It&rsquo;s one of the most
elaborated literate configs I&rsquo;ve seen, with a lot of nice little tweaks. My configuration broadly follows his,
but it&rsquo;s slowly morphing into my own :)</p><p>So a big thanks to tecosaur for making my onboarding to Doom Emacs a smooth experience!</p><h2 id=configuration>Configuration</h2><p>Remember to run <code>doom sync</code> after modifiyng this file.
Make this file run (slighty) faster with lexical binding (I read it on the internet)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;;; config.el -*- lexical-binding: t; -*-</span>
</span></span></code></pre></div><h3 id=personal-preferences-the-random-config-dumping-ground>Personal preferences - The random config dumping ground</h3><p>Me</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq <span style=color:#a6e22e>user-full-name</span> <span style=color:#e6db74>&#34;Rolf Håvard Blindheim&#34;</span>
</span></span><span style=display:flex><span>      user-mail-address <span style=color:#e6db74>&#34;rhblind@gmail.com&#34;</span>)
</span></span></code></pre></div><p>Some functionality uses this to identify you, e.g. GPG configuration, email
clients, file templates and snippets.</p><p>And some random stuff that doesn&rsquo;t fit into any particual category</p><h3 id=better-defaults>Better defaults</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq auto-save-default         <span style=color:#66d9ef>t</span>         <span style=color:#75715e>; I don&#39;t want to lose work</span>
</span></span><span style=display:flex><span>      delete-by-moving-to-trash <span style=color:#66d9ef>t</span>         <span style=color:#75715e>; Delete files to trash</span>
</span></span><span style=display:flex><span>      display-time-24hr-format  <span style=color:#66d9ef>t</span>         <span style=color:#75715e>; I dont know the difference between AM and PM</span>
</span></span><span style=display:flex><span>      evil-want-fine-undo       <span style=color:#66d9ef>t</span>         <span style=color:#75715e>; More granular undos in evil insert mode</span>
</span></span><span style=display:flex><span>      evil-ex-substitute-global <span style=color:#66d9ef>t</span>         <span style=color:#75715e>; More often than not, I want /s on ex commands</span>
</span></span><span style=display:flex><span>      evil-kill-on-visual-paste <span style=color:#66d9ef>nil</span>       <span style=color:#75715e>; Don&#39;t add overwritten text in visual mode to the kill ring</span>
</span></span><span style=display:flex><span>      scroll-margin             <span style=color:#ae81ff>2</span>         <span style=color:#75715e>; Keep a little scroll margin</span>
</span></span><span style=display:flex><span>      undo-limit                <span style=color:#ae81ff>16000000</span>  <span style=color:#75715e>; Increase undo limit to 16Mb</span>
</span></span><span style=display:flex><span>      vc-follow-symlinks        <span style=color:#66d9ef>nil</span>       <span style=color:#75715e>; Don&#39;t follow symlinks, edit them directly</span>
</span></span><span style=display:flex><span>      which-key-idle-delay      <span style=color:#ae81ff>0.2</span>       <span style=color:#75715e>; Feels which-key feels more responsive</span>
</span></span><span style=display:flex><span>      window-combination-resize <span style=color:#66d9ef>t</span>         <span style=color:#75715e>; Take new window space from all other windows (not just the current)</span>
</span></span><span style=display:flex><span>      x-stretch-cursor          <span style=color:#66d9ef>t</span>         <span style=color:#75715e>; Stretch cursor to the glyph width</span>
</span></span><span style=display:flex><span>      )
</span></span></code></pre></div><p>Some modes I always want active</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(display-time-mode              <span style=color:#ae81ff>1</span>)        <span style=color:#75715e>; I want to know what time it is</span>
</span></span><span style=display:flex><span>(drag-stuff-global-mode         <span style=color:#ae81ff>1</span>)        <span style=color:#75715e>; Drag text around</span>
</span></span><span style=display:flex><span>(global-company-mode            <span style=color:#ae81ff>1</span>)        <span style=color:#75715e>; Enable autocomplete all over</span>
</span></span><span style=display:flex><span>(global-subword-mode            <span style=color:#ae81ff>1</span>)        <span style=color:#75715e>; Iterate through CamelCase words - Not sure how I like this</span>
</span></span><span style=display:flex><span>(smartparens-global-mode        <span style=color:#ae81ff>1</span>)        <span style=color:#75715e>; Always enable smartparens</span>
</span></span><span style=display:flex><span>(smartparens-global-strict-mode <span style=color:#ae81ff>1</span>)        <span style=color:#75715e>; And keep it strict</span>
</span></span><span style=display:flex><span>(ws-butler-global-mode          <span style=color:#ae81ff>1</span>)        <span style=color:#75715e>; Unobtrusive way to trim spaces on end of lines</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (unless (string-match-p &#34;^Power N/A&#34; (battery))         ; On laptops...  FIXME - gives me error when running `doom doctor&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;   (display-battery-mode 1))                             ; it&#39;s nice to know how much power you have</span>
</span></span></code></pre></div><p>I like to have the local leader key bound to <code>,</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq doom-localleader-key      <span style=color:#e6db74>&#34;,&#34;</span>
</span></span><span style=display:flex><span>      doom-localleader-alt-key  <span style=color:#e6db74>&#34;M-,&#34;</span>)
</span></span></code></pre></div><h4 id=frame>Frame</h4><p>Configure default size for new Emacs frames. I&rsquo;m usually at 1440p display size,
so this seems reasonable.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;default-frame-alist</span> <span style=color:#f92672>&#39;</span>(height <span style=color:#f92672>.</span> <span style=color:#ae81ff>72</span>))
</span></span><span style=display:flex><span>(add-to-list <span style=color:#e6db74>&#39;default-frame-alist</span> <span style=color:#f92672>&#39;</span>(width <span style=color:#f92672>.</span> <span style=color:#ae81ff>240</span>))
</span></span></code></pre></div><h4 id=windows>Windows</h4><p>I find it rather handy to be asked which buffer I want to see after splitting
the window. Let&rsquo;s make that happen.</p><p>First, we&rsquo;ll enter the new window</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq evil-vsplit-window-right <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      evil-split-window-below <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><p>Then, we&rsquo;ll pull up a buffer prompt.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defadvice! prompt-for-buffer (<span style=color:#66d9ef>&amp;rest</span> _)
</span></span><span style=display:flex><span>  :after <span style=color:#f92672>&#39;</span>(evil-window-split evil-window-vsplit)
</span></span><span style=display:flex><span>  (consult-buffer))
</span></span></code></pre></div><h4 id=buffers>Buffers</h4><ul><li><p>Text scaling</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :n <span style=color:#e6db74>&#34;C-+&#34;</span>          <span style=color:#a6e22e>#&#39;</span>text-scale-increase   <span style=color:#75715e>; Increase buffer font</span>
</span></span><span style=display:flex><span>      :n <span style=color:#e6db74>&#34;C--&#34;</span>          <span style=color:#a6e22e>#&#39;</span>text-scale-decrease   <span style=color:#75715e>; Decrease buffer font</span>
</span></span><span style=display:flex><span>      :n <span style=color:#e6db74>&#34;C-0&#34;</span>          <span style=color:#a6e22e>#&#39;</span>doom/reset-font-size) <span style=color:#75715e>; Reset all font sizes</span>
</span></span></code></pre></div></li></ul><h4 id=hacks>Hacks</h4><ul><li><p>Too many open files</p><p>Sometimes I&rsquo;m getting the dreaded &ldquo;Too many open files&rdquo; error in Emacs, which doesn&rsquo;t seem to take into
account <code>ulimit</code>, nor <code>sysctl kern.maxfiles</code> / <code>sysctl kern.maxfilesperproc</code>.
If you know a workaround for this, please let me know!</p><p>Meanwhile, let&rsquo;s define a function that clears the existing file notification watches from Emacs as a workaround.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(require <span style=color:#e6db74>&#39;filenotify</span>)
</span></span><span style=display:flex><span>(defun file-notify-rm-all-watches (<span style=color:#66d9ef>&amp;optional</span> silent)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Remove all existing file notification watches from Emacs.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>When </span><span style=color:#e6db74>`silent&#39;</span><span style=color:#e6db74> is non-nil, don&#39;t activate the progress-reporter.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (if silent (<span style=color:#a6e22e>maphash</span> (lambda (key _value) (file-notify-rm-watch key)) file-notify-descriptors)
</span></span><span style=display:flex><span>    (let ((progress-reporter
</span></span><span style=display:flex><span>           (make-progress-reporter
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;Clearing all existing file notification watches... &#34;</span>))))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>maphash</span> (lambda (key _value) (file-notify-rm-watch key)) file-notify-descriptors)
</span></span><span style=display:flex><span>      (progress-reporter-done progress-reporter))))
</span></span></code></pre></div><p>So, whenever we&rsquo;re getting the &ldquo;Too many open files&rdquo; error in Emacs, just <code>M-x file-notify-rm-all-watches</code>,
and we should be good to go again.
Also, since this seems to be happening quite frequently (after enabling <code>tree-sitter-mode</code>?), I&rsquo;ll just put it on a timer for now.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; Run every 5 minutes</span>
</span></span><span style=display:flex><span>(run-with-timer <span style=color:#ae81ff>0</span> (<span style=color:#a6e22e>*</span> <span style=color:#ae81ff>5</span> <span style=color:#ae81ff>60</span>) <span style=color:#e6db74>&#39;file-notify-rm-all-watches</span> <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div></li></ul><h3 id=gpg-ssh-and-encryption>GPG, SSH and encryption</h3><p>For GPG I want to use <code>~/.authinfo.gpg</code> since I usually keep this file in my <a href=https://github.com/rhblind/dotfiles>dotfiles</a> repository. It&rsquo;s easy to
just copy it in place whenever I&rsquo;m on a new computer.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! epa
</span></span><span style=display:flex><span>  (setq auth-source-cache-expiry <span style=color:#66d9ef>nil</span>                            <span style=color:#75715e>; Don&#39;t expire cached auth sources.</span>
</span></span><span style=display:flex><span>        epa-file-select-keys     <span style=color:#66d9ef>nil</span>                            <span style=color:#75715e>; If non-nil, always asks user to select recipients.</span>
</span></span><span style=display:flex><span>        epa-file-cache-passphrase-for-symmetric-encryption <span style=color:#66d9ef>t</span>    <span style=color:#75715e>; Cache passphrase for symmetrical encryptions.</span>
</span></span><span style=display:flex><span>        epg-gpg-program (cond ((<span style=color:#a6e22e>eq</span> system-type <span style=color:#e6db74>&#39;darwin</span>)     <span style=color:#e6db74>&#34;/usr/local/bin/gpg&#34;</span>)
</span></span><span style=display:flex><span>                              ((<span style=color:#a6e22e>eq</span> system-type <span style=color:#e6db74>&#39;gnu/linux</span>)  <span style=color:#e6db74>&#34;/usr/bin/gpg&#34;</span>)
</span></span><span style=display:flex><span>                              ((<span style=color:#a6e22e>eq</span> system-type <span style=color:#e6db74>&#39;windows-nt</span>) <span style=color:#e6db74>&#34;C:/Program Files (x86)/GNU/GnuPG/gpg2&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (pinentry-start)
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; (load-file (expand-file-name &#34;secrets.el.gpg&#34; doom-private-dir)) ; This cause weird errors</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>; I&#39;m using gpg-agent instead of ssh-agent so we need to connect here.</span>
</span></span><span style=display:flex><span>(shell-command <span style=color:#e6db74>&#34;gpg-connect-agent updatestartuptty /bye &gt;/dev/null&#34;</span>)
</span></span></code></pre></div><h3 id=keybindings>Keybindings</h3><p>Here&rsquo;s some <a href=https://github.com/hlissner/doom-emacs/blob/master/modules/config/default/+evil-bindings.el>examples</a> on how to bind keymaps</p><h4 id=window-navigation>Window navigation</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! <span style=color:#e6db74>&#34;M-0&#34;</span>  <span style=color:#a6e22e>#&#39;</span>treemacs-select-window  <span style=color:#75715e>;; make treemacs accessible as Window #0</span>
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;M-1&#34;</span>  <span style=color:#a6e22e>#&#39;</span>winum-select-window-1
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;M-2&#34;</span>  <span style=color:#a6e22e>#&#39;</span>winum-select-window-2
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;M-3&#34;</span>  <span style=color:#a6e22e>#&#39;</span>winum-select-window-3
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;M-4&#34;</span>  <span style=color:#a6e22e>#&#39;</span>winum-select-window-4
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;M-5&#34;</span>  <span style=color:#a6e22e>#&#39;</span>winum-select-window-5
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;M-6&#34;</span>  <span style=color:#a6e22e>#&#39;</span>winum-select-window-6
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;M-7&#34;</span>  <span style=color:#a6e22e>#&#39;</span>winum-select-window-7
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;M-8&#34;</span>  <span style=color:#a6e22e>#&#39;</span>winum-select-window-8
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;M-9&#34;</span>  <span style=color:#a6e22e>#&#39;</span>winum-select-window-9)
</span></span></code></pre></div><h4 id=workspace-navigation>Workspace navigation</h4><p>Some of the default Doom workspace navigation keybindings seems a bit counter intuitive for
my workflow, so I rebind some of them.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :leader
</span></span><span style=display:flex><span>      (:when (featurep! :ui workspaces)
</span></span><span style=display:flex><span>       (:prefix-map (<span style=color:#e6db74>&#34;l&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;workspace&#34;</span>)         <span style=color:#75715e>; Rebind workspaces to SCP-l</span>
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Delete this workspace&#34;</span>           <span style=color:#e6db74>&#34;d&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/delete
</span></span><span style=display:flex><span>                                                <span style=color:#e6db74>&#34;.&#34;</span>   <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Switch to workspace&#34;</span>             <span style=color:#e6db74>&#34;l&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-to
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Load workspace from file&#34;</span>        <span style=color:#e6db74>&#34;L&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/load
</span></span><span style=display:flex><span>                                                <span style=color:#e6db74>&#34;]&#34;</span>   <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Next workspace&#34;</span>                  <span style=color:#e6db74>&#34;k&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-right
</span></span><span style=display:flex><span>                                                <span style=color:#e6db74>&#34;[&#34;</span>   <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Previous workspace&#34;</span>              <span style=color:#e6db74>&#34;j&#34;</span>   <span style=color:#a6e22e>#&#39;</span>+workspace/switch-left
</span></span><span style=display:flex><span>                                                <span style=color:#e6db74>&#34;`&#34;</span>   <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Cycle last workspace&#34;</span>            <span style=color:#e6db74>&#34;TAB&#34;</span> <span style=color:#a6e22e>#&#39;</span>+workspace/other)))
</span></span></code></pre></div><h4 id=buffer-navigation>Buffer navigation</h4><p>I really like cycling between two buffers using <code>SPC-Tab</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :leader :desc <span style=color:#e6db74>&#34;Cycle last buffer&#34;</span> <span style=color:#e6db74>&#34;TAB&#34;</span> <span style=color:#a6e22e>#&#39;</span>evil-switch-to-windows-last-buffer)     <span style=color:#75715e>; Use SPC-Tab to cycle between two last buffers</span>
</span></span></code></pre></div><p>I really like to move buffers around using <code>SPC-b [1..9]</code>.
The following functions are ported directly from <code>Spacemacs</code>, and relies only at <code>winum</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! winum
</span></span><span style=display:flex><span>  (defun move-buffer-to-window (windownum follow-focus-p)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Moves a buffer to a window, using the window numbering. follow-focus-p controls
</span></span></span><span style=display:flex><span><span style=color:#e6db74>whether focus moves to new window (with buffer), or stays on current.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (if (<span style=color:#a6e22e>&gt;</span> windownum (<span style=color:#a6e22e>length</span> (<span style=color:#a6e22e>window-list-1</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;No window numbered %s&#34;</span> windownum)
</span></span><span style=display:flex><span>      (let ((b (<span style=color:#a6e22e>current-buffer</span>))
</span></span><span style=display:flex><span>            (w1 (<span style=color:#a6e22e>selected-window</span>))
</span></span><span style=display:flex><span>            (w2 (winum-get-window-by-number windownum)))
</span></span><span style=display:flex><span>        (unless (<span style=color:#a6e22e>eq</span> w1 w2)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>set-window-buffer</span> w2 b)
</span></span><span style=display:flex><span>          (switch-to-prev-buffer)
</span></span><span style=display:flex><span>          (unrecord-window-buffer w1 b))
</span></span><span style=display:flex><span>        (when follow-focus-p
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>select-window</span> (winum-get-window-by-number windownum))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun swap-buffers-to-window (windownum follow-focus-p)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Swaps visible buffers between active window and selected window. follow-focus-p
</span></span></span><span style=display:flex><span><span style=color:#e6db74>controls whether focus moves to new window (with buffer), or stays on current.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (if (<span style=color:#a6e22e>&gt;</span> windownum (<span style=color:#a6e22e>length</span> (<span style=color:#a6e22e>window-list-1</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;No window numbered %s&#34;</span> windownum)
</span></span><span style=display:flex><span>      (let* ((b1 (<span style=color:#a6e22e>current-buffer</span>))
</span></span><span style=display:flex><span>             (w1 (<span style=color:#a6e22e>selected-window</span>))
</span></span><span style=display:flex><span>             (w2 (winum-get-window-by-number windownum))
</span></span><span style=display:flex><span>             (b2 (<span style=color:#a6e22e>window-buffer</span> w2)))
</span></span><span style=display:flex><span>        (unless (<span style=color:#a6e22e>eq</span> w1 w2)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>set-window-buffer</span> w1 b2)
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>set-window-buffer</span> w2 b1)
</span></span><span style=display:flex><span>          (unrecord-window-buffer w1 b1)
</span></span><span style=display:flex><span>          (unrecord-window-buffer w2 b2)))
</span></span><span style=display:flex><span>      (when follow-focus-p (winum-select-window-by-number windownum))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; define and evaluate three numbered functions</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; buffer-to-window-1 to 9</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; move-buffer-to-window-no-follow-1 to 9</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; swap-buffer-to-window-no-follow-1 to 9</span>
</span></span><span style=display:flex><span>  (dotimes (i <span style=color:#ae81ff>9</span>)
</span></span><span style=display:flex><span>    (let ((n (<span style=color:#a6e22e>+</span> i <span style=color:#ae81ff>1</span>)))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>eval</span> <span style=color:#f92672>`</span>(defun <span style=color:#f92672>,</span>(<span style=color:#a6e22e>intern</span> (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;buffer-to-window-%s&#34;</span> n)) (<span style=color:#66d9ef>&amp;optional</span> arg)
</span></span><span style=display:flex><span>               <span style=color:#f92672>,</span>(<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;Move buffer to window number %i.&#34;</span> n)
</span></span><span style=display:flex><span>               (interactive <span style=color:#e6db74>&#34;P&#34;</span>)
</span></span><span style=display:flex><span>               (if arg
</span></span><span style=display:flex><span>                   (swap-buffers-to-window <span style=color:#f92672>,</span>n <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>                 (move-buffer-to-window <span style=color:#f92672>,</span>n <span style=color:#66d9ef>t</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>eval</span> <span style=color:#f92672>`</span>(defun <span style=color:#f92672>,</span>(<span style=color:#a6e22e>intern</span> (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;move-buffer-to-window-no-follow-%s&#34;</span> n)) ()
</span></span><span style=display:flex><span>               (interactive)
</span></span><span style=display:flex><span>               (move-buffer-to-window <span style=color:#f92672>,</span>n <span style=color:#66d9ef>nil</span>)))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>eval</span> <span style=color:#f92672>`</span>(defun <span style=color:#f92672>,</span>(<span style=color:#a6e22e>intern</span> (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;swap-buffer-window-no-follow-%s&#34;</span> n)) ()
</span></span><span style=display:flex><span>               (interactive)
</span></span><span style=display:flex><span>               (swap-buffers-to-window <span style=color:#f92672>,</span>n <span style=color:#66d9ef>nil</span>))))))
</span></span></code></pre></div><p>Let&rsquo;s map the newly defined function to <code>SPC-b [1..9]</code> for easy access.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :leader
</span></span><span style=display:flex><span>      (:prefix-map (<span style=color:#e6db74>&#34;b&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;buffer&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Move buffer to window 1&#34;</span> <span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#a6e22e>#&#39;</span>buffer-to-window-1
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Move buffer to window 2&#34;</span> <span style=color:#e6db74>&#34;2&#34;</span> <span style=color:#a6e22e>#&#39;</span>buffer-to-window-2
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Move buffer to window 3&#34;</span> <span style=color:#e6db74>&#34;3&#34;</span> <span style=color:#a6e22e>#&#39;</span>buffer-to-window-3
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Move buffer to window 4&#34;</span> <span style=color:#e6db74>&#34;4&#34;</span> <span style=color:#a6e22e>#&#39;</span>buffer-to-window-4
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Move buffer to window 5&#34;</span> <span style=color:#e6db74>&#34;5&#34;</span> <span style=color:#a6e22e>#&#39;</span>buffer-to-window-5
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Move buffer to window 6&#34;</span> <span style=color:#e6db74>&#34;6&#34;</span> <span style=color:#a6e22e>#&#39;</span>buffer-to-window-6
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Move buffer to window 7&#34;</span> <span style=color:#e6db74>&#34;7&#34;</span> <span style=color:#a6e22e>#&#39;</span>buffer-to-window-7
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Move buffer to window 8&#34;</span> <span style=color:#e6db74>&#34;8&#34;</span> <span style=color:#a6e22e>#&#39;</span>buffer-to-window-8
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Move buffer to window 9&#34;</span> <span style=color:#e6db74>&#34;9&#34;</span> <span style=color:#a6e22e>#&#39;</span>buffer-to-window-9))
</span></span></code></pre></div><h4 id=jumping-around-with-avy>Jumping around with Avy</h4><p>Doom Emacs comes pre-configures with <code>avy</code> and it is pretty reasonable configured out of the box.
However, I never remember how to use it, so I&rsquo;ll jot down some notes here. Here&rsquo;s a quick
<a href="https://www.youtube.com/watch?v=zar4GsOBU0g">YouTube video</a> covering some basic usage.</p><p>The <strong>basics</strong></p><ul><li><code>g s</code> - Opens the prefix menu for doing jump navigation</li><li><code>g s</code> - Jump using <code>evil-avy-goto-char-2</code> requiring 2 characters before triggering</li><li><code>g s SPC</code> - Jump in closure using <code>evil-avy-goto-char-timer</code> requiring 1 character before triggering</li></ul><h4 id=misc>Misc</h4><p>Erase content of current buffer with <code>SPC-b e</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :leader
</span></span><span style=display:flex><span>      (:prefix-map (<span style=color:#e6db74>&#34;b&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;buffer&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Erase buffer&#34;</span> <span style=color:#e6db74>&#34;e&#34;</span> <span style=color:#a6e22e>#&#39;erase-buffer</span>))
</span></span></code></pre></div><p>Copy the entire buffer to kill-ring with <code>SPC-b Y</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun copy-buffer-to-clipboard ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Copy entire buffer to clipboard.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>This function is from stackoverflow.com (https://stackoverflow.com/a/10216310)&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (clipboard-kill-ring-save (<span style=color:#a6e22e>point-min</span>) (<span style=color:#a6e22e>point-max</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(map! :leader
</span></span><span style=display:flex><span>      (:prefix-map (<span style=color:#e6db74>&#34;b&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;buffer&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Copy buffer&#34;</span> <span style=color:#e6db74>&#34;Y&#34;</span> <span style=color:#a6e22e>#&#39;</span>copy-buffer-to-clipboard))
</span></span></code></pre></div><p>Copy clipboard and replace buffer with <code>SPC-b P</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun copy-clipboard-to-buffer ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Copy clipboard and replace buffer.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>This function is shamelessly stolen from spacemacs
</span></span></span><span style=display:flex><span><span style=color:#e6db74>(https://github.com/syl20bnr/spacemacs/blob/3ba43e29165fb17d39baab528d63a63e907fa81a/layers/%2Bspacemacs/spacemacs-defaults/funcs.el#L1272)&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>delete-region</span> (<span style=color:#a6e22e>point-min</span>) (<span style=color:#a6e22e>point-max</span>))
</span></span><span style=display:flex><span>  (clipboard-yank)
</span></span><span style=display:flex><span>  (deactivate-mark))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(map! :leader
</span></span><span style=display:flex><span>      (:prefix-map (<span style=color:#e6db74>&#34;b&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;buffer&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Paste clipboard&#34;</span> <span style=color:#e6db74>&#34;P&#34;</span> <span style=color:#a6e22e>#&#39;</span>copy-clipboard-to-buffer))
</span></span></code></pre></div><p>List processes</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :leader
</span></span><span style=display:flex><span>      :desc <span style=color:#e6db74>&#34;List processes&#34;</span> <span style=color:#e6db74>&#34;P&#34;</span> <span style=color:#a6e22e>#&#39;</span>list-processes)
</span></span></code></pre></div><h3 id=doom-configuration>Doom configuration</h3><p>In this section we generate the <code>init.el</code> file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;;; init.el -*- lexical-binding: t; -*-</span>
</span></span></code></pre></div><h4 id=sneaky-garbage-collection>Sneaky garbage collection</h4><p>Defer garbage collection further back in the startup process.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq gc-cons-threshold most-positive-fixnum)
</span></span></code></pre></div><p>Adopt a sneaky garbage collection strategy of waiting until idle time to collect;
staving off the collector while I&rsquo;m working.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook <span style=color:#e6db74>&#39;emacs-startup-hook</span> <span style=color:#a6e22e>#&#39;</span>(lambda ()
</span></span><span style=display:flex><span>                                  (setq gcmh-idle-delay  <span style=color:#e6db74>&#39;auto</span>                     <span style=color:#75715e>; or N seconds</span>
</span></span><span style=display:flex><span>                                        gcmh-high-cons-threshold (<span style=color:#a6e22e>*</span> <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>1024</span> <span style=color:#ae81ff>1024</span>)  <span style=color:#75715e>; 16mb</span>
</span></span><span style=display:flex><span>                                        gcmh-verbose <span style=color:#66d9ef>nil</span>)))
</span></span></code></pre></div><h4 id=load-prefer-newer>Load prefer newer</h4><p>Sometimes it&rsquo;s necessary to fix a bug, or otherwise change stuff in installed local packages.
Always load the newest version of a file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq load-prefer-newer <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><h4 id=doom-env>Doom Env</h4><p>Add some environmental variables to the <code>doom-env-whitelist</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(when noninteractive
</span></span><span style=display:flex><span>  (dolist (var <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;LANG&#34;</span> <span style=color:#e6db74>&#34;LC_TYPE&#34;</span> <span style=color:#e6db74>&#34;GPG_AGENT_INFO&#34;</span> <span style=color:#e6db74>&#34;SSH_AUTH_SOCK&#34;</span>))
</span></span><span style=display:flex><span>    (add-to-list <span style=color:#e6db74>&#39;doom-env-whitelist</span> var)))
</span></span></code></pre></div><p>This is required since I like to use <code>gpg-agent</code> over <code>ssh-agent</code> for key management, authentication and signing operations.</p><h4 id=modules>Modules</h4><p><a id=code-snippet--init.el></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(doom! :completion
</span></span><span style=display:flex><span>       &lt;&lt;doom-completion&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       :ui
</span></span><span style=display:flex><span>       &lt;&lt;doom-ui&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       :editor
</span></span><span style=display:flex><span>       &lt;&lt;doom-editor&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       :emacs
</span></span><span style=display:flex><span>       &lt;&lt;doom-emacs&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       :term
</span></span><span style=display:flex><span>       &lt;&lt;doom-term&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       :checkers
</span></span><span style=display:flex><span>       &lt;&lt;doom-checkers&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       :tools
</span></span><span style=display:flex><span>       &lt;&lt;doom-tools&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       :os
</span></span><span style=display:flex><span>       &lt;&lt;doom-os&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       :lang
</span></span><span style=display:flex><span>       &lt;&lt;doom-lang&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       :email
</span></span><span style=display:flex><span>       &lt;&lt;doom-email&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       :app
</span></span><span style=display:flex><span>       &lt;&lt;doom-app&gt;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       :config
</span></span><span style=display:flex><span>       &lt;&lt;doom-config&gt;&gt;)
</span></span></code></pre></div><ul><li><p>Structure</p><p><a id=code-snippet--doom-config></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>literate
</span></span><span style=display:flex><span>(default +bindings +smartparens)
</span></span></code></pre></div></li></ul><ul><li><p>Interface</p><p><a id=code-snippet--doom-completion></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(company            <span style=color:#75715e>; the ultimate code completion backend</span>
</span></span><span style=display:flex><span> +childframe)       <span style=color:#75715e>; ...when your children are better than you</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>;;helm             ; the *other* search engine for love and life</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>;;ido              ; the other *other* search engine...</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>;;ivy              ; a search engine for love and life</span>
</span></span><span style=display:flex><span> (vertico           <span style=color:#75715e>; the search engine of the future</span>
</span></span><span style=display:flex><span>  +icons)
</span></span></code></pre></div><p><a id=code-snippet--doom-ui></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;;deft              ; notational velocity for Emacs</span>
</span></span><span style=display:flex><span>doom                <span style=color:#75715e>; what makes DOOM look the way it does</span>
</span></span><span style=display:flex><span>doom-dashboard      <span style=color:#75715e>; a nifty splash screen for Emacs</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;doom-quit         ; DOOM quit-message prompts when you quit Emacs</span>
</span></span><span style=display:flex><span>(emoji +unicode)    <span style=color:#75715e>; 🙂</span>
</span></span><span style=display:flex><span>hl-todo             <span style=color:#75715e>; highlight TODO/FIXME/NOTE/DEPRECATED/HACK/REVIEW</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;hydra</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;indent-guides     ; highlighted indent columns</span>
</span></span><span style=display:flex><span>(ligatures +extra)  <span style=color:#75715e>; ligatures and symbols to make your code pretty again</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;minimap           ; show a map of the code on the side</span>
</span></span><span style=display:flex><span>modeline            <span style=color:#75715e>; snazzy, Atom-inspired modeline, plus API</span>
</span></span><span style=display:flex><span>nav-flash           <span style=color:#75715e>; blink cursor line after big motions</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;neotree           ; a project drawer, like NERDTree for vim</span>
</span></span><span style=display:flex><span>ophints             <span style=color:#75715e>; highlight the region an operation acts on</span>
</span></span><span style=display:flex><span>(popup
</span></span><span style=display:flex><span> +all +defaults)    <span style=color:#75715e>; tame sudden yet inevitable temporary windows</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; tabs             ; a tab bar for Emacs</span>
</span></span><span style=display:flex><span>treemacs            <span style=color:#75715e>; a project drawer, like neotree but cooler</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;unicode           ; extended unicode support for various languages</span>
</span></span><span style=display:flex><span>vc-gutter           <span style=color:#75715e>; vcs diff in the fringe</span>
</span></span><span style=display:flex><span>vi-tilde-fringe     <span style=color:#75715e>; fringe tildes to mark beyond EOB</span>
</span></span><span style=display:flex><span>(window-select
</span></span><span style=display:flex><span> +numbers)          <span style=color:#75715e>; visually switch windows</span>
</span></span><span style=display:flex><span>workspaces          <span style=color:#75715e>; tab emulation, persistence &amp; separate workspaces</span>
</span></span><span style=display:flex><span>zen                 <span style=color:#75715e>; distraction-free coding or writing</span>
</span></span></code></pre></div><p><a id=code-snippet--doom-editor></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(evil +everywhere)  <span style=color:#75715e>; come to the dark side, we have cookies</span>
</span></span><span style=display:flex><span>file-templates      <span style=color:#75715e>; auto-snippets for empty files</span>
</span></span><span style=display:flex><span>fold                <span style=color:#75715e>; (nigh) universal code folding</span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>format</span> +onsave)    <span style=color:#75715e>; automated prettiness</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;god               ; run Emacs commands without modifier keys</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;lispy             ; vim for lisp, for people who don&#39;t like vim</span>
</span></span><span style=display:flex><span>multiple-cursors    <span style=color:#75715e>; editing in many places at once</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;objed             ; text object editing for the innocent</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;parinfer          ; turn lisp into python, sort of</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;rotate-text       ; cycle region at point between text candidates</span>
</span></span><span style=display:flex><span>snippets            <span style=color:#75715e>; my elves. They type so I don&#39;t have to</span>
</span></span><span style=display:flex><span>word-wrap           <span style=color:#75715e>; soft wrapping with language-aware indent</span>
</span></span></code></pre></div><p><a id=code-snippet--doom-emacs></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(dired +icons)      <span style=color:#75715e>; making dired pretty [functional]</span>
</span></span><span style=display:flex><span>electric            <span style=color:#75715e>; smarter, keyword-based electric-indent</span>
</span></span><span style=display:flex><span>(ibuffer +icons)    <span style=color:#75715e>; interactive buffer management</span>
</span></span><span style=display:flex><span>(undo +tree)        <span style=color:#75715e>; persistent, smarter undo for your inevitable mistakes</span>
</span></span><span style=display:flex><span>vc                  <span style=color:#75715e>; version-control and Emacs, sitting in a tree</span>
</span></span></code></pre></div><p><a id=code-snippet--doom-term></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;;eshell            ; the elisp shell that works everywhere</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;shell             ; simple shell REPL for Emacs</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;term              ; basic terminal emulator for Emacs</span>
</span></span><span style=display:flex><span>vterm               <span style=color:#75715e>; the best terminal emulation in Emacs</span>
</span></span></code></pre></div><p><a id=code-snippet--doom-checkers></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>syntax              <span style=color:#75715e>; tasing you for every semicolon you forget</span>
</span></span><span style=display:flex><span>(:if                <span style=color:#75715e>; tasing you for misspelling mispelling</span>
</span></span><span style=display:flex><span> (executable-find <span style=color:#e6db74>&#34;aspell&#34;</span>) spell +aspell)
</span></span><span style=display:flex><span>grammar             <span style=color:#75715e>; tasing grammar mistake every you make</span>
</span></span></code></pre></div><p><a id=code-snippet--doom-tools></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;;ansible</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;biblio            ; Writes a PhD for you (citation needed)</span>
</span></span><span style=display:flex><span>(debugger
</span></span><span style=display:flex><span> +lsp)              <span style=color:#75715e>; FIXME stepping through code, to help you add bugs</span>
</span></span><span style=display:flex><span>direnv
</span></span><span style=display:flex><span>docker
</span></span><span style=display:flex><span>editorconfig        <span style=color:#75715e>; let someone else argue about tabs vs spaces</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;ein               ; tame Jupyter notebooks with emacs</span>
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>eval</span> +overlay)     <span style=color:#75715e>; run code, run (also, repls)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;gist              ; interacting with github gists</span>
</span></span><span style=display:flex><span>(lookup
</span></span><span style=display:flex><span> +dictionary
</span></span><span style=display:flex><span> +docsets)          <span style=color:#75715e>; navigate your code and its documentation</span>
</span></span><span style=display:flex><span>(lsp +peek)         <span style=color:#75715e>; M-x vscode</span>
</span></span><span style=display:flex><span>(magit
</span></span><span style=display:flex><span> +forge)            <span style=color:#75715e>; a git porcelain for Emacs</span>
</span></span><span style=display:flex><span>make                <span style=color:#75715e>; run make tasks from Emacs</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;pass              ; password manager for nerds</span>
</span></span><span style=display:flex><span>pdf                 <span style=color:#75715e>; pdf enhancements</span>
</span></span><span style=display:flex><span>prodigy             <span style=color:#75715e>; FIXME managing external services &amp; code builders</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;rgb               ; creating color strings</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;taskrunner        ; taskrunner for all your projects</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;terraform         ; infrastructure as code</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;tmux              ; an API for interacting with tmux</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;upload            ; map local to remote projects via ssh/ftp</span>
</span></span></code></pre></div><p><a id=code-snippet--doom-os></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(:if IS-MAC macos)  <span style=color:#75715e>; improve compatibility with macOS</span>
</span></span><span style=display:flex><span>tty                 <span style=color:#75715e>; improve the terminal Emacs experience</span>
</span></span></code></pre></div></li></ul><ul><li><p>Languages</p><p>Languages are (usually) not loaded until a file associated with it is opened.
Thus we can be pretty liberal with what we enable because there won&rsquo;t be much overhead.</p><p><a id=code-snippet--doom-lang></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;;agda              ; types of types of types of types...</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;beancount         ; mind the GAAP</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;(cc +lsp)         ; C &gt; C++ == 1</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;clojure           ; java with a lisp</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;common-lisp       ; if you&#39;ve seen one lisp, you&#39;ve seen them all</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;coq               ; proofs-as-programs</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;crystal           ; ruby at the speed of c</span>
</span></span><span style=display:flex><span>(csharp
</span></span><span style=display:flex><span> +dotnet
</span></span><span style=display:flex><span> +lsp)              <span style=color:#75715e>; unity, .NET, and mono shenanigans</span>
</span></span><span style=display:flex><span>data                <span style=color:#75715e>; config/data formats</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;(dart +flutter)   ; paint ui and not much else</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;dhall</span>
</span></span><span style=display:flex><span>(elixir +lsp)       <span style=color:#75715e>; erlang done right</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;elm               ; care for a cup of TEA?</span>
</span></span><span style=display:flex><span>emacs-lisp          <span style=color:#75715e>; drown in parentheses</span>
</span></span><span style=display:flex><span>(erlang +lsp)       <span style=color:#75715e>; an elegant language for a more civilized age</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;ess               ; emacs speaks statistics</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;factor</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;faust             ; dsp, but you get to keep your soul</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;fortran           ; in FORTRAN, GOD is REAL (unless declared INTEGER)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;fsharp            ; ML stands for Microsoft&#39;s Language</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;fstar             ; (dependent) types and (monadic) effects and Z3</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;gdscript          ; the language you waited for</span>
</span></span><span style=display:flex><span>(go +lsp)           <span style=color:#75715e>; the hipster dialect</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;(haskell +lsp)    ; a language that&#39;s lazier than I am</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;hy                ; readability of scheme w/ speed of python</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;idris             ; a language you can depend on</span>
</span></span><span style=display:flex><span>json                <span style=color:#75715e>; At least it ain&#39;t XML</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;(java +lsp)       ; the poster child for carpal tunnel syndrome</span>
</span></span><span style=display:flex><span>(javascript +lsp)   <span style=color:#75715e>; all(hope(abandon(ye(who(enter(here))))))</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;julia             ; a better, faster MATLAB</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;kotlin            ; a better, slicker Java(Script)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;latex             ; writing papers in Emacs has never been so fun</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;lean              ; for folks with too much to prove</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;ledger            ; be audit you can be</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;lua               ; one-based indices? one-based indices</span>
</span></span><span style=display:flex><span>markdown            <span style=color:#75715e>; writing docs for people to ignore</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;nim               ; python + lisp at the speed of c</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;nix               ; I hereby declare &#34;nix geht mehr!&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;ocaml             ; an objective camel</span>
</span></span><span style=display:flex><span>(org                <span style=color:#75715e>;organize your plain life in plain text</span>
</span></span><span style=display:flex><span> +pretty            <span style=color:#75715e>; yessss my pretties! (nice unicode symbols)</span>
</span></span><span style=display:flex><span> +dragndrop         <span style=color:#75715e>; drag &amp; drop files/images into org buffers</span>
</span></span><span style=display:flex><span> +hugo              <span style=color:#75715e>; use Emacs for hugo blogging</span>
</span></span><span style=display:flex><span> +noter             <span style=color:#75715e>; enhanced PDF notetaking</span>
</span></span><span style=display:flex><span> +jupyter           <span style=color:#75715e>; ipython/jupyter support for babel</span>
</span></span><span style=display:flex><span> +pandoc            <span style=color:#75715e>; export-with-pandoc support</span>
</span></span><span style=display:flex><span> +gnuplot           <span style=color:#75715e>; who doesn&#39;t like pretty pictures</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>;;+pomodoro        ; be fruitful with the tomato technique</span>
</span></span><span style=display:flex><span> +present           <span style=color:#75715e>; using org-mode for presentations</span>
</span></span><span style=display:flex><span> +roam2)            <span style=color:#75715e>; wander around notes</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;php               ; perl&#39;s insecure younger brother</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;plantuml          ; diagrams for confusing people more</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;purescript        ; javascript, but functional</span>
</span></span><span style=display:flex><span>(python             <span style=color:#75715e>; beautiful is better than ugly</span>
</span></span><span style=display:flex><span> +lsp
</span></span><span style=display:flex><span> +cython
</span></span><span style=display:flex><span> +poetry
</span></span><span style=display:flex><span> +pyright)
</span></span><span style=display:flex><span><span style=color:#75715e>;;qt                ; the &#39;cutest&#39; gui framework ever</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;racket            ; a DSL for DSLs</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;raku              ; the artist formerly known as perl6</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;rest              ; Emacs as a REST client</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;rst               ; ReST in peace</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;(ruby +rails)     ; 1.step {|i| p &#34;Ruby is #{i.even? ? &#39;love&#39; : &#39;life&#39;}&#34;}</span>
</span></span><span style=display:flex><span>(rust +lsp)         <span style=color:#75715e>; Fe2O3.unwrap().unwrap().unwrap().unwrap()</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;scala             ; java, but good</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;(scheme +guile)   ; a fully conniving family of lisps</span>
</span></span><span style=display:flex><span>sh                  <span style=color:#75715e>; she sells {ba,z,fi}sh shells on the C xor</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;sml</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;solidity          ; do you need a blockchain? No.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;swift             ; who asked for emoji variables?</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;terra             ; Earth and Moon in alignment for performance.</span>
</span></span><span style=display:flex><span>web                 <span style=color:#75715e>; the tubes</span>
</span></span><span style=display:flex><span>(yaml               <span style=color:#75715e>; JSON, but readable</span>
</span></span><span style=display:flex><span> +lsp)
</span></span><span style=display:flex><span><span style=color:#75715e>;;zig               ; C, but simpler</span>
</span></span></code></pre></div></li></ul><ul><li><p>Everything in Emacs</p><p><a id=code-snippet--doom-email></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;;(mu4e +org +gmail)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;notmuch</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;(wanderlust +gmail)</span>
</span></span></code></pre></div><p><a id=code-snippet--doom-app></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;;calendar</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;emms</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;everywhere        ; *leave* Emacs!? You must be joking</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;irc               ; how neckbeards socialize</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;(rss +org)        ; emacs as an RSS reader</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;twitter           ; twitter client https://twitter.com/vnought</span>
</span></span></code></pre></div></li></ul><h3 id=visual-settings>Visual settings</h3><h4 id=font-faces>Font Faces</h4><p>Cursor seems to not always load the correct color. Explicitly set it to whatever themes &ldquo;blue&rdquo; color is.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(custom-set-faces! <span style=color:#f92672>`</span>(cursor :background <span style=color:#f92672>,</span>(doom-color <span style=color:#e6db74>&#39;blue</span>)))
</span></span></code></pre></div><p>TODO: The &ldquo;history&rdquo; items in mini-buffers and eval-buffer is too pale. Needs better contrast.</p><p>Replace the &ldquo;modified&rdquo; buffer color in the modeline, so it doesn&rsquo;t look like something&rsquo;s wrong every time
we edit files.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(custom-set-faces! <span style=color:#f92672>`</span>(doom-modeline-buffer-modified :foreground <span style=color:#e6db74>&#34;Orange&#34;</span> :italic <span style=color:#66d9ef>t</span>))
</span></span></code></pre></div><h4 id=theme-and-modeline>Theme and modeline</h4><p>I like the Solarized Light theme, and doom has a pretty good version of it. But sometimes it&rsquo;s
nice to use a dark theme. Let&rsquo;s add favorite themes to a <code>doom-cycle-themes</code> list.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq doom-cycle-themes <span style=color:#f92672>&#39;</span>(doom-solarized-light  <span style=color:#75715e>;; a list of themes to cycle</span>
</span></span><span style=display:flex><span>                          doom-moonlight))
</span></span></code></pre></div><p>We&rsquo;ll use the first theme in the list as our default theme.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun cust/get-theme-name (theme)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Returns the name of </span><span style=color:#e6db74>`theme&#39;</span><span style=color:#e6db74>.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>If </span><span style=color:#e6db74>`theme&#39;</span><span style=color:#e6db74> is a list, return the first item in list.&#34;</span>
</span></span><span style=display:flex><span>  (if (<span style=color:#a6e22e>listp</span> theme) (<span style=color:#a6e22e>car</span> theme) theme))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(setq doom-theme (cust/get-theme-name doom-cycle-themes))
</span></span></code></pre></div><p>Add some functions to easily cycle through <code>doom-cycle-themes</code> list.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun cust/cycle-theme (<span style=color:#66d9ef>&amp;optional</span> backward)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Cycle through themes defined in </span><span style=color:#e6db74>`doom-cycle-themes&#39;</span><span style=color:#e6db74>.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>When </span><span style=color:#e6db74>`backward&#39;</span><span style=color:#e6db74> is non-nil, cycle the list backwards.&#34;</span>
</span></span><span style=display:flex><span>  (interactive <span style=color:#e6db74>&#34;P&#34;</span>)
</span></span><span style=display:flex><span>  (let* ((theme-names (<span style=color:#a6e22e>mapcar</span> <span style=color:#a6e22e>#&#39;</span>cust/get-theme-name doom-cycle-themes))
</span></span><span style=display:flex><span>         (themes (if backward (<span style=color:#a6e22e>reverse</span> theme-names) theme-names))
</span></span><span style=display:flex><span>         (next-theme (<span style=color:#a6e22e>car</span> (or (<span style=color:#a6e22e>cdr</span> (<span style=color:#a6e22e>memq</span> doom-theme themes))
</span></span><span style=display:flex><span>                              <span style=color:#75715e>;; if current theme isn&#39;t in cycleable themes,</span>
</span></span><span style=display:flex><span>                              <span style=color:#75715e>;; start over</span>
</span></span><span style=display:flex><span>                              themes))))
</span></span><span style=display:flex><span>    (when doom-theme
</span></span><span style=display:flex><span>      (disable-theme doom-theme))
</span></span><span style=display:flex><span>    (let ((progress-reporter
</span></span><span style=display:flex><span>           (make-progress-reporter
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;Loading theme %s... &#34;</span> next-theme))))
</span></span><span style=display:flex><span>      (load-theme next-theme <span style=color:#66d9ef>t</span> <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>      (progress-reporter-done progress-reporter))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun cust/cycle-theme-backward ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Cycle through themes defined in </span><span style=color:#e6db74>`doom-cycle-themes&#39;</span><span style=color:#e6db74> backwards.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (cust/cycle-theme <span style=color:#66d9ef>t</span>))
</span></span></code></pre></div><p>And finally add some keybindings to easily toggle them.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :leader
</span></span><span style=display:flex><span>      (:prefix-map (<span style=color:#e6db74>&#34;t&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;toggle&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Next theme&#34;</span>        <span style=color:#e6db74>&#34;t&#34;</span> <span style=color:#a6e22e>#&#39;</span>cust/cycle-theme
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;Previous theme&#34;</span>    <span style=color:#e6db74>&#34;T&#34;</span> <span style=color:#a6e22e>#&#39;</span>cust/cycle-theme-backward))
</span></span></code></pre></div><p>Slightly prettier default buffer names.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq +doom-dashboard-name <span style=color:#e6db74>&#34;► Doom&#34;</span>
</span></span><span style=display:flex><span>      doom-fallback-buffer-name <span style=color:#e6db74>&#34;► Doom&#34;</span>)
</span></span></code></pre></div><p>Add some extra bells and whistles to the Doom modeline.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq doom-modeline-icon                        (display-graphic-p)
</span></span><span style=display:flex><span>      doom-modeline-major-mode-icon             <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      doom-modeline-major-mode-color-icon       <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      doom-modeline-buffer-state-icon           <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><h4 id=fonts>Fonts</h4><p>I&rsquo;ll just keep the default config description around for now.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; Doom exposes five (optional) variables for controlling fonts in Doom:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; - `doom-font&#39; -- the primary font to use</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; - `doom-variable-pitch-font&#39; -- a non-monospace font (where applicable)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; - `doom-big-font&#39; -- used for `doom-big-font-mode&#39;; use this for</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;   presentations or streaming.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; - `doom-unicode-font&#39; -- for unicode glyphs</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; - `doom-serif-font&#39; -- for the `fixed-pitch-serif&#39; face</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; See &#39;C-h v doom-font&#39; for documentation and more examples of what they</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; accept. For example:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;(setq doom-font (font-spec :family &#34;Fira Code&#34; :size 12 :weight &#39;semi-light)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;      doom-variable-pitch-font (font-spec :family &#34;Fira Sans&#34; :size 13))</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; If you or Emacs can&#39;t find your font, use &#39;M-x describe-font&#39; to look them</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; up, `M-x eval-region&#39; to execute elisp code, and &#39;M-x doom/reload-font&#39; to</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; refresh your font settings. If Emacs still can&#39;t find your font, it likely</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; wasn&#39;t installed correctly. Font issues are rarely Doom issues!</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq doom-font (<span style=color:#a6e22e>font-spec</span> :family <span style=color:#e6db74>&#34;Fira Code&#34;</span> :size <span style=color:#ae81ff>13</span> :weight <span style=color:#e6db74>&#39;semi-light</span>)
</span></span><span style=display:flex><span>      doom-big-font (<span style=color:#a6e22e>font-spec</span> :family <span style=color:#e6db74>&#34;Fira Code&#34;</span> :size <span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>      doom-variable-pitch-font (<span style=color:#a6e22e>font-spec</span> :family <span style=color:#e6db74>&#34;Overpass&#34;</span> :size <span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>      doom-unicode-font (<span style=color:#a6e22e>font-spec</span> :family <span style=color:#e6db74>&#34;JuliaMono&#34;</span>)
</span></span><span style=display:flex><span>      doom-serif-font (<span style=color:#a6e22e>font-spec</span> :family <span style=color:#e6db74>&#34;IBM Plex Mono&#34;</span> :weight <span style=color:#e6db74>&#39;light</span>))
</span></span></code></pre></div><p>&ldquo;In addition to these fonts, Merriweather is used with nov.el, and Alegreya as a serifed proportional font used by mixed-pitch-mode for writeroom-mode with Org files.
Because we care about how things look let’s add a check to make sure we’re told if the system doesn’t have any of those fonts.&rdquo;</p><p><a id=code-snippet--detect-missing-fonts></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defvar required-fonts <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;JetBrainsMono.*&#34;</span> <span style=color:#e6db74>&#34;Overpass&#34;</span> <span style=color:#e6db74>&#34;JuliaMono&#34;</span> <span style=color:#e6db74>&#34;IBM Plex Mono&#34;</span> <span style=color:#e6db74>&#34;Merriweather&#34;</span> <span style=color:#e6db74>&#34;Alegreya&#34;</span>))
</span></span><span style=display:flex><span>(defvar available-fonts
</span></span><span style=display:flex><span>  (delete-dups (or (<span style=color:#a6e22e>font-family-list</span>)
</span></span><span style=display:flex><span>                   (split-string (shell-command-to-string <span style=color:#e6db74>&#34;fc-list : family&#34;</span>)
</span></span><span style=display:flex><span>                                 <span style=color:#e6db74>&#34;[,\n]&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defvar missing-fonts
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>delq</span> <span style=color:#66d9ef>nil</span> (<span style=color:#a6e22e>mapcar</span>
</span></span><span style=display:flex><span>             (lambda (font)
</span></span><span style=display:flex><span>               (unless (<span style=color:#a6e22e>delq</span> <span style=color:#66d9ef>nil</span> (<span style=color:#a6e22e>mapcar</span> (lambda (f)
</span></span><span style=display:flex><span>                                           (string-match-p (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;^%s$&#34;</span> font) f))
</span></span><span style=display:flex><span>                                         available-fonts))
</span></span><span style=display:flex><span>                 font))
</span></span><span style=display:flex><span>             required-fonts)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(if missing-fonts
</span></span><span style=display:flex><span>    (pp-to-string
</span></span><span style=display:flex><span>     <span style=color:#f92672>`</span>(unless noninteractive
</span></span><span style=display:flex><span>        (add-hook! <span style=color:#e6db74>&#39;doom-init-ui-hook</span>
</span></span><span style=display:flex><span>          (run-at-time <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                       (lambda ()
</span></span><span style=display:flex><span>                         (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;%s missing the following fonts: %s&#34;</span>
</span></span><span style=display:flex><span>                                  (<span style=color:#a6e22e>propertize</span> <span style=color:#e6db74>&#34;Warning!&#34;</span> <span style=color:#e6db74>&#39;face</span> <span style=color:#f92672>&#39;</span>(bold warning))
</span></span><span style=display:flex><span>                                  (<span style=color:#a6e22e>mapconcat</span> (lambda (font)
</span></span><span style=display:flex><span>                                               (<span style=color:#a6e22e>propertize</span> font <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;font-lock-variable-name-face</span>))
</span></span><span style=display:flex><span>                                             <span style=color:#e6db74>&#39;,missing-fonts</span>
</span></span><span style=display:flex><span>                                             <span style=color:#e6db74>&#34;, &#34;</span>))
</span></span><span style=display:flex><span>                         (<span style=color:#a6e22e>sleep-for</span> <span style=color:#ae81ff>0.5</span>))))))
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;;; No missing fonts detected!&#34;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>&lt;&lt;detect-missing-fonts()&gt;&gt;
</span></span></code></pre></div><h4 id=line-numbers>Line numbers</h4><p>Set default line number mode to <code>'relative</code>, and disable it for certain modes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq display-line-numbers-type <span style=color:#e6db74>&#39;relative</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (dolist (mode &#39;(org-mode-hook</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;                 term-mode-hook</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;                 shell-mode-hook)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;   (add-hook mode (lambda () (display-line-numbers-mode 0)))))</span>
</span></span></code></pre></div><h4 id=mixed-pitch>Mixed pitch</h4><blockquote><p>From the <code>:ui zen</code> module.</p></blockquote><p>We’d like to use mixed pitch in certain modes. If we simply add a hook, when directly opening a file with (a new) Emacs <code>mixed-pitch-mode runs</code>
before UI initialisation, which is problematic. To resolve this, we create a hook that runs after UI initialisation and both</p><ul><li>conditionally enables <code>mixed-pitch-mode</code></li><li>sets up the mixed pitch hooks</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defvar mixed-pitch-modes <span style=color:#f92672>&#39;</span>(org-mode LaTeX-mode markdown-mode gfm-mode Info-mode)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Modes that </span><span style=color:#e6db74>`mixed-pitch-mode&#39;</span><span style=color:#e6db74> should be enabled in, but only after UI initialisation.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun init-mixed-pitch-h ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Hook </span><span style=color:#e6db74>`mixed-pitch-mode&#39;</span><span style=color:#e6db74> into each mode in </span><span style=color:#e6db74>`mixed-pitch-modes&#39;</span><span style=color:#e6db74>.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Also immediately enables </span><span style=color:#e6db74>`mixed-pitch-modes&#39;</span><span style=color:#e6db74> if currently in one of the modes.&#34;</span>
</span></span><span style=display:flex><span>  (when (<span style=color:#a6e22e>memq</span> major-mode mixed-pitch-modes)
</span></span><span style=display:flex><span>    (mixed-pitch-mode <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>  (dolist (hook mixed-pitch-modes)
</span></span><span style=display:flex><span>    (add-hook (<span style=color:#a6e22e>intern</span> (<span style=color:#a6e22e>concat</span> (<span style=color:#a6e22e>symbol-name</span> hook) <span style=color:#e6db74>&#34;-hook&#34;</span>)) <span style=color:#a6e22e>#&#39;</span>mixed-pitch-mode)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#e6db74>&#39;doom-init-ui-hook</span> <span style=color:#a6e22e>#&#39;</span>init-mixed-pitch-h)
</span></span></code></pre></div><p>As mixed pitch uses the variable <code>mixed-pitch-face</code>, we can create a new function to apply mixed pitch with a serif face instead of the default.
This was created for writeroom mode.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(<span style=color:#a6e22e>autoload</span> <span style=color:#a6e22e>#&#39;</span>mixed-pitch-serif-mode <span style=color:#e6db74>&#34;mixed-pitch&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Change the default face of the current buffer to a serifed variable pitch, while keeping some faces fixed pitch.&#34;</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(after! mixed-pitch
</span></span><span style=display:flex><span>  (defface variable-pitch-serif
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#39;</span>((<span style=color:#66d9ef>t</span> (:family <span style=color:#e6db74>&#34;serif&#34;</span>)))
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;A variable-pitch face with serifs.&#34;</span>
</span></span><span style=display:flex><span>    :group <span style=color:#e6db74>&#39;basic-faces</span>)
</span></span><span style=display:flex><span>  (setq mixed-pitch-set-height <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>  (setq variable-pitch-serif-font (<span style=color:#a6e22e>font-spec</span> :family <span style=color:#e6db74>&#34;Alegreya&#34;</span> :size <span style=color:#ae81ff>18</span>))
</span></span><span style=display:flex><span>  (set-face-attribute <span style=color:#e6db74>&#39;variable-pitch-serif</span> <span style=color:#66d9ef>nil</span> :font variable-pitch-serif-font)
</span></span><span style=display:flex><span>  (defun mixed-pitch-serif-mode (<span style=color:#66d9ef>&amp;optional</span> arg)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Change the default face of the current buffer to a serifed variable pitch, while keeping some faces fixed pitch.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (let ((mixed-pitch-face <span style=color:#e6db74>&#39;variable-pitch-serif</span>))
</span></span><span style=display:flex><span>      (mixed-pitch-mode (or arg <span style=color:#e6db74>&#39;toggle</span>)))))
</span></span></code></pre></div><p>Now, as Harfbuzz is currently used in Emacs, we’ll be missing out on the following Alegreya ligatures:</p><style>.org-center{margin-left:auto;margin-right:auto;text-align:center}</style><div class=org-center><p>ff <em>ff</em> ffi <em>ffi</em> ffj <em>ffj</em> ffl <em>ffl</em>
fft <em>fft</em> fi <em>fi</em> fj <em>fj</em> ft <em>ft</em>
Th <em>Th</em></p></div><p>Thankfully, it isn&rsquo;t to hard to add these to the <code>composition-function-table</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; (set-char-table-range composition-function-table ?f &#39;([&#34;\\(?:ff?[fijlt]\\)&#34; 0 font-shape-gstring]))</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (set-char-table-range composition-function-table ?T &#39;([&#34;\\(?:Th\\)&#34; 0 font-shape-gstring]))</span>
</span></span></code></pre></div><h4 id=helper-macros>Helper macros</h4><h3 id=other-things>Other things</h3><h4 id=splash-screen>Splash screen</h4><p>This beauty is shamelessly ripped off from <a href=https://tecosaur.github.io/emacs-config/config.html#splash-screen>tecosaur&rsquo;s</a> Emacs config (as many other things in this config 😇)</p><figure><img src=https://rhblind.github.io/ox-hugo/emacs-e.svg alt='Fancy Emacs "E"'></figure><p>Make it theme-appropriate, and resize with the frame.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defvar fancy-splash-image-template
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;misc/splash-images/emacs-e-template.svg&#34;</span> doom-private-dir)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Default template svg used for the splash image, with substitutions from &#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defvar fancy-splash-sizes
</span></span><span style=display:flex><span>  <span style=color:#f92672>`</span>((:height <span style=color:#ae81ff>300</span> :min-height <span style=color:#ae81ff>50</span> :padding (<span style=color:#ae81ff>0</span> <span style=color:#f92672>.</span> <span style=color:#ae81ff>2</span>))
</span></span><span style=display:flex><span>    (:height <span style=color:#ae81ff>250</span> :min-height <span style=color:#ae81ff>42</span> :padding (<span style=color:#ae81ff>2</span> <span style=color:#f92672>.</span> <span style=color:#ae81ff>4</span>))
</span></span><span style=display:flex><span>    (:height <span style=color:#ae81ff>200</span> :min-height <span style=color:#ae81ff>35</span> :padding (<span style=color:#ae81ff>3</span> <span style=color:#f92672>.</span> <span style=color:#ae81ff>3</span>))
</span></span><span style=display:flex><span>    (:height <span style=color:#ae81ff>150</span> :min-height <span style=color:#ae81ff>28</span> :padding (<span style=color:#ae81ff>3</span> <span style=color:#f92672>.</span> <span style=color:#ae81ff>3</span>))
</span></span><span style=display:flex><span>    (:height <span style=color:#ae81ff>100</span> :min-height <span style=color:#ae81ff>20</span> :padding (<span style=color:#ae81ff>2</span> <span style=color:#f92672>.</span> <span style=color:#ae81ff>2</span>))
</span></span><span style=display:flex><span>    (:height <span style=color:#ae81ff>75</span>  :min-height <span style=color:#ae81ff>15</span> :padding (<span style=color:#ae81ff>2</span> <span style=color:#f92672>.</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>    (:height <span style=color:#ae81ff>50</span>  :min-height <span style=color:#ae81ff>10</span> :padding (<span style=color:#ae81ff>1</span> <span style=color:#f92672>.</span> <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span>    (:height <span style=color:#ae81ff>1</span>   :min-height <span style=color:#ae81ff>0</span>  :padding (<span style=color:#ae81ff>0</span> <span style=color:#f92672>.</span> <span style=color:#ae81ff>0</span>)))
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;list of plists with the following properties
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  :height the height of the image
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  :min-height minimum </span><span style=color:#e6db74>`frame-height&#39;</span><span style=color:#e6db74> for image
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  :padding </span><span style=color:#e6db74>`+doom-dashboard-banner-padding&#39;</span><span style=color:#e6db74> (top . bottom) to apply
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  :template non-default template file
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  :file file to use instead of template&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defvar fancy-splash-template-colours
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;$colour1&#34;</span> <span style=color:#f92672>.</span> keywords) (<span style=color:#e6db74>&#34;$colour2&#34;</span> <span style=color:#f92672>.</span> type) (<span style=color:#e6db74>&#34;$colour3&#34;</span> <span style=color:#f92672>.</span> base5) (<span style=color:#e6db74>&#34;$colour4&#34;</span> <span style=color:#f92672>.</span> base8))
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;list of colour-replacement alists of the form (\&#34;$placeholder\&#34; . &#39;theme-colour) which applied the template&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(unless (<span style=color:#a6e22e>file-exists-p</span> (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;theme-splashes&#34;</span> doom-cache-dir))
</span></span><span style=display:flex><span>  (make-directory (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;theme-splashes&#34;</span> doom-cache-dir) <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun fancy-splash-filename (theme-name height)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>expand-file-name</span> (<span style=color:#a6e22e>concat</span> (<span style=color:#a6e22e>file-name-as-directory</span> <span style=color:#e6db74>&#34;theme-splashes&#34;</span>)
</span></span><span style=display:flex><span>                            theme-name
</span></span><span style=display:flex><span>                            <span style=color:#e6db74>&#34;-&#34;</span> (<span style=color:#a6e22e>number-to-string</span> height) <span style=color:#e6db74>&#34;.svg&#34;</span>)
</span></span><span style=display:flex><span>                    doom-cache-dir))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun fancy-splash-clear-cache ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Delete all cached fancy splash images&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (delete-directory (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;theme-splashes&#34;</span> doom-cache-dir) <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>message</span> <span style=color:#e6db74>&#34;Cache cleared!&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun fancy-splash-generate-image (template height)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Read TEMPLATE and create an image if HEIGHT with colour substitutions as
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   described by </span><span style=color:#e6db74>`fancy-splash-template-colours&#39;</span><span style=color:#e6db74> for the current theme&#34;</span>
</span></span><span style=display:flex><span>  (with-temp-buffer
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>insert-file-contents</span> template)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>re-search-forward</span> <span style=color:#e6db74>&#34;$height&#34;</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>replace-match</span> (<span style=color:#a6e22e>number-to-string</span> height) <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>    (dolist (substitution fancy-splash-template-colours)
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>      (while (<span style=color:#a6e22e>re-search-forward</span> (<span style=color:#a6e22e>car</span> substitution) <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>replace-match</span> (doom-color (<span style=color:#a6e22e>cdr</span> substitution)) <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span>)))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>write-region</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                  (fancy-splash-filename (<span style=color:#a6e22e>symbol-name</span> doom-theme) height) <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun fancy-splash-generate-images ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Perform </span><span style=color:#e6db74>`fancy-splash-generate-image&#39;</span><span style=color:#e6db74> in bulk&#34;</span>
</span></span><span style=display:flex><span>  (dolist (size fancy-splash-sizes)
</span></span><span style=display:flex><span>    (unless (<span style=color:#a6e22e>plist-get</span> size :file)
</span></span><span style=display:flex><span>      (fancy-splash-generate-image (or (<span style=color:#a6e22e>plist-get</span> size :template)
</span></span><span style=display:flex><span>                                       fancy-splash-image-template)
</span></span><span style=display:flex><span>                                   (<span style=color:#a6e22e>plist-get</span> size :height)))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun ensure-theme-splash-images-exist (<span style=color:#66d9ef>&amp;optional</span> height)
</span></span><span style=display:flex><span>  (unless (<span style=color:#a6e22e>file-exists-p</span> (fancy-splash-filename
</span></span><span style=display:flex><span>                          (<span style=color:#a6e22e>symbol-name</span> doom-theme)
</span></span><span style=display:flex><span>                          (or height
</span></span><span style=display:flex><span>                              (<span style=color:#a6e22e>plist-get</span> (<span style=color:#a6e22e>car</span> fancy-splash-sizes) :height))))
</span></span><span style=display:flex><span>    (fancy-splash-generate-images)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun get-appropriate-splash ()
</span></span><span style=display:flex><span>  (let ((height (frame-height)))
</span></span><span style=display:flex><span>    (cl-some (lambda (size) (when (<span style=color:#a6e22e>&gt;=</span> height (<span style=color:#a6e22e>plist-get</span> size :min-height)) size))
</span></span><span style=display:flex><span>             fancy-splash-sizes)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(setq fancy-splash-last-size <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>(setq fancy-splash-last-theme <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>(defun set-appropriate-splash (<span style=color:#66d9ef>&amp;rest</span> _)
</span></span><span style=display:flex><span>  (let ((appropriate-image (get-appropriate-splash)))
</span></span><span style=display:flex><span>    (unless (and (<span style=color:#a6e22e>equal</span> appropriate-image fancy-splash-last-size)
</span></span><span style=display:flex><span>                 (<span style=color:#a6e22e>equal</span> doom-theme fancy-splash-last-theme)))
</span></span><span style=display:flex><span>    (unless (<span style=color:#a6e22e>plist-get</span> appropriate-image :file)
</span></span><span style=display:flex><span>      (ensure-theme-splash-images-exist (<span style=color:#a6e22e>plist-get</span> appropriate-image :height)))
</span></span><span style=display:flex><span>    (setq fancy-splash-image
</span></span><span style=display:flex><span>          (or (<span style=color:#a6e22e>plist-get</span> appropriate-image :file)
</span></span><span style=display:flex><span>              (fancy-splash-filename (<span style=color:#a6e22e>symbol-name</span> doom-theme) (<span style=color:#a6e22e>plist-get</span> appropriate-image :height))))
</span></span><span style=display:flex><span>    (setq +doom-dashboard-banner-padding (<span style=color:#a6e22e>plist-get</span> appropriate-image :padding))
</span></span><span style=display:flex><span>    (setq fancy-splash-last-size appropriate-image)
</span></span><span style=display:flex><span>    (setq fancy-splash-last-theme doom-theme)
</span></span><span style=display:flex><span>    (+doom-dashboard-reload)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(add-hook <span style=color:#e6db74>&#39;window-size-change-functions</span> <span style=color:#a6e22e>#&#39;</span>set-appropriate-splash)
</span></span><span style=display:flex><span>(add-hook <span style=color:#e6db74>&#39;doom-load-theme-hook</span> <span style=color:#a6e22e>#&#39;</span>set-appropriate-splash)
</span></span></code></pre></div><p>Now the only thing missing is a an extra interesting line, whether that be some
corporate BS, an developer excuse, or a fun (useless) fact.</p><p>The following is rather long, but it essentially</p><ul><li>fetches a phrase from an API</li><li>inserts it into the dashboard (asynchronously)</li><li>moves <code>point</code> to the phrase</li><li>re-uses the last phrase for requests within a few seconds of it being fetched</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defvar splash-phrase-source-folder
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;misc/splash-phrases&#34;</span> doom-private-dir)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;A folder of text files with a fun phrase on each line.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defvar splash-phrase-sources
</span></span><span style=display:flex><span>  (let* ((files (<span style=color:#a6e22e>directory-files</span> splash-phrase-source-folder <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#34;\\.txt\\&#39;&#34;</span>))
</span></span><span style=display:flex><span>         (sets (delete-dups (<span style=color:#a6e22e>mapcar</span>
</span></span><span style=display:flex><span>                             (lambda (file)
</span></span><span style=display:flex><span>                               (replace-regexp-in-string <span style=color:#e6db74>&#34;\\(?:-[0-9]+-\\w+\\)?\\.txt&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> file))
</span></span><span style=display:flex><span>                             files))))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>mapcar</span> (lambda (sset)
</span></span><span style=display:flex><span>              (<span style=color:#a6e22e>cons</span> sset
</span></span><span style=display:flex><span>                    (<span style=color:#a6e22e>delq</span> <span style=color:#66d9ef>nil</span> (<span style=color:#a6e22e>mapcar</span>
</span></span><span style=display:flex><span>                               (lambda (file)
</span></span><span style=display:flex><span>                                 (when (string-match-p (<span style=color:#a6e22e>regexp-quote</span> sset) file)
</span></span><span style=display:flex><span>                                   file))
</span></span><span style=display:flex><span>                               files))))
</span></span><span style=display:flex><span>            sets))
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;A list of cons giving the phrase set name, and a list of files which contain phrase components.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defvar splash-phrase-set
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>nth</span> (<span style=color:#a6e22e>random</span> (<span style=color:#a6e22e>length</span> splash-phrase-sources)) (<span style=color:#a6e22e>mapcar</span> <span style=color:#a6e22e>#&#39;car</span> splash-phrase-sources))
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;The default phrase set. See </span><span style=color:#e6db74>`splash-phrase-sources&#39;</span><span style=color:#e6db74>.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun splase-phrase-set-random-set ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Set a new random splash phrase set.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (setq splash-phrase-set
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>nth</span> (<span style=color:#a6e22e>random</span> (<span style=color:#a6e22e>1-</span> (<span style=color:#a6e22e>length</span> splash-phrase-sources)))
</span></span><span style=display:flex><span>             (cl-set-difference (<span style=color:#a6e22e>mapcar</span> <span style=color:#a6e22e>#&#39;car</span> splash-phrase-sources) (<span style=color:#a6e22e>list</span> splash-phrase-set))))
</span></span><span style=display:flex><span>  (+doom-dashboard-reload <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defvar splase-phrase--cache <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun splash-phrase-get-from-file (file)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Fetch a random line from FILE.&#34;</span>
</span></span><span style=display:flex><span>  (let ((lines (or (<span style=color:#a6e22e>cdr</span> (<span style=color:#a6e22e>assoc</span> file splase-phrase--cache))
</span></span><span style=display:flex><span>                   (cdar (push (<span style=color:#a6e22e>cons</span> file
</span></span><span style=display:flex><span>                                     (with-temp-buffer
</span></span><span style=display:flex><span>                                       (<span style=color:#a6e22e>insert-file-contents</span> (<span style=color:#a6e22e>expand-file-name</span> file splash-phrase-source-folder))
</span></span><span style=display:flex><span>                                       (split-string (string-trim (<span style=color:#a6e22e>buffer-string</span>)) <span style=color:#e6db74>&#34;\n&#34;</span>)))
</span></span><span style=display:flex><span>                               splase-phrase--cache)))))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>nth</span> (<span style=color:#a6e22e>random</span> (<span style=color:#a6e22e>length</span> lines)) lines)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun splash-phrase (<span style=color:#66d9ef>&amp;optional</span> <span style=color:#a6e22e>set</span>)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Construct a splash phrase from SET. See </span><span style=color:#e6db74>`splash-phrase-sources&#39;</span><span style=color:#e6db74>.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>mapconcat</span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>#&#39;</span>splash-phrase-get-from-file
</span></span><span style=display:flex><span>   (<span style=color:#a6e22e>cdr</span> (<span style=color:#a6e22e>assoc</span> (or <span style=color:#a6e22e>set</span> splash-phrase-set) splash-phrase-sources))
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#34; &#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun doom-dashboard-phrase ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Get a splash phrase, flow it over multiple lines as needed, and make fontify it.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>mapconcat</span>
</span></span><span style=display:flex><span>   (lambda (line)
</span></span><span style=display:flex><span>     (+doom-dashboard--center
</span></span><span style=display:flex><span>      +doom-dashboard--width
</span></span><span style=display:flex><span>      (with-temp-buffer
</span></span><span style=display:flex><span>        (insert-text-button
</span></span><span style=display:flex><span>         line
</span></span><span style=display:flex><span>         <span style=color:#e6db74>&#39;action</span>
</span></span><span style=display:flex><span>         (lambda (_) (+doom-dashboard-reload <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>         <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;doom-dashboard-menu-title</span>
</span></span><span style=display:flex><span>         <span style=color:#e6db74>&#39;mouse-face</span> <span style=color:#e6db74>&#39;doom-dashboard-menu-title</span>
</span></span><span style=display:flex><span>         <span style=color:#e6db74>&#39;help-echo</span> <span style=color:#e6db74>&#34;Random phrase&#34;</span>
</span></span><span style=display:flex><span>         <span style=color:#e6db74>&#39;follow-link</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>buffer-string</span>))))
</span></span><span style=display:flex><span>   (split-string
</span></span><span style=display:flex><span>    (with-temp-buffer
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>insert</span> (splash-phrase))
</span></span><span style=display:flex><span>      (setq fill-column (<span style=color:#a6e22e>min</span> <span style=color:#ae81ff>70</span> (<span style=color:#a6e22e>/</span> (<span style=color:#a6e22e>*</span> <span style=color:#ae81ff>2</span> (window-width)) <span style=color:#ae81ff>3</span>)))
</span></span><span style=display:flex><span>      (fill-region (<span style=color:#a6e22e>point-min</span>) (<span style=color:#a6e22e>point-max</span>))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>buffer-string</span>))
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;\n&#34;</span>)
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#34;\n&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defadvice! doom-dashboard-widget-loaded-with-phrase ()
</span></span><span style=display:flex><span>  :override <span style=color:#a6e22e>#&#39;</span>doom-dashboard-widget-loaded
</span></span><span style=display:flex><span>  (setq line-spacing <span style=color:#ae81ff>0.2</span>)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>insert</span>
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#34;\n\n&#34;</span>
</span></span><span style=display:flex><span>   (<span style=color:#a6e22e>propertize</span>
</span></span><span style=display:flex><span>    (+doom-dashboard--center
</span></span><span style=display:flex><span>     +doom-dashboard--width
</span></span><span style=display:flex><span>     (doom-display-benchmark-h <span style=color:#e6db74>&#39;return</span>))
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;doom-dashboard-loaded</span>)
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#34;\n&#34;</span>
</span></span><span style=display:flex><span>   (doom-dashboard-phrase)
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#34;\n&#34;</span>))
</span></span></code></pre></div><p>Lastly, the doom dashboard &ldquo;useful commands&rdquo; are no longer useful to me.
So, we&rsquo;ll disable them and then for a particularly <em>clean</em> look disable
the modeline and <code>hl-line-mode</code>, then also hide the cursor.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(remove-hook <span style=color:#e6db74>&#39;+doom-dashboard-functions</span> <span style=color:#a6e22e>#&#39;</span>doom-dashboard-widget-shortmenu)
</span></span><span style=display:flex><span>(add-hook! <span style=color:#e6db74>&#39;+doom-dashboard-mode-hook</span> (hide-mode-line-mode <span style=color:#ae81ff>1</span>) (hl-line-mode <span style=color:#ae81ff>-1</span>))
</span></span><span style=display:flex><span>(setq-hook! <span style=color:#e6db74>&#39;+doom-dashboard-mode-hook</span> evil-normal-state-cursor (<span style=color:#a6e22e>list</span> <span style=color:#66d9ef>nil</span>))
</span></span></code></pre></div><p>At the end, we have a minimal but rather nice splash screen.</p><p>I haven&rsquo;t forgotten about the ASCII banner though! Once again we&rsquo;re going for
something simple.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun doom-dashboard-draw-ascii-emacs-banner-fn ()
</span></span><span style=display:flex><span>  (let* ((banner
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;,---.,-.-.,---.,---.,---.&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;|---&#39;| | |,---||    `---.&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>`---&#39;</span><span style=color:#e6db74>` &#39; &#39;`---^</span><span style=color:#e6db74>`---&#39;`---&#39;</span><span style=color:#e6db74>&#34;</span>))
</span></span><span style=display:flex><span>         (longest-line (<span style=color:#a6e22e>apply</span> <span style=color:#a6e22e>#&#39;max</span> (<span style=color:#a6e22e>mapcar</span> <span style=color:#a6e22e>#&#39;length</span> banner))))
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>put-text-property</span>
</span></span><span style=display:flex><span>     (<span style=color:#a6e22e>point</span>)
</span></span><span style=display:flex><span>     (dolist (line banner (<span style=color:#a6e22e>point</span>))
</span></span><span style=display:flex><span>       (<span style=color:#a6e22e>insert</span> (+doom-dashboard--center
</span></span><span style=display:flex><span>                +doom-dashboard--width
</span></span><span style=display:flex><span>                (<span style=color:#a6e22e>concat</span>
</span></span><span style=display:flex><span>                 line (<span style=color:#a6e22e>make-string</span> (<span style=color:#a6e22e>max</span> <span style=color:#ae81ff>0</span> (<span style=color:#a6e22e>-</span> longest-line (<span style=color:#a6e22e>length</span> line)))
</span></span><span style=display:flex><span>                                   <span style=color:#ae81ff>32</span>)))
</span></span><span style=display:flex><span>               <span style=color:#e6db74>&#34;\n&#34;</span>))
</span></span><span style=display:flex><span>     <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;doom-dashboard-banner</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(unless (display-graphic-p) <span style=color:#75715e>; for some reason this messes up the graphical splash screen atm</span>
</span></span><span style=display:flex><span>  (setq +doom-dashboard-ascii-banner-fn <span style=color:#a6e22e>#&#39;</span>doom-dashboard-draw-ascii-emacs-banner-fn))
</span></span></code></pre></div><ul><li><p>Frames</p><p>TBD</p></li></ul><h4 id=end-of-line-characters>End Of Line characters</h4><p>Some files (looking at you, <code>dotnet</code> generated projects) create files using DOS-style end of line characters (<code>CRLF</code>).
I always want to use unix-style end of line characters (<code>LF</code>).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun ensure-crlf-end-of-line ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Automate M-% C-q C-m RET C-q C-j RET&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (save-excursion
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>    (while (<span style=color:#a6e22e>search-forward</span> (<span style=color:#a6e22e>string</span> <span style=color:#e6db74>?\C</span>-m) <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>replace-match</span> (<span style=color:#a6e22e>string</span> <span style=color:#e6db74>?\C</span>-j) <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>))))
</span></span></code></pre></div><h2 id=packages>Packages</h2><p>This is where to install packages.
By declaring packages using the <code>package!</code> macro in <code>packages.el</code>, then running <code>doom refresh</code> from the command line
(or <code>M-x doom/refresh</code>).</p><p>The <code>packages.el</code> file should <strong>not</strong> be byte compiled!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; -*- no-byte-compile: t; -*-</span>
</span></span></code></pre></div><p>A lot of these configurations are taken from <a href=https://github.com/tecosaur/emacs-config/blob/master/config.org#packages>tecosaur&rsquo;s</a> config.
Great source of inspiration!</p><h3 id=loading-instructions>Loading instructions</h3><h4 id=packages-in-melpa-elpa-emacsmirror>Packages in MELPA/ELPA/emacsmirror</h4><p>To install packages from the default locations:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! some-package-name)
</span></span></code></pre></div><h4 id=packages-from-git-repositories>Packages from Git repositories</h4><p>To install packages from git repositories, we need to specify a <code>:recipe</code>.
Check out the <a href=https://github.com/raxod502/straight.el#the-recipe-format>documentation here</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! some-package-name
</span></span><span style=display:flex><span>  :recipe (:host github :repo <span style=color:#e6db74>&#34;username/repo&#34;</span>))
</span></span></code></pre></div><p>Unless the repository have a <code>PACKAGENAME.el</code> file, or it is located in a subdirectory in the repository, we must specify
the location using <code>:file</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! some-package-name
</span></span><span style=display:flex><span>  :recipe (:host github :repo <span style=color:#e6db74>&#34;username/repo&#34;</span>
</span></span><span style=display:flex><span>           :files (<span style=color:#e6db74>&#34;some-file.el&#34;</span> <span style=color:#e6db74>&#34;src/lisp/*.el&#34;</span>)))
</span></span></code></pre></div><p>It is also possible to install packages from any git repository. If we for example want to install a package from a gist,
we could do it by specifying the receipe like this.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! some-package-name
</span></span><span style=display:flex><span>  :recipe (:host <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>           :type git
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;https://gist.github.com/61b34f9ca674495eac7f1fe990ebe966.git&#34;</span>
</span></span><span style=display:flex><span>           :files (<span style=color:#e6db74>&#34;some-package-name.el&#34;</span>)))
</span></span></code></pre></div><h4 id=disable-or-override-built-in-packages>Disable or override built-in packages</h4><p>In order tp disable a built-in package (for whatever reason), we can use the <code>:disable</code> property.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! built-in-package-name :disable <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><p>We can also override built-in packages without having to specify all <code>:recipe</code> properties. These will
inherit the rest from Doom or MELPA/ELPA/emacsmirror.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! built-in-package-name :recipe (:nonrecursive <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>(package! built-in-package-name :recipe (:repo <span style=color:#e6db74>&#34;some-fork/package-name&#34;</span>))
</span></span><span style=display:flex><span>(package! built-in-package-name :recipe (:branch <span style=color:#e6db74>&#34;develop&#34;</span>))
</span></span></code></pre></div><h3 id=tools>Tools</h3><h4 id=auto-highlight-symbol>Auto highlight symbol</h4><p>Minor mode for automatically highlighting current symbol</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! auto-highlight-symbol)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq ahs-idle-interval <span style=color:#ae81ff>0.2</span>)
</span></span><span style=display:flex><span>(add-hook! <span style=color:#e6db74>&#39;text-mode-hook</span> <span style=color:#a6e22e>#&#39;</span>auto-highlight-symbol-mode)
</span></span><span style=display:flex><span>(add-hook! <span style=color:#e6db74>&#39;prog-mode-hook</span> <span style=color:#a6e22e>#&#39;</span>auto-highlight-symbol-mode)
</span></span></code></pre></div><p>The default AHS font faces don&rsquo;t match the theme at all, let&rsquo;s try to fix that!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(custom-set-faces!
</span></span><span style=display:flex><span>  <span style=color:#f92672>`</span>(ahs-face                            :foreground <span style=color:#e6db74>&#34;White&#34;</span> :background <span style=color:#f92672>,</span>(doom-color <span style=color:#e6db74>&#39;magenta</span>))
</span></span><span style=display:flex><span>  <span style=color:#f92672>`</span>(ahs-face-unfocused                  :foreground <span style=color:#e6db74>&#34;White&#34;</span> :background <span style=color:#f92672>,</span>(doom-color <span style=color:#e6db74>&#39;magenta</span>))
</span></span><span style=display:flex><span>  <span style=color:#f92672>`</span>(ahs-definition-face                 :foreground <span style=color:#e6db74>&#34;White&#34;</span> :background <span style=color:#f92672>,</span>(doom-color <span style=color:#e6db74>&#39;magenta</span>))
</span></span><span style=display:flex><span>  <span style=color:#f92672>`</span>(ahs-definition-face-unfocused       :foreground <span style=color:#e6db74>&#34;White&#34;</span> :background <span style=color:#f92672>,</span>(doom-color <span style=color:#e6db74>&#39;magenta</span>))
</span></span><span style=display:flex><span>  <span style=color:#f92672>`</span>(ahs-plugin-default-face             :inherit hl-line :foreground <span style=color:#f92672>,</span>(doom-color <span style=color:#e6db74>&#39;fg</span>))
</span></span><span style=display:flex><span>  <span style=color:#f92672>`</span>(ahs-plugin-default-face-unfocused   :inherit hl-line :foreground <span style=color:#f92672>,</span>(doom-color <span style=color:#e6db74>&#39;magenta</span>))
</span></span><span style=display:flex><span>  )
</span></span></code></pre></div><h4 id=company>Company</h4><blockquote><p>From the <code>:completion company</code> module</p></blockquote><p>Auto-complete, yay!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! company
</span></span><span style=display:flex><span>  (setq company-idle-delay <span style=color:#ae81ff>0.5</span>
</span></span><span style=display:flex><span>        company-minimum-prefix-length <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        company-show-numbers <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        company-box-doc-enable <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;evil-normal-state-entry-hook</span> <span style=color:#a6e22e>#&#39;</span>company-abort)) <span style=color:#75715e>;; Makes aborting less annoying.</span>
</span></span></code></pre></div><p>Improvements from <code>precedent</code> are mostly from history, let&rsquo;s improve its memory.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq-default history-length <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>              prescient-history-length <span style=color:#ae81ff>1000</span>)
</span></span></code></pre></div><p>Ispell is nice, let’s have it in text, markdown, and GFM.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(set-company-backend!
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(text-mode
</span></span><span style=display:flex><span>    markdown-mode
</span></span><span style=display:flex><span>    gfm-mode)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(:seperate
</span></span><span style=display:flex><span>    company-ispell
</span></span><span style=display:flex><span>    company-files
</span></span><span style=display:flex><span>    company-yasnippet))
</span></span></code></pre></div><p>We configure <a href=#ispell>Ispell</a> below</p><h4 id=consult>Consult</h4><blockquote><p>From the <code>:completion vertico</code> module</p></blockquote><p>Since we&rsquo;re using <a href=#marginalia>Marginalia</a>, the separation between buffers and files is already clear,
and there&rsquo;s no need to use a different face.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! consult
</span></span><span style=display:flex><span>  (set-face-attribute <span style=color:#e6db74>&#39;consult-file</span> <span style=color:#66d9ef>nil</span> :inherit <span style=color:#e6db74>&#39;consult-buffer</span>)
</span></span><span style=display:flex><span>  (setf (<span style=color:#a6e22e>plist-get</span> (alist-get <span style=color:#e6db74>&#39;perl</span> consult-async-split-styles-alist) :initial) <span style=color:#e6db74>&#34;;&#34;</span>))
</span></span></code></pre></div><h4 id=dired>Dired</h4><p>The <code>dired-recent</code> package provides us with is a convenient way to visit previously visited directories.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! dired-recent)         <span style=color:#75715e>;; convenient package for visiting frequent folders</span>
</span></span><span style=display:flex><span>(package! dired-open)           <span style=color:#75715e>;; open files in correct applications</span>
</span></span><span style=display:flex><span>(package! dired-hide-dotfiles)  <span style=color:#75715e>;; hide or show those pesky .dotfiles</span>
</span></span></code></pre></div><p>Add some extra configuration options for the <code>dired</code> file manager.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! dired
</span></span><span style=display:flex><span>  (dired-async-mode <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>  (dired-recent-mode <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(use-package! dired
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (map! :leader :desc <span style=color:#e6db74>&#34;Dired&#34;</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#a6e22e>#&#39;</span>dired-jump)         <span style=color:#75715e>;; easy access shortcut</span>
</span></span><span style=display:flex><span>  (map! :map dired-recent-mode-map <span style=color:#e6db74>&#34;C-x C-d&#34;</span> <span style=color:#66d9ef>nil</span>)       <span style=color:#75715e>;; hijacks `counsult-dir&#39; command</span>
</span></span><span style=display:flex><span>  (evil-collection-define-key <span style=color:#e6db74>&#39;normal</span> <span style=color:#e6db74>&#39;dired-mode-map</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;h&#34;</span>         <span style=color:#a6e22e>#&#39;</span>dired-up-directory
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;l&#34;</span>         <span style=color:#a6e22e>#&#39;</span>dired-find-file
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;K&#34;</span>         <span style=color:#a6e22e>#&#39;</span>dired-do-kill-lines  <span style=color:#75715e>;; This currently conflicts with `+lookup/documentation&#39; keybindings..</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;r&#34;</span>         <span style=color:#a6e22e>#&#39;</span>dired-recent-open
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;G&#34;</span>         <span style=color:#a6e22e>#&#39;</span>consult-dir))
</span></span></code></pre></div><p>The <code>dired-open</code> can help us making sure that various files are opened in the correct program. For example,
opening a video file in Emacs is probably not going to be a pleasent experience, and would be better to open
in for example Quicktime or, VLC.
On Linux (or XDG enabled environments), the <code>dired-open</code> package has a concept of &ldquo;auto-detecting&rdquo; which program that should be used to open certain files. I&rsquo;m mostly using macOS, which does not support XDG very well.
So, we&rsquo;ll try to write a the <code>dired-open-macos</code> function to use the native <code>open</code> program instead.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; FIXME - Need to make this a bit smarter..</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; I want to open most files in Emacs, and this lets</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; macOS decide a bit too much.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (use-package! dired-open</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;   :config</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;   (add-to-list &#39;dired-open-functions #&#39;dired-open-macos t)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;   (setq dired-open-extensions &#39;((&#34;svg&#34; . &#34;qlmanage -p&#34;))))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (eval-after-load &#34;dired-open&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;   (when (eq system-type &#39;darwin)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;     &#39;(defun dired-open-macos ()</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;        &#34;Try to run `open&#39; to open the file under point as long as the `file&#39; is a regular file,</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; and file extension does not exists in the `dired-open-functions&#39; alist.&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;        (interactive)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;        (if (executable-find &#34;open&#34;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;            (let ((file (ignore-errors (dired-get-file-for-visit))))</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;              (if (and (f-file-p file) (not (member (file-name-extension file) dired-open-extensions)))</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;                  (start-process &#34;dired-open&#34; nil</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;                                 &#34;open&#34; (file-truename file)) nil)) nil))))</span>
</span></span></code></pre></div><p>Especially when visiting my <code>$HOME</code> directory, it&rsquo;s littered with all sorts of dot files. Let&rsquo;s add a convenient
way to show or hide them.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! dired-hide-dotfiles
</span></span><span style=display:flex><span>  :hook (dired-mode <span style=color:#f92672>.</span> dired-hide-dotfiles-mode)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (evil-collection-define-key <span style=color:#e6db74>&#39;normal</span> <span style=color:#e6db74>&#39;dired-mode-map</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;H&#34;</span> <span style=color:#a6e22e>#&#39;</span>dired-hide-dotfiles-mode))
</span></span></code></pre></div><p>Since I&rsquo;m trying to learn using <code>dired</code>, here&rsquo;s a small tutorial (based on <a href=https://www.youtube.com/c/SystemCrafters>Systemcrafters</a> ❤) on basic file operations.</p><ul><li><p>File Operations (The tutorial)</p><ul><li><p>Marking files</p><ul><li><code>m</code> - Marks a file</li><li><code>u</code> - Unmarks a file</li><li><code>U</code> - Unmarks all files in buffer</li><li><code>t</code> - Inverts marked files in buffer</li><li><code>%m</code> - Marks files in buffer using regular expressions</li><li><code>*</code> - Open menu with lots of auto-marking operations</li><li><code>K</code> - &ldquo;Kills&rdquo; marked items (refresh buffer with <code>g r</code> to get them back) (Currently conflicts with <code>+lookup/documentation</code> keybinding)</li></ul><p>Many operations can be done on a single file if there are no active marks!</p></li></ul><ul><li><p>Copying and Renaming files</p><ul><li><code>C</code> - Copy marked files (or if no files are marked, the current file)</li><li><code>R</code> - Rename marked files, renaming multiple files is a move!</li><li><code>% R</code> - Rename based on regular expression: <code>^test, old-\&</code></li><li><code>C-x C-q</code> - Toggle read-only mode. Can edit file names using normal editing functionality. Use <code>Z-Z</code> to save, changes or <code>Z-Q</code> to abort.</li></ul></li></ul><ul><li><p>Deleting files</p><ul><li><code>D</code> - Delete marked file</li><li><code>d</code> - Mark file for deletion</li><li><code>x</code> - Execute deletion for marks</li></ul></li></ul><ul><li><p>Creating and extracting archives</p><ul><li><code>Z</code> - Compress or uncompress a file or folder (to <code>.tar.gz</code>)</li><li><code>c</code> - Compress selection to a specific file</li><li>Pressing <code>&lt;Enter></code> on an archive an preview files inside</li></ul><p>Supported compression libraries can be controlled by setting the <code>dired-compress-files-alist</code> variable.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! dired-aux
</span></span><span style=display:flex><span> (setq dired-compress-file-alist
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>append</span> dired-compress-file-alist <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;\\.tar\\.gz\\&#39;&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;tar -cf - %i | gzip -c9 &gt; %o&#34;</span>)
</span></span><span style=display:flex><span>                                            (<span style=color:#e6db74>&#34;\\.tar\\.bz2\\&#39;&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;tar -cf - %i | bzip -c9 &gt; %o&#34;</span>)
</span></span><span style=display:flex><span>                                            (<span style=color:#e6db74>&#34;\\.tar\\.xz\\&#39;&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;tar -cf - %i | xz -c9 &gt; %o&#34;</span>)
</span></span><span style=display:flex><span>                                            (<span style=color:#e6db74>&#34;\\.tar\\.zst\\&#39;&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;tar -cf - %i | zstd -19 -o %o&#34;</span>)
</span></span><span style=display:flex><span>                                            (<span style=color:#e6db74>&#34;\\.zip\\&#39;&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;zip %o -r --filesync %i&#34;</span>)))))
</span></span></code></pre></div></li></ul><ul><li><p>Other common operations</p><ul><li><code>&</code> - Open file using a sub-process. For example <code>& qlmanage -p</code> would open the file using macOS quick look.</li><li><code>T</code> - Touch file (update timestamp)</li><li><code>M</code> - Change file mode</li><li><code>O</code> - Change file owner</li><li><code>g G</code> - Change file group</li><li><code>S</code> - Create a symbolic link to this file</li><li><code>L</code> - Load an Emacs Lisp file into Emacs</li><li><code>S-&lt;enter></code> - Open file in a new window</li><li><code>S-I</code> - Peek inside folder using the <code>dired-maybe-insert-subdir</code> function in the same buffer.</li></ul></li></ul></li></ul><h4 id=drag-stuff>Drag-Stuff</h4><p>I like to drag stuff up and down using <code>C-&lt;up></code> and <code>C-&lt;down></code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! drag-stuff
</span></span><span style=display:flex><span>  (global-set-key (kbd <span style=color:#e6db74>&#34;&lt;C-up&gt;&#34;</span>) <span style=color:#e6db74>&#39;drag-stuff-up</span>)
</span></span><span style=display:flex><span>  (global-set-key (kbd <span style=color:#e6db74>&#34;&lt;C-down&gt;&#34;</span>) <span style=color:#e6db74>&#39;drag-stuff-down</span>))
</span></span></code></pre></div><h4 id=evil>Evil</h4><blockquote><p>From the <code>:editor evil</code> module.</p></blockquote><ul><li><p>Functions</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun evil-execute-q-macro ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Execute macro stores in q-register, ie. run </span><span style=color:#e6db74>`@q&#39;</span><span style=color:#e6db74>.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (evil-execute-macro <span style=color:#ae81ff>1</span> <span style=color:#e6db74>&#34;@q&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun evil-scroll-to-center-advice (<span style=color:#66d9ef>&amp;rest</span> args)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Scroll line to center, for advising functions.&#34;</span>
</span></span><span style=display:flex><span>  (evil-scroll-line-to-center (line-number-at-pos)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun evil-end-of-line-interactive ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Wrap </span><span style=color:#e6db74>`evil-end-of-line&#39;</span><span style=color:#e6db74> in interactive, fix point being 1+ in vis state.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (evil-end-of-line))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun evil-insert-advice (<span style=color:#66d9ef>&amp;rest</span> args)
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Tack on after eg. heading insertion for </span><span style=color:#e6db74>`evil-insert&#39;</span><span style=color:#e6db74> mode.&#34;</span>
</span></span><span style=display:flex><span>  (evil-insert <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun evil-scroll-other-window-interactive ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Wrap </span><span style=color:#e6db74>`scroll-other-window&#39;</span><span style=color:#e6db74> in interactive.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>scroll-other-window</span> <span style=color:#e6db74>&#39;-</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(defun evil-scroll-other-window-down-interactive ()
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Wrap </span><span style=color:#e6db74>`scroll-other-window-down&#39;</span><span style=color:#e6db74> in interactive.&#34;</span>
</span></span><span style=display:flex><span>  (interactive)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>scroll-other-window</span>))
</span></span></code></pre></div></li></ul><ul><li><p>Keybindings</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! evil
</span></span><span style=display:flex><span>  (setq evil-escape-key-sequence <span style=color:#e6db74>&#34;jk&#34;</span>)
</span></span><span style=display:flex><span>  (setq evil-escape-unordered-key-sequence <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>  (setq evil-respect-visual-line-mode <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (evil-global-set-key <span style=color:#e6db74>&#39;normal</span> <span style=color:#e6db74>&#34;Q&#34;</span> <span style=color:#a6e22e>#&#39;</span>evil-execute-q-macro)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>define-key</span> evil-normal-state-map (kbd <span style=color:#e6db74>&#34;C-S-u&#34;</span>) <span style=color:#a6e22e>#&#39;</span>evil-scroll-other-window-interactive)
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>define-key</span> evil-normal-state-map (kbd <span style=color:#e6db74>&#34;C-S-d&#34;</span>) <span style=color:#a6e22e>#&#39;</span>evil-scroll-other-window-down-interactive)
</span></span><span style=display:flex><span>  (evil-define-key <span style=color:#f92672>&#39;</span>(normal visual motion) <span style=color:#e6db74>&#39;global</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;H&#34;</span>  <span style=color:#a6e22e>#&#39;</span>evil-first-non-blank
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;L&#34;</span>  <span style=color:#a6e22e>#&#39;</span>evil-end-of-line-interactive
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;0&#34;</span>  <span style=color:#a6e22e>#&#39;</span>evil-jump-item)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (advice-add <span style=color:#e6db74>&#39;evil-ex-search-next</span>     :after <span style=color:#a6e22e>#&#39;</span>evil-scroll-to-center-advice)
</span></span><span style=display:flex><span>  (advice-add <span style=color:#e6db74>&#39;evil-ex-search-previous</span> :after <span style=color:#a6e22e>#&#39;</span>evil-scroll-to-center-advice)
</span></span><span style=display:flex><span>  )
</span></span></code></pre></div><p>Sometimes it&rsquo;s convenient to insert multiple cursors using the mouse. Inserts a new cursor using <code>C-S-&lt;mouse-1></code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! evil
</span></span><span style=display:flex><span>  (global-set-key (kbd <span style=color:#e6db74>&#34;C-S-&lt;mouse-1&gt;&#34;</span>) <span style=color:#a6e22e>#&#39;</span>evil-mc-toggle-cursor-on-click))
</span></span></code></pre></div></li></ul><h4 id=forge>Forge</h4><blockquote><p>From the <code>:tools magit</code> module</p></blockquote><p>Add custom hosts</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! forge
</span></span><span style=display:flex><span>  (setq gitlab.user <span style=color:#e6db74>&#34;user&#34;</span>)
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#e6db74>&#39;forge-alist</span> <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;gitlab.intility.com&#34;</span> <span style=color:#e6db74>&#34;gitlab.intility.com/api/v4&#34;</span> <span style=color:#e6db74>&#34;gitlab.intility.com&#34;</span> forge-gitlab-repository)))
</span></span></code></pre></div><h4 id=ispell>Ispell</h4><ul><li><p>Downloading dictionaries</p><p>Currently using Aspell with Norwegian and English languages.
Should probably document installation.</p></li></ul><ul><li><p>Configuration</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq ispell-dictionary <span style=color:#e6db74>&#34;en&#34;</span>)
</span></span></code></pre></div><p>For a personal dictionaries (with all the misspelled words and such)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq spell-fu-directory (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;.spell-fu_personal&#34;</span> doom-private-dir)
</span></span><span style=display:flex><span>      ispell-personal-dictionary (<span style=color:#a6e22e>expand-file-name</span> <span style=color:#e6db74>&#34;.ispell_personal&#34;</span> doom-private-dir))
</span></span></code></pre></div></li></ul><h4 id=language-tool>Language tool</h4><blockquote><p>From the <code>:checkers grammar</code> module</p></blockquote><p>This seems pretty neat, so I&rsquo;ll experiment a bit with it.
Some issues I&rsquo;d like to see resolved though:</p><ul><li>Don&rsquo;t check org src blocks</li><li>Dont check org headers and properties</li><li>Look into running the https server to avvoid JVM spinup every time I check grammars</li><li>Check grammar at point - now I need to run <code>langtool-correct-buffer</code> and chose from there,
would be nice to just correct what&rsquo;s at point.</li></ul><ul><li><p>Installation</p><p>Requires installation of <code>languagetool</code> which can easily be installed with homebrew on macOS.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ brew install languagetool
</span></span></code></pre></div></li></ul><ul><li><p>Configuration</p><p>Next, we just need to point at the <code>languagetool-commandline.jar</code> file. Easily found somewhere in
the <code>$HOMEBREW_PREFIX</code> directory. Should probably have a better way to point at this though.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ find $HOMEBREW_PREFIX -name languagetool-commandline.jar
</span></span><span style=display:flex><span>/usr/local/Cellar/languagetool/5.6/libexec/languagetool-commandline.jar
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defun langtool-autoshow-detail-popup (overlays)
</span></span><span style=display:flex><span>  (when (require <span style=color:#e6db74>&#39;popup</span> <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Do not interrupt current popup</span>
</span></span><span style=display:flex><span>    (unless (or popup-instances
</span></span><span style=display:flex><span>                <span style=color:#75715e>;; suppress popup after type `C-g` .</span>
</span></span><span style=display:flex><span>                (<span style=color:#a6e22e>memq</span> last-command <span style=color:#f92672>&#39;</span>(keyboard-quit)))
</span></span><span style=display:flex><span>      (let ((msg (langtool-details-error-message overlays)))
</span></span><span style=display:flex><span>        (popup-tip msg)))))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! writegood-mode
</span></span><span style=display:flex><span>  (if (<span style=color:#a6e22e>file-exists-p</span> <span style=color:#e6db74>&#34;/usr/local/Cellar/languagetool/5.6/libexec/languagetool-commandline.jar&#34;</span>)
</span></span><span style=display:flex><span>      (setq langtool-language-tool-jar <span style=color:#e6db74>&#34;/usr/local/Cellar/languagetool/5.6/libexec/languagetool-commandline.jar&#34;</span>)
</span></span><span style=display:flex><span>      (setq langtool-autoshow-message-function <span style=color:#a6e22e>#&#39;</span>langtool-autoshow-detail-popup))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Ignoring these rules makes org files behave a little nicer</span>
</span></span><span style=display:flex><span>  (setq langtool-disabled-rules <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;WHITESPACE_RULE&#34;</span>
</span></span><span style=display:flex><span>                                  <span style=color:#e6db74>&#34;MORFOLOGIK_RULE_EN_US&#34;</span>
</span></span><span style=display:flex><span>                                  <span style=color:#e6db74>&#34;DOUBLE_PUNCTUATION&#34;</span>
</span></span><span style=display:flex><span>                                  <span style=color:#e6db74>&#34;COMMA_PARENTHESIS_WHITESPACE&#34;</span>)))
</span></span></code></pre></div></li></ul><h4 id=lorem-ipsum>Lorem-Ipsum</h4><p>Sometimes I need some example text to work on, use as placement holders and so on.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! lorem-ipsum)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! lorem-ipsum
</span></span><span style=display:flex><span>  :config (lorem-ipsum-use-default-bindings))
</span></span></code></pre></div><p>Default keybindings for this package is:</p><ul><li><code>C-c l s</code> - Insert sentences</li><li><code>C-c l p</code> - Insert paragraphs</li><li><code>C-c l l</code> - Insert lists</li></ul><h4 id=magit>Magit</h4><blockquote><p>From the <code>:tools magit</code> module</p></blockquote><p>Making <code>magit</code> a tad prettier.
(Taken from the <a href=http://www.modernemacs.com/#spacemacs>Modern Emacs</a> blog)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! magit
</span></span><span style=display:flex><span>  (defvar pretty-magit--alist <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;An alist of regexes, an icon, and face properties to apply to icon.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defvar pretty-magit--prompt <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;A list of commit leader prompt candidates.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defvar pretty-magit--use-commit-prompt? <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Do we need to use the magit commit prompt?&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun pretty-magit--add-magit-faces ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Add face properties and compose symbols for buffer from pretty-magit.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (with-silent-modifications
</span></span><span style=display:flex><span>      (-each pretty-magit--alist
</span></span><span style=display:flex><span>        (-lambda ((rgx char face-props))
</span></span><span style=display:flex><span>          (save-excursion
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>            (while (<span style=color:#a6e22e>re-search-forward</span> rgx <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>              (-let [(start end) (<span style=color:#a6e22e>match-data</span> <span style=color:#ae81ff>1</span>)]
</span></span><span style=display:flex><span>                (compose-region start end char)
</span></span><span style=display:flex><span>                (when face-props
</span></span><span style=display:flex><span>                  (<span style=color:#a6e22e>add-face-text-property</span> start end face-props)))))))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun pretty-magit-add-leader (word char face-props)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Replace sanitized WORD with CHAR having FACE-PROPS and add to prompts.&#34;</span>
</span></span><span style=display:flex><span>    (add-to-list <span style=color:#e6db74>&#39;pretty-magit--alist</span>
</span></span><span style=display:flex><span>                 (<span style=color:#a6e22e>list</span> (rx-to-string <span style=color:#f92672>`</span>(<span style=color:#f92672>:</span> bow
</span></span><span style=display:flex><span>                                       (group <span style=color:#f92672>,</span>word <span style=color:#e6db74>&#34;:&#34;</span>)))
</span></span><span style=display:flex><span>                       char face-props))
</span></span><span style=display:flex><span>    (add-to-list <span style=color:#e6db74>&#39;pretty-magit--prompt</span>
</span></span><span style=display:flex><span>                 (<span style=color:#a6e22e>concat</span> word <span style=color:#e6db74>&#34;: &#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun pretty-magit-add-leaders (leaders)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Map </span><span style=color:#e6db74>`pretty-magit-add-leader&#39;</span><span style=color:#e6db74> over LEADERS.&#34;</span>
</span></span><span style=display:flex><span>    (-each leaders
</span></span><span style=display:flex><span>      (-applify <span style=color:#a6e22e>#&#39;</span>pretty-magit-add-leader)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun pretty-magit--use-commit-prompt (<span style=color:#66d9ef>&amp;rest</span> args)
</span></span><span style=display:flex><span>    (setq pretty-magit--use-commit-prompt? <span style=color:#66d9ef>t</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun pretty-magit-commit-prompt ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Magit prompt and insert commit header with faces.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (when (and pretty-magit--use-commit-prompt?
</span></span><span style=display:flex><span>               pretty-magit--prompt)
</span></span><span style=display:flex><span>      (setq pretty-magit--use-commit-prompt? <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>insert</span> (<span style=color:#a6e22e>completing-read</span> <span style=color:#e6db74>&#34;Commit Type &#34;</span> pretty-magit--prompt <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#39;confirm</span>))
</span></span><span style=display:flex><span>      (pretty-magit--add-magit-faces)
</span></span><span style=display:flex><span>      (evil-insert <span style=color:#ae81ff>1</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun pretty-magit-setup (<span style=color:#66d9ef>&amp;optional</span> no-commit-prompts?)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Advise the appropriate magit funcs to add pretty-magit faces.&#34;</span>
</span></span><span style=display:flex><span>    (advice-add <span style=color:#e6db74>&#39;magit-status</span>         :after <span style=color:#e6db74>&#39;pretty-magit--add-magit-faces</span>)
</span></span><span style=display:flex><span>    (advice-add <span style=color:#e6db74>&#39;magit-refresh-buffer</span> :after <span style=color:#e6db74>&#39;pretty-magit--add-magit-faces</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    (unless no-commit-prompts?
</span></span><span style=display:flex><span>      (remove-hook <span style=color:#e6db74>&#39;git-commit-setup-hook</span> <span style=color:#e6db74>&#39;with-editor-usage-message</span>)
</span></span><span style=display:flex><span>      (add-hook    <span style=color:#e6db74>&#39;git-commit-setup-hook</span> <span style=color:#e6db74>&#39;pretty-magit-commit-prompt</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      (advice-add <span style=color:#e6db74>&#39;magit-commit-create</span> :after <span style=color:#e6db74>&#39;pretty-magit--use-commit-prompt</span>))))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! magit
</span></span><span style=display:flex><span>  (pretty-magit-add-leaders <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;feature&#34;</span> <span style=color:#e6db74>?</span> (:foreground <span style=color:#e6db74>&#34;slate gray&#34;</span> :height <span style=color:#ae81ff>1.2</span>))
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;add&#34;</span>     <span style=color:#e6db74>?</span> (:foreground <span style=color:#e6db74>&#34;#375E97&#34;</span> :height <span style=color:#ae81ff>1.2</span>))
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;fix&#34;</span>     <span style=color:#e6db74>?</span> (:foreground <span style=color:#e6db74>&#34;#FB6542&#34;</span> :height <span style=color:#ae81ff>1.2</span>))
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;clean&#34;</span>   <span style=color:#e6db74>?</span> (:foreground <span style=color:#e6db74>&#34;#FFBB00&#34;</span> :height <span style=color:#ae81ff>1.2</span>))
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;docs&#34;</span>    <span style=color:#e6db74>?</span> (:foreground <span style=color:#e6db74>&#34;#3F681C&#34;</span> :height <span style=color:#ae81ff>1.2</span>))))
</span></span><span style=display:flex><span>  (pretty-magit-setup))
</span></span></code></pre></div><h4 id=marginalia>Marginalia</h4><blockquote><p>From the <code>:completion vertico</code> module</p></blockquote><p><a href=https://github.com/minad/marginalia>Marginalia</a> is a tool (written by the same author as vertico) which adds marginalia to the
mini-buffer completions. Marginalia are marks and annotations placed at the margin of a page
in a book.</p><p>The below settings are basically just copied of <a href=https://tecosaur.github.io/emacs-config/config.html#marginalia>tecosaur&rsquo;s</a> config, and makes it look a bit nicer.</p><ul><li>Add color to file attributes</li><li>Don&rsquo;t display user:group information if I am the owner/group</li><li>When a file modified time is quite recent, use relative age (eg. <code>2h ago</code>)</li><li>Add fatter font face for bigger files</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! marginalia
</span></span><span style=display:flex><span>  (setq marginalia-censor-variables <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defadvice! +marginalia--anotate-local-file-colorful (cand)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Just a more colourful version of </span><span style=color:#e6db74>`marginalia--anotate-local-file&#39;</span><span style=color:#e6db74>.&#34;</span>
</span></span><span style=display:flex><span>    :override <span style=color:#a6e22e>#&#39;</span>marginalia--annotate-local-file
</span></span><span style=display:flex><span>    (when-let (attrs (<span style=color:#a6e22e>file-attributes</span> (<span style=color:#a6e22e>substitute-in-file-name</span>
</span></span><span style=display:flex><span>                                       (marginalia--full-candidate cand))
</span></span><span style=display:flex><span>                                      <span style=color:#e6db74>&#39;integer</span>))
</span></span><span style=display:flex><span>      (marginalia--fields
</span></span><span style=display:flex><span>       ((marginalia--file-owner attrs)
</span></span><span style=display:flex><span>        :width <span style=color:#ae81ff>12</span> :face <span style=color:#e6db74>&#39;marginalia-file-owner</span>)
</span></span><span style=display:flex><span>       ((marginalia--file-modes attrs))
</span></span><span style=display:flex><span>       ((+marginalia-file-size-colorful (file-attribute-size attrs))
</span></span><span style=display:flex><span>        :width <span style=color:#ae81ff>7</span>)
</span></span><span style=display:flex><span>       ((+marginalia--time-colorful (file-attribute-modification-time attrs))
</span></span><span style=display:flex><span>        :width <span style=color:#ae81ff>12</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +marginalia--time-colorful (time)
</span></span><span style=display:flex><span>    (let* ((seconds (<span style=color:#a6e22e>float-time</span> (<span style=color:#a6e22e>time-subtract</span> (<span style=color:#a6e22e>current-time</span>) time)))
</span></span><span style=display:flex><span>           (color (doom-blend
</span></span><span style=display:flex><span>                   (face-attribute <span style=color:#e6db74>&#39;marginalia-date</span> :foreground <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>                   (face-attribute <span style=color:#e6db74>&#39;marginalia-documentation</span> :foreground <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>                   (<span style=color:#a6e22e>/</span> <span style=color:#ae81ff>1.0</span> (<span style=color:#a6e22e>log</span> (<span style=color:#a6e22e>+</span> <span style=color:#ae81ff>3</span> (<span style=color:#a6e22e>/</span> (<span style=color:#a6e22e>+</span> <span style=color:#ae81ff>1</span> seconds) <span style=color:#ae81ff>345600.0</span>)))))))
</span></span><span style=display:flex><span>      <span style=color:#75715e>;; 1 - log(3 + 1/(days + 1)) % grey</span>
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>propertize</span> (marginalia--time time) <span style=color:#e6db74>&#39;face</span> (<span style=color:#a6e22e>list</span> :foreground color))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +marginalia-file-size-colorful (size)
</span></span><span style=display:flex><span>    (let* ((size-index (<span style=color:#a6e22e>/</span> (log10 (<span style=color:#a6e22e>+</span> <span style=color:#ae81ff>1</span> size)) <span style=color:#ae81ff>7.0</span>))
</span></span><span style=display:flex><span>           (color (if (<span style=color:#a6e22e>&lt;</span> size-index <span style=color:#ae81ff>10000000</span>) <span style=color:#75715e>; 10m</span>
</span></span><span style=display:flex><span>                      (doom-blend <span style=color:#e6db74>&#39;orange</span> <span style=color:#e6db74>&#39;green</span> size-index)
</span></span><span style=display:flex><span>                    (doom-blend <span style=color:#e6db74>&#39;red</span> <span style=color:#e6db74>&#39;orange</span> (<span style=color:#a6e22e>-</span> size-index <span style=color:#ae81ff>1</span>)))))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>propertize</span> (file-size-human-readable size) <span style=color:#e6db74>&#39;face</span> (<span style=color:#a6e22e>list</span> :foreground color)))))
</span></span></code></pre></div><h4 id=pinentry>Pinentry</h4><p>Emacs pinentry integration</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! pinentry)
</span></span></code></pre></div><h4 id=projectile>Projectile</h4><blockquote><p>From the <code>:core packages</code> module</p></blockquote><p>Set some sensible <code>projectile</code> settings.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq projectile-enable-caching               <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      projectile-project-search-path          <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;~/workspace&#34;</span>)  <span style=color:#75715e>;; A relic directory from when I used Eclipse back in the days</span>
</span></span><span style=display:flex><span>      projectile-globally-ignored-files       <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;.DS_Store&#34;</span>)    <span style=color:#75715e>;; Super annoying files</span>
</span></span><span style=display:flex><span>      projectile-globally-ignored-directories <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;.git&#34;</span>          <span style=color:#75715e>;; I never want to cache files in these directories</span>
</span></span><span style=display:flex><span>                                                <span style=color:#e6db74>&#34;.idea&#34;</span>
</span></span><span style=display:flex><span>                                                <span style=color:#e6db74>&#34;.import&#34;</span>
</span></span><span style=display:flex><span>                                                <span style=color:#e6db74>&#34;.elixir_ls&#34;</span>
</span></span><span style=display:flex><span>                                                <span style=color:#e6db74>&#34;.htmlcov&#34;</span>
</span></span><span style=display:flex><span>                                                <span style=color:#e6db74>&#34;.pytest_cache&#34;</span>
</span></span><span style=display:flex><span>                                                <span style=color:#e6db74>&#34;_build&#34;</span>
</span></span><span style=display:flex><span>                                                <span style=color:#e6db74>&#34;__pycache__&#34;</span>
</span></span><span style=display:flex><span>                                                <span style=color:#e6db74>&#34;deps&#34;</span>
</span></span><span style=display:flex><span>                                                <span style=color:#e6db74>&#34;node_modules&#34;</span>))
</span></span></code></pre></div><h4 id=smartparens>Smartparens</h4><blockquote><p>From the <code>:core packages</code> module.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! smart-parens
</span></span><span style=display:flex><span>  (sp-local-pair <span style=color:#f92672>&#39;</span>(org-mode) <span style=color:#e6db74>&#34;&lt;&lt;&#34;</span> <span style=color:#e6db74>&#34;&gt;&gt;&#34;</span> :actions <span style=color:#f92672>&#39;</span>(<span style=color:#a6e22e>insert</span>)))
</span></span></code></pre></div><h4 id=tramp>Tramp</h4><p>Tramp makes accessing remote file systems using Emacs a blast.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! tramp
</span></span><span style=display:flex><span>  (setq tramp-default-method <span style=color:#e6db74>&#34;scp&#34;</span>))
</span></span></code></pre></div><h4 id=tree-sitter>Tree-sitter</h4><p>Tree-sitter is a general programming language parser that efficiently builds and updates ASTs (Abstract Syntax Trees)
for your code.
Let&rsquo;s give it a spin!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! tree-sitter)
</span></span><span style=display:flex><span>(package! tree-sitter-langs)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! tree-sitter
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;tree-sitter-langs</span>)
</span></span><span style=display:flex><span>  (global-tree-sitter-mode)
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;tree-sitter-after-on-hook</span> <span style=color:#a6e22e>#&#39;</span>tree-sitter-hl-mode))
</span></span></code></pre></div><h4 id=treemacs>Treemacs</h4><p>Make <code>treemacs</code> pretty and functional.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! (treemacs winum)
</span></span><span style=display:flex><span>  (setq doom-themes-treemacs-theme <span style=color:#e6db74>&#34;doom-colors&#34;</span>)       <span style=color:#75715e>; Enable nice colors for treemacs</span>
</span></span><span style=display:flex><span>  (setq doom-themes-treemacs-enable-variable-pitch <span style=color:#66d9ef>nil</span>) <span style=color:#75715e>; Don&#39;t use variable-pitch font</span>
</span></span><span style=display:flex><span>  (setq winum-ignored-buffers-regexp
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>delete</span> (<span style=color:#a6e22e>regexp-quote</span> (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;%sFramebuffer-&#34;</span> treemacs--buffer-name-prefix))
</span></span><span style=display:flex><span>                winum-ignored-buffers-regexp))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (treemacs-project-follow-mode <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>  (treemacs-follow-mode <span style=color:#66d9ef>t</span>))
</span></span></code></pre></div><p>LSP-Treemacs is an integration package between <code>lsp-mode</code> and <code>treemacs</code>. It&rsquo;s nice :)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! (treemacs lsp-mode)
</span></span><span style=display:flex><span>  (lsp-treemacs-sync-mode <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(map! :leader
</span></span><span style=display:flex><span>      :after lsp-treemacs
</span></span><span style=display:flex><span>      (:prefix-map (<span style=color:#e6db74>&#34;c&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;code&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;List errors (LSP Treemacs)&#34;</span> <span style=color:#e6db74>&#34;X&#34;</span> <span style=color:#a6e22e>#&#39;</span>lsp-treemacs-errors-list)
</span></span><span style=display:flex><span>      (:prefix-map (<span style=color:#e6db74>&#34;t&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;toggle&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;LSP symbols&#34;</span>                <span style=color:#e6db74>&#34;y&#34;</span> <span style=color:#a6e22e>#&#39;</span>lsp-treemacs-symbols))
</span></span></code></pre></div><h4 id=vertico>Vertico</h4><blockquote><p>From the <code>:completion vertico</code> module</p></blockquote><p><a href=https://github.com/minad/vertico>Vertico</a> is the new kid on the block when it comes to searching in Emacs. Built on top of the native
Emacs search APIs instead of 3rd party tools.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! vertico
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Emacs 28+: Hide commands in M-x that doesn&#39;t work in the current mode.</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; Vertico commands are hidden in normal buffers.</span>
</span></span><span style=display:flex><span>  (setq read-extended-command-predicate <span style=color:#a6e22e>#&#39;</span>command-completion-default-include-p)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; These mappings seems a bit inverted, but it works as I like it, so I dunno...?</span>
</span></span><span style=display:flex><span>  (map! :map vertico-map
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;C-u&#34;</span>   <span style=color:#a6e22e>#&#39;</span>vertico-scroll-down
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;C-d&#34;</span>   <span style=color:#a6e22e>#&#39;</span>vertico-scroll-up))
</span></span></code></pre></div><p><strong>Tips&rsquo;n tricks</strong></p><ul><li>Sometimes you want to input some value that&rsquo;s similar to a pre-selected choice. We can use the input
value by hitting <code>M-&lt;enter></code> to use our input value instead of the pre-selected value.</li></ul><ul><li><p>Vertico Posframe (experimental)</p><p>I&rsquo;ve seen some cool stuff using a separate <code>posframe</code> for displaying <code>vertico</code> results. I&rsquo;m still not convinced,
because it tends to hide the content of my buffers when displayed on top of it.
Either case; it can be enabled by installing the <code>vertico-posframe</code> package.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! vertico-posframe)
</span></span></code></pre></div><p>And enabled like this.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! vertico
</span></span><span style=display:flex><span>  (vertico-posframe-mode <span style=color:#ae81ff>1</span>))
</span></span></code></pre></div></li></ul><h4 id=very-large-files>Very large files</h4><p>The <a href=https://github.com/m00natic/vlf>very large files</a> mode loads large files in chunks, letting us open ridiculously large files!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! vlf
</span></span><span style=display:flex><span>  :recipe (:host github :repo <span style=color:#e6db74>&#34;m00natic/vlfi&#34;</span> :files (<span style=color:#e6db74>&#34;*.el&#34;</span>) :branch <span style=color:#e6db74>&#34;master&#34;</span>))
</span></span></code></pre></div><p>We usually don&rsquo;t need this package right away, so we&rsquo;ll delay the loading a bit.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! vlf-setup
</span></span><span style=display:flex><span>  :defer-incrementally vlf-tune vlf-base vlf-write vlf-search vlf-occur vlf-follow vlf-ediff vlf)
</span></span></code></pre></div><h4 id=vterm>VTerm</h4><blockquote><p>From the <code>:term vterm</code> module</p></blockquote><p>The <code>vterm</code> gives us native performing terminal emulation inside Emacs; what&rsquo;s not to like?</p><p><strong>TODO - Annoying stuff that doesn&rsquo;t work in vterm</strong></p><ul><li><code>&lt;delete></code> doesn&rsquo;t delete words forwards</li><li><code>M-&lt;backspace></code> doesn&rsquo;t delete words backwards</li><li>Can&rsquo;t type <code>M</code>??</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :after vterm
</span></span><span style=display:flex><span>      :map vterm-mode-map
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;M-&lt;backspace&gt;&#34;</span> <span style=color:#a6e22e>#&#39;</span>vterm-send-meta-backspace)
</span></span></code></pre></div><h4 id=yasnippet>YASnippet</h4><blockquote><p>From the <code>:editor snippets</code> module.</p></blockquote><p>Enable nested snippets.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq yas-triggers-in-field <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div><p><strong>Extra snippets</strong>
Snippets are basic text files (no extension), located in directories representing the mode they will
be active for. For a quick guide on how we can organize snippets, take a look at this <a href=https://joaotavora.github.io/yasnippet/snippet-organization.html>page</a>.</p><pre tabindex=0><code class=language-nil data-lang=nil>.
|-- c-mode
|   -- printf
|-- elixir-mode
|   -- defmodule
|   -- macro
|-- org-mode
    -- header-props
    -- and-so-on
</code></pre><p>I like to keep my custom stuff in the <em>misc</em> directory.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq +snippets-dir (<span style=color:#a6e22e>concat</span> (<span style=color:#a6e22e>file-name-as-directory</span> doom-private-dir) <span style=color:#e6db74>&#34;misc/snippets&#34;</span>))
</span></span></code></pre></div><h3 id=visuals>Visuals</h3><h4 id=info-colors>Info colors</h4><p>This makes manual pages look pretty by adding variable pitch fortification and colors 🤗</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! info-colors)
</span></span></code></pre></div><p>To use this we&rsquo;ll just hook into <code>Info</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! info-colors
</span></span><span style=display:flex><span>  :after info
</span></span><span style=display:flex><span>  :hook (Info-selection-hook <span style=color:#f92672>.</span> info-colors-fontify-node)
</span></span><span style=display:flex><span>  :commands (info-colors-fontify-node))
</span></span></code></pre></div><h4 id=writeroom>Writeroom</h4><blockquote><p>From the <code>:ui zen</code> module.</p></blockquote><p>I&rsquo;d like to toggle <code>writeroom-mode</code> for all buffers at once.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :leader
</span></span><span style=display:flex><span>      (:when (featurep! :ui zen)
</span></span><span style=display:flex><span>       (:prefix-map (<span style=color:#e6db74>&#34;t&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;toggle&#34;</span>)
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Zen mode&#34;</span>        <span style=color:#e6db74>&#34;z&#34;</span>     <span style=color:#a6e22e>#&#39;</span>global-writeroom-mode)))
</span></span></code></pre></div><p>Slightly decrease the default text scale for <code>writeroom-mode</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq +zen-text-scale <span style=color:#ae81ff>0.8</span>)
</span></span></code></pre></div><p>When using Writeroom mode with Org, make some additional aesthetic tweaks:</p><ul><li>Use a serifed variable-pitch font</li><li>Hide headline leading stars</li><li>Nicer headline bullets</li><li>Hide line numbers</li><li>Remove outline indentation</li><li>Centering the text</li><li>Turn on <code>org-pretty-table-mode</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(defvar +zen-serif-p <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Wheter to use a serifed font with </span><span style=color:#e6db74>`mixed-pitch-mode&#39;</span><span style=color:#e6db74>.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(after! writeroom-mode
</span></span><span style=display:flex><span>  (defvar-local +zen--original-org-indent-mode-p <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>  (defvar-local +zen--original-mixed-pitch-mode-p <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>  (defvar-local +zen--original-org-pretty-table-mode-p <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>  (defun +zen-enable-mixed-pitch-mode-h ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Enable </span><span style=color:#e6db74>`mixed-pitch-mode&#39;</span><span style=color:#e6db74> when in </span><span style=color:#e6db74>`+zen-mixed-pitch-modes&#39;</span><span style=color:#e6db74>.&#34;</span>
</span></span><span style=display:flex><span>    (when (<span style=color:#a6e22e>apply</span> <span style=color:#a6e22e>#&#39;</span>derived-mode-p +zen-mixed-pitch-modes)
</span></span><span style=display:flex><span>      (if writeroom-mode
</span></span><span style=display:flex><span>          (progn
</span></span><span style=display:flex><span>            (setq +zen--original-mixed-pitch-mode-p mixed-pitch-mode)
</span></span><span style=display:flex><span>            (<span style=color:#a6e22e>funcall</span> (if +zen-serif-p <span style=color:#a6e22e>#&#39;</span>mixed-pitch-serif-mode <span style=color:#a6e22e>#&#39;</span>mixed-pitch-mode) <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>funcall</span> <span style=color:#a6e22e>#&#39;</span>mixed-pitch-mode (if +zen--original-mixed-pitch-mode-p <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>-1</span>)))))
</span></span><span style=display:flex><span>  (pushnew! writeroom--local-variables
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;display-line-numbers</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;visual-fill-column-width</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;org-adapt-indentation</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;org-superstar-headline-bullets-list</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;org-superstar-remove-leading-stars</span>)
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;writeroom-mode-enable-hook</span>
</span></span><span style=display:flex><span>            (defun +zen-prose-org-h ()
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;Reformat the current Org buffer appearance for prose.&#34;</span>
</span></span><span style=display:flex><span>              (when (<span style=color:#a6e22e>eq</span> major-mode <span style=color:#e6db74>&#39;org-mode</span>)
</span></span><span style=display:flex><span>                (setq display-line-numbers <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                      visual-fill-column-width <span style=color:#ae81ff>60</span>
</span></span><span style=display:flex><span>                      org-adapt-indentation <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>                (when (featurep <span style=color:#e6db74>&#39;org-superstar</span>)
</span></span><span style=display:flex><span>                  (setq-local org-superstar-headline-bullets-list <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;🙘&#34;</span> <span style=color:#e6db74>&#34;🙙&#34;</span> <span style=color:#e6db74>&#34;🙚&#34;</span> <span style=color:#e6db74>&#34;🙛&#34;</span>)
</span></span><span style=display:flex><span>                              <span style=color:#75715e>;; org-superstar-headline-bullets-list &#39;(&#34;🙐&#34; &#34;🙑&#34; &#34;🙒&#34; &#34;🙓&#34; &#34;🙔&#34; &#34;🙕&#34; &#34;🙖&#34; &#34;🙗&#34;)</span>
</span></span><span style=display:flex><span>                              org-superstar-remove-leading-stars <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>                  (org-superstar-restart))
</span></span><span style=display:flex><span>                (setq
</span></span><span style=display:flex><span>                 +zen--original-org-indent-mode-p org-indent-mode
</span></span><span style=display:flex><span>                 +zen--original-org-pretty-table-mode-p (bound-and-true-p org-pretty-table-mode))
</span></span><span style=display:flex><span>                (org-indent-mode <span style=color:#ae81ff>-1</span>)
</span></span><span style=display:flex><span>                (org-pretty-table-mode <span style=color:#ae81ff>1</span>))))
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;writeroom-mode-disable-hook</span>
</span></span><span style=display:flex><span>            (defun +zen-nonprose-org-h ()
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;Reverse the effect of </span><span style=color:#e6db74>`+zen-prose-org&#39;</span><span style=color:#e6db74>.&#34;</span>
</span></span><span style=display:flex><span>              (when (<span style=color:#a6e22e>eq</span> major-mode <span style=color:#e6db74>&#39;org-mode</span>)
</span></span><span style=display:flex><span>                (when (featurep <span style=color:#e6db74>&#39;org-superstar</span>)
</span></span><span style=display:flex><span>                  (org-superstar-restart))
</span></span><span style=display:flex><span>                (when +zen--original-org-indent-mode-p (org-indent-mode <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>                <span style=color:#75715e>;; (unless +zen--original-org-pretty-table-mode-p (org-pretty-table-mode -1))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>;; TODO disable ahs-mode</span>
</span></span><span style=display:flex><span>                ))))
</span></span></code></pre></div><h2 id=language-configurations>Language configurations</h2><h3 id=general>General</h3><p>General configuration</p><h4 id=file-templates>File templates</h4><p>For some file types, we overwrite defaults in the snippets directory, others need to have a template assigned.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; (set-file-template! &#34;\\.tex$&#34; :trigger &#34;__&#34; :mode &#39;latex-mode)</span>
</span></span><span style=display:flex><span>(set-file-template! <span style=color:#e6db74>&#34;\\.org$&#34;</span> :trigger <span style=color:#e6db74>&#34;__&#34;</span> :mode <span style=color:#e6db74>&#39;org-mode</span>)
</span></span><span style=display:flex><span>(set-file-template! <span style=color:#e6db74>&#34;/LICEN[CS]E$&#34;</span> :trigger <span style=color:#e6db74>&#39;+file-templates/insert-license</span>)
</span></span></code></pre></div><h3 id=yaml>Yaml</h3><p>Yaml comes in many different flavors, let&rsquo;s select schema with <code>,-s</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :map yaml-mode-map
</span></span><span style=display:flex><span>      :localleader
</span></span><span style=display:flex><span>      :desc <span style=color:#e6db74>&#34;Select buffer schema&#34;</span>      <span style=color:#e6db74>&#34;s&#34;</span>     <span style=color:#a6e22e>#&#39;</span>lsp-yaml-select-buffer-schema)
</span></span></code></pre></div><h3 id=plaintext>Plaintext</h3><p>It’s nice to see ANSI colour codes displayed. However, until Emacs 28 it’s not possible to do this without modifying the buffer, so let’s condition this block on that.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! text-mode
</span></span><span style=display:flex><span>  (add-hook! <span style=color:#e6db74>&#39;text-mode-hook</span>
</span></span><span style=display:flex><span>             <span style=color:#75715e>;; Apply ANSI color codes</span>
</span></span><span style=display:flex><span>             (with-silent-modifications
</span></span><span style=display:flex><span>               (ansi-color-apply-on-region (<span style=color:#a6e22e>point-min</span>) (<span style=color:#a6e22e>point-max</span>) <span style=color:#66d9ef>t</span>))))
</span></span></code></pre></div><h3 id=org>Org</h3><p>Everybody likes org-mode!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-directory                             <span style=color:#e6db74>&#34;~/Dropbox/org&#34;</span>
</span></span><span style=display:flex><span>      org-crypt-key                             <span style=color:#e6db74>&#34;rhblind@gmail.com&#34;</span>
</span></span><span style=display:flex><span>      org-tag-alist                             <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;crypt&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>?c</span>))
</span></span><span style=display:flex><span>      org-id-link-to-org-use-id                 <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      org-agenda-text-search-extra-files        <span style=color:#f92672>&#39;</span>())
</span></span><span style=display:flex><span>(setq org-download-image-dir (<span style=color:#a6e22e>concat</span> (<span style=color:#a6e22e>file-name-as-directory</span> org-directory) <span style=color:#e6db74>&#34;images&#34;</span>))
</span></span></code></pre></div><h4 id=behaviour>Behaviour</h4><ul><li><p>Keybindings</p><p>Add some handy keybindings under <code>SPC-, x</code> for emphasizing text in <code>org-mode</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! org
</span></span><span style=display:flex><span>  (defmacro cust/org-emphasize (fname char)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Macro that creates a function for setting emphasises in org-mode&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>`</span>(defun <span style=color:#f92672>,</span>fname () (interactive)
</span></span><span style=display:flex><span>            (org-emphasize <span style=color:#f92672>,</span>char))))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :map org-mode-map
</span></span><span style=display:flex><span>      :after org
</span></span><span style=display:flex><span>      :localleader <span style=color:#e6db74>&#34;x&#34;</span> <span style=color:#66d9ef>nil</span>                                      <span style=color:#75715e>;; raises Key sequence error when trying to rebind below unless unset first.</span>
</span></span><span style=display:flex><span>      :desc <span style=color:#e6db74>&#34;org-toggle-checkbox&#34;</span> <span style=color:#e6db74>&#34;X&#34;</span>   <span style=color:#a6e22e>#&#39;</span>org-toggle-checkbox)  <span style=color:#75715e>;; rebind org-toggle-checkbox to &#34;X&#34;</span>
</span></span><span style=display:flex><span>(map! :map org-mode-map
</span></span><span style=display:flex><span>      :after org
</span></span><span style=display:flex><span>      :localleader
</span></span><span style=display:flex><span>      (:prefix (<span style=color:#e6db74>&#34;x&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;text&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;bold&#34;</span>             <span style=color:#e6db74>&#34;b&#34;</span>     (cust/org-emphasize cust/org-emphasize-bold <span style=color:#e6db74>?*</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;code&#34;</span>             <span style=color:#e6db74>&#34;c&#34;</span>     (cust/org-emphasize cust/org-emphasize-code <span style=color:#e6db74>?~</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;italic&#34;</span>           <span style=color:#e6db74>&#34;i&#34;</span>     (cust/org-emphasize cust/org-emphasize-italic <span style=color:#e6db74>?/</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;clear&#34;</span>            <span style=color:#e6db74>&#34;r&#34;</span>     (cust/org-emphasize cust/org-emphasize-clear <span style=color:#e6db74>? </span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;strike-through&#34;</span>   <span style=color:#e6db74>&#34;s&#34;</span>     (cust/org-emphasize cust/org-emphasize-strike-through <span style=color:#e6db74>?+</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;underline&#34;</span>        <span style=color:#e6db74>&#34;u&#34;</span>     (cust/org-emphasize cust/org-emphasize-underline <span style=color:#e6db74>?_</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;verbatim&#34;</span>         <span style=color:#e6db74>&#34;v&#34;</span>     (cust/org-emphasize cust/org-emphasize-verbatim <span style=color:#e6db74>?=</span>)))
</span></span></code></pre></div></li></ul><h4 id=babel>Babel</h4><p>Org babel is used to evaluate code blocks in org files.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! org
</span></span><span style=display:flex><span>  (setq org-confirm-babel-evaluate   <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>        org-src-fontify-natively     <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-src-tab-acts-natively    <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-src-preserve-indentation <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-src-window-setup         <span style=color:#e6db74>&#39;current-window</span>
</span></span><span style=display:flex><span>        org-babel-default-header-args <span style=color:#f92672>&#39;</span>((:session <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;none&#34;</span>)
</span></span><span style=display:flex><span>                                        (:results <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;replace&#34;</span>)
</span></span><span style=display:flex><span>                                        (:exports <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;code&#34;</span>)
</span></span><span style=display:flex><span>                                        (:cache   <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;no&#34;</span>)
</span></span><span style=display:flex><span>                                        (:noweb   <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;no&#34;</span>)
</span></span><span style=display:flex><span>                                        (:hlines  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;no&#34;</span>)
</span></span><span style=display:flex><span>                                        (:tangle  <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;no&#34;</span>)
</span></span><span style=display:flex><span>                                        (:comment <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;link&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (add-to-list <span style=color:#e6db74>&#39;org-babel-load-languages</span> <span style=color:#f92672>&#39;</span>(dot <span style=color:#f92672>.</span> <span style=color:#66d9ef>t</span>)))
</span></span></code></pre></div><p>Sometimes it&rsquo;s nice to auto-format code blocks.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! org
</span></span><span style=display:flex><span>  (defun org-indent-src-block ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Indent the source block at point.&#34;</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (when (org-in-src-block-p)
</span></span><span style=display:flex><span>      (org-edit-special)
</span></span><span style=display:flex><span>      (indent-region (<span style=color:#a6e22e>point-min</span>) (<span style=color:#a6e22e>point-max</span>))
</span></span><span style=display:flex><span>      (org-edit-src-exit))))
</span></span></code></pre></div><h4 id=reveal-export>Reveal export</h4><p>By default reveal is rather nice, there are just a few tweaks that I consider a good idea.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-re-reveal-theme <span style=color:#e6db74>&#34;white&#34;</span>
</span></span><span style=display:flex><span>      org-re-reveal-transition <span style=color:#e6db74>&#34;slide&#34;</span>
</span></span><span style=display:flex><span>      org-re-reveal-plugins <span style=color:#f92672>&#39;</span>(markdown notes math search zoom))
</span></span></code></pre></div><h4 id=hugo--blog>Hugo (Blog)</h4><blockquote><p>From the <code>:lang org +hugo</code> module</p></blockquote><p>Install the <code>hugo</code> blog engine using homebrew, and set the <code>org-hugo-base-dir</code> variable.
(We can also set the <code>HUGO_BASE_DIR</code> environmental variable).</p><dl><dt>[[<a href=https://spcbfr.vercel.app/posts/blogging-setup-hugo-and-org>https://spcbfr.vercel.app/posts/blogging-setup-hugo-and-org</a>][How to make a blog with hugo and org-mode</dt><dd>Youssef Bouzekri — A developer w&mldr;]]</dd></dl><p><a href=https://gohugo.io/hosting-and-deployment/hosting-on-github/>Host on GitHub | Hugo</a></p><p><a href=https://hugocisneros.com/org-config/>Org-mode configuration for Emacs - Hugo Cisneros</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(when (and (featurep! :lang org +hugo) (<span style=color:#a6e22e>eq</span> system-type <span style=color:#e6db74>&#39;darwin</span>))
</span></span><span style=display:flex><span>  (setq org-hugo-base-dir (<span style=color:#a6e22e>concat</span> (<span style=color:#a6e22e>expand-file-name</span> (<span style=color:#a6e22e>file-name-as-directory</span> <span style=color:#e6db74>&#34;~&#34;</span>)) <span style=color:#e6db74>&#34;workspace/hugo-blog&#34;</span>)))
</span></span></code></pre></div><p>Create a new blog</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ brew install hugo
</span></span><span style=display:flex><span>$ hugo new site ~/Dropbox/org/hugo-blog
</span></span></code></pre></div><h4 id=roam>Roam</h4><blockquote><p>From the <code>:lang org +roam</code> module</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-roam-v2-ack        <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      org-roam-directory     (<span style=color:#a6e22e>concat</span> (<span style=color:#a6e22e>file-name-as-directory</span> org-directory) <span style=color:#e6db74>&#34;roam&#34;</span>))
</span></span><span style=display:flex><span>(setq org-roam-index-file    (<span style=color:#a6e22e>concat</span> (<span style=color:#a6e22e>file-name-as-directory</span> org-roam-directory) <span style=color:#e6db74>&#34;index.org&#34;</span>))
</span></span></code></pre></div><p>Make sure roam is available on startup.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(org-roam-db-autosync-mode)
</span></span></code></pre></div><p>Add all <code>org-roam</code> files to list of extra files to be searched by text commands.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! (org org-roam)
</span></span><span style=display:flex><span>  (setq org-agenda-text-search-extra-files (org-roam--list-files org-roam-directory)))
</span></span></code></pre></div><h4 id=krita>Krita</h4><p>Krita is a wonderful digital painting program which also can be made available in org-mode for doing quick
sketching or hand written notes and so on.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! org-krita
</span></span><span style=display:flex><span>  :recipe (:host github
</span></span><span style=display:flex><span>           :repo <span style=color:#e6db74>&#34;lepisma/org-krita&#34;</span>
</span></span><span style=display:flex><span>           :files (<span style=color:#e6db74>&#34;resources&#34;</span> <span style=color:#e6db74>&#34;resources&#34;</span> <span style=color:#e6db74>&#34;*.el&#34;</span> <span style=color:#e6db74>&#34;*.el&#34;</span>)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-krita
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (add-hook <span style=color:#e6db74>&#39;org-mode-hook</span> <span style=color:#e6db74>&#39;org-krita-mode</span>)
</span></span><span style=display:flex><span>  (when (<span style=color:#a6e22e>eq</span> system-type <span style=color:#e6db74>&#39;darwin</span>)
</span></span><span style=display:flex><span>    (setq org-krita-executable <span style=color:#e6db74>&#34;/Applications/krita.app/Contents/MacOS/krita&#34;</span>)))
</span></span></code></pre></div><h4 id=visuals>Visuals</h4><ul><li><p>Tables</p><p>Org tables aren’t the prettiest thing to look at.
This package is supposed to redraw them in the buffer with box-drawing characters.
Sounds like an improvement to me! We’ll make use of this with writeroom-mode.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! org-pretty-table
</span></span><span style=display:flex><span>  :recipe (:host github :repo <span style=color:#e6db74>&#34;Fuco1/org-pretty-table&#34;</span> :branch <span style=color:#e6db74>&#34;master&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-pretty-table
</span></span><span style=display:flex><span>  :hook (org-mode <span style=color:#f92672>.</span> org-pretty-table-mode)
</span></span><span style=display:flex><span>  :commands (org-pretty-table-mod global-org-pretty-table-mode))
</span></span></code></pre></div></li></ul><ul><li><p>Emphasis markers</p><p>While org-hide-emphasis-markers is very nice, it can sometimes make edits which
occur at the border a bit more fiddley.
We can improve this situation without sacrificing visual amenities with the org-appear package.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! org-appear :recipe (:host github :repo <span style=color:#e6db74>&#34;awth13/org-appear&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-appear
</span></span><span style=display:flex><span>  :hook (org-mode <span style=color:#f92672>.</span> org-appear-mode)
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (setq org-appear-autoemphasis <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-appear-autosubmarkers <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        org-appear-autolinks <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; for proper first-time setup, `org-appear--set-elements&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; needs to be run after other hooks have acted.</span>
</span></span><span style=display:flex><span>  (run-at-time <span style=color:#66d9ef>nil</span> <span style=color:#66d9ef>nil</span> <span style=color:#a6e22e>#&#39;</span>org-appear--set-elements))
</span></span></code></pre></div></li></ul><ul><li><p>Heading minimap</p><p>Outline structure of the org documents.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! org-ol-tree :recipe (:host github :repo <span style=color:#e6db74>&#34;Townk/org-ol-tree&#34;</span>))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-ol-tree
</span></span><span style=display:flex><span>  :commands org-ol-tree)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(map! :map org-mode-map
</span></span><span style=display:flex><span>      :after org
</span></span><span style=display:flex><span>      :localleader
</span></span><span style=display:flex><span>      :desc <span style=color:#e6db74>&#34;Outline&#34;</span> <span style=color:#e6db74>&#34;O&#34;</span> <span style=color:#a6e22e>#&#39;</span>org-ol-tree)
</span></span></code></pre></div></li></ul><ul><li><p>Symbols</p><p>This section is pretty much just copied from tecosaurs config (again&mldr;)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! org-superstar
</span></span><span style=display:flex><span>  (setq org-superstar-headline-bullets-list <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;◉&#34;</span> <span style=color:#e6db74>&#34;○&#34;</span> <span style=color:#e6db74>&#34;✸&#34;</span> <span style=color:#e6db74>&#34;✿&#34;</span> <span style=color:#e6db74>&#34;✤&#34;</span> <span style=color:#e6db74>&#34;✜&#34;</span> <span style=color:#e6db74>&#34;◆&#34;</span> <span style=color:#e6db74>&#34;▶&#34;</span>)
</span></span><span style=display:flex><span>        org-superstar-prettify-item-bullets <span style=color:#66d9ef>t</span> ))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(setq org-ellipsis <span style=color:#e6db74>&#34; ▾ &#34;</span>
</span></span><span style=display:flex><span>      org-hide-leading-stars <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      org-priority-highest <span style=color:#e6db74>?A</span>
</span></span><span style=display:flex><span>      org-priority-lowest <span style=color:#e6db74>?E</span>
</span></span><span style=display:flex><span>      org-priority-faces
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>?A</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;all-the-icons-red</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>?B</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;all-the-icons-orange</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>?C</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;all-the-icons-yellow</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>?D</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;all-the-icons-green</span>)
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>?E</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;all-the-icons-blue</span>)))
</span></span></code></pre></div><p>It&rsquo;s also nice to make use of the Unicode characters for check boxes, and other commands.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(appendq! +ligatures-extra-symbols
</span></span><span style=display:flex><span>          <span style=color:#f92672>`</span>(:checkbox      <span style=color:#e6db74>&#34;☐&#34;</span>
</span></span><span style=display:flex><span>            :pending       <span style=color:#e6db74>&#34;◼&#34;</span>
</span></span><span style=display:flex><span>            :checkedbox    <span style=color:#e6db74>&#34;☑&#34;</span>
</span></span><span style=display:flex><span>            :list_property <span style=color:#e6db74>&#34;∷&#34;</span>
</span></span><span style=display:flex><span>            :em_dash       <span style=color:#e6db74>&#34;—&#34;</span>
</span></span><span style=display:flex><span>            :ellipses      <span style=color:#e6db74>&#34;…&#34;</span>
</span></span><span style=display:flex><span>            :arrow_right   <span style=color:#e6db74>&#34;→&#34;</span>
</span></span><span style=display:flex><span>            :arrow_left    <span style=color:#e6db74>&#34;←&#34;</span>
</span></span><span style=display:flex><span>            :title         <span style=color:#e6db74>&#34;𝙏&#34;</span>
</span></span><span style=display:flex><span>            :subtitle      <span style=color:#e6db74>&#34;𝙩&#34;</span>
</span></span><span style=display:flex><span>            :author        <span style=color:#e6db74>&#34;𝘼&#34;</span>
</span></span><span style=display:flex><span>            :date          <span style=color:#e6db74>&#34;𝘿&#34;</span>
</span></span><span style=display:flex><span>            :property      <span style=color:#e6db74>&#34;☸&#34;</span>
</span></span><span style=display:flex><span>            :options       <span style=color:#e6db74>&#34;⌥&#34;</span>
</span></span><span style=display:flex><span>            :startup       <span style=color:#e6db74>&#34;⏻&#34;</span>
</span></span><span style=display:flex><span>            :macro         <span style=color:#e6db74>&#34;𝓜&#34;</span>
</span></span><span style=display:flex><span>            :html_head     <span style=color:#e6db74>&#34;🅷&#34;</span>
</span></span><span style=display:flex><span>            :html          <span style=color:#e6db74>&#34;🅗&#34;</span>
</span></span><span style=display:flex><span>            :latex_class   <span style=color:#e6db74>&#34;🄻&#34;</span>
</span></span><span style=display:flex><span>            :latex_header  <span style=color:#e6db74>&#34;🅻&#34;</span>
</span></span><span style=display:flex><span>            :beamer_header <span style=color:#e6db74>&#34;🅑&#34;</span>
</span></span><span style=display:flex><span>            :latex         <span style=color:#e6db74>&#34;🅛&#34;</span>
</span></span><span style=display:flex><span>            :attr_latex    <span style=color:#e6db74>&#34;🄛&#34;</span>
</span></span><span style=display:flex><span>            :attr_html     <span style=color:#e6db74>&#34;🄗&#34;</span>
</span></span><span style=display:flex><span>            :attr_org      <span style=color:#e6db74>&#34;⒪&#34;</span>
</span></span><span style=display:flex><span>            :begin_quote   <span style=color:#e6db74>&#34;❝&#34;</span>
</span></span><span style=display:flex><span>            :end_quote     <span style=color:#e6db74>&#34;❞&#34;</span>
</span></span><span style=display:flex><span>            :caption       <span style=color:#e6db74>&#34;☰&#34;</span>
</span></span><span style=display:flex><span>            :header        <span style=color:#e6db74>&#34;›&#34;</span>
</span></span><span style=display:flex><span>            :results       <span style=color:#e6db74>&#34;🠶&#34;</span>
</span></span><span style=display:flex><span>            :begin_export  <span style=color:#e6db74>&#34;⏩&#34;</span>
</span></span><span style=display:flex><span>            :end_export    <span style=color:#e6db74>&#34;⏪&#34;</span>
</span></span><span style=display:flex><span>            :properties    <span style=color:#e6db74>&#34;⚙&#34;</span>
</span></span><span style=display:flex><span>            :end           <span style=color:#e6db74>&#34;∎&#34;</span>
</span></span><span style=display:flex><span>            :priority_a   <span style=color:#f92672>,</span>(<span style=color:#a6e22e>propertize</span> <span style=color:#e6db74>&#34;⚑&#34;</span> <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;all-the-icons-red</span>)
</span></span><span style=display:flex><span>            :priority_b   <span style=color:#f92672>,</span>(<span style=color:#a6e22e>propertize</span> <span style=color:#e6db74>&#34;⬆&#34;</span> <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;all-the-icons-orange</span>)
</span></span><span style=display:flex><span>            :priority_c   <span style=color:#f92672>,</span>(<span style=color:#a6e22e>propertize</span> <span style=color:#e6db74>&#34;■&#34;</span> <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;all-the-icons-yellow</span>)
</span></span><span style=display:flex><span>            :priority_d   <span style=color:#f92672>,</span>(<span style=color:#a6e22e>propertize</span> <span style=color:#e6db74>&#34;⬇&#34;</span> <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;all-the-icons-green</span>)
</span></span><span style=display:flex><span>            :priority_e   <span style=color:#f92672>,</span>(<span style=color:#a6e22e>propertize</span> <span style=color:#e6db74>&#34;❓&#34;</span> <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;all-the-icons-blue</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(set-ligatures! <span style=color:#e6db74>&#39;org-mode</span>
</span></span><span style=display:flex><span>  :merge <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>  :checkbox      <span style=color:#e6db74>&#34;[ ]&#34;</span>
</span></span><span style=display:flex><span>  :pending       <span style=color:#e6db74>&#34;[-]&#34;</span>
</span></span><span style=display:flex><span>  :checkedbox    <span style=color:#e6db74>&#34;[X]&#34;</span>
</span></span><span style=display:flex><span>  :list_property <span style=color:#e6db74>&#34;::&#34;</span>
</span></span><span style=display:flex><span>  :em_dash       <span style=color:#e6db74>&#34;---&#34;</span>
</span></span><span style=display:flex><span>  :ellipsis      <span style=color:#e6db74>&#34;...&#34;</span>
</span></span><span style=display:flex><span>  :arrow_right   <span style=color:#e6db74>&#34;-&gt;&#34;</span>
</span></span><span style=display:flex><span>  :arrow_left    <span style=color:#e6db74>&#34;&lt;-&#34;</span>
</span></span><span style=display:flex><span>  :title         <span style=color:#e6db74>&#34;#+title:&#34;</span>
</span></span><span style=display:flex><span>  :subtitle      <span style=color:#e6db74>&#34;#+subtitle:&#34;</span>
</span></span><span style=display:flex><span>  :author        <span style=color:#e6db74>&#34;#+author:&#34;</span>
</span></span><span style=display:flex><span>  :date          <span style=color:#e6db74>&#34;#+date:&#34;</span>
</span></span><span style=display:flex><span>  :property      <span style=color:#e6db74>&#34;#+property:&#34;</span>
</span></span><span style=display:flex><span>  :options       <span style=color:#e6db74>&#34;#+options:&#34;</span>
</span></span><span style=display:flex><span>  :startup       <span style=color:#e6db74>&#34;#+startup:&#34;</span>
</span></span><span style=display:flex><span>  :macro         <span style=color:#e6db74>&#34;#+macro:&#34;</span>
</span></span><span style=display:flex><span>  :html_head     <span style=color:#e6db74>&#34;#+html_head:&#34;</span>
</span></span><span style=display:flex><span>  :html          <span style=color:#e6db74>&#34;#+html:&#34;</span>
</span></span><span style=display:flex><span>  :latex_class   <span style=color:#e6db74>&#34;#+latex_class:&#34;</span>
</span></span><span style=display:flex><span>  :latex_header  <span style=color:#e6db74>&#34;#+latex_header:&#34;</span>
</span></span><span style=display:flex><span>  :beamer_header <span style=color:#e6db74>&#34;#+beamer_header:&#34;</span>
</span></span><span style=display:flex><span>  :latex         <span style=color:#e6db74>&#34;#+latex:&#34;</span>
</span></span><span style=display:flex><span>  :attr_latex    <span style=color:#e6db74>&#34;#+attr_latex:&#34;</span>
</span></span><span style=display:flex><span>  :attr_html     <span style=color:#e6db74>&#34;#+attr_html:&#34;</span>
</span></span><span style=display:flex><span>  :attr_org      <span style=color:#e6db74>&#34;#+attr_org:&#34;</span>
</span></span><span style=display:flex><span>  :begin_quote   <span style=color:#e6db74>&#34;#+begin_quote&#34;</span>
</span></span><span style=display:flex><span>  :end_quote     <span style=color:#e6db74>&#34;#+end_quote&#34;</span>
</span></span><span style=display:flex><span>  :caption       <span style=color:#e6db74>&#34;#+caption:&#34;</span>
</span></span><span style=display:flex><span>  :header        <span style=color:#e6db74>&#34;#+header:&#34;</span>
</span></span><span style=display:flex><span>  :begin_export  <span style=color:#e6db74>&#34;#+begin_export&#34;</span>
</span></span><span style=display:flex><span>  :end_export    <span style=color:#e6db74>&#34;#+end_export&#34;</span>
</span></span><span style=display:flex><span>  :results       <span style=color:#e6db74>&#34;#+RESULTS:&#34;</span>
</span></span><span style=display:flex><span>  :property      <span style=color:#e6db74>&#34;:PROPERTIES:&#34;</span>
</span></span><span style=display:flex><span>  :end           <span style=color:#e6db74>&#34;:END:&#34;</span>
</span></span><span style=display:flex><span>  :priority_a    <span style=color:#e6db74>&#34;[#A]&#34;</span>
</span></span><span style=display:flex><span>  :priority_b    <span style=color:#e6db74>&#34;[#B]&#34;</span>
</span></span><span style=display:flex><span>  :priority_c    <span style=color:#e6db74>&#34;[#C]&#34;</span>
</span></span><span style=display:flex><span>  :priority_d    <span style=color:#e6db74>&#34;[#D]&#34;</span>
</span></span><span style=display:flex><span>  :priority_e    <span style=color:#e6db74>&#34;[#E]&#34;</span>)
</span></span><span style=display:flex><span>(<span style=color:#a6e22e>plist-put</span> +ligatures-extra-symbols :name <span style=color:#e6db74>&#34;⁍&#34;</span>)
</span></span></code></pre></div></li></ul><ul><li><p>Font Display</p><p>Mixed pitch is pretty great, and so is <code>+org-pretty-mode</code>. Use them together!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(add-hook! <span style=color:#e6db74>&#39;org-mode-hook</span> <span style=color:#a6e22e>#&#39;</span>+org-pretty-mode)
</span></span></code></pre></div><p>Make headings slightly bigger</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(custom-set-faces!
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-1 :weight extra-bold :height <span style=color:#ae81ff>1.25</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-2 :weight bold :height <span style=color:#ae81ff>1.15</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-3 :weight bold :height <span style=color:#ae81ff>1.12</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-4 :weight semi-bold :height <span style=color:#ae81ff>1.09</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-5 :weight semi-bold :height <span style=color:#ae81ff>1.06</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-6 :weight semi-bold :height <span style=color:#ae81ff>1.03</span>)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-8 :weight semi-bold)
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(outline-9 :weight semi-bold))
</span></span></code></pre></div><p>And the same with the title.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(custom-set-faces!
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#39;</span>(org-document-title :height <span style=color:#ae81ff>1.2</span>))
</span></span></code></pre></div><p>It seems reasonable to have deadlines in the error face when they’re passed.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-agenda-deadline-faces
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>((<span style=color:#ae81ff>1.001</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>        (<span style=color:#ae81ff>1.0</span>   <span style=color:#f92672>.</span> org-warning)
</span></span><span style=display:flex><span>        (<span style=color:#ae81ff>0.5</span>   <span style=color:#f92672>.</span> org-upcoming-deadline)
</span></span><span style=display:flex><span>        (<span style=color:#ae81ff>0.0</span>   <span style=color:#f92672>.</span> org-upcoming-distant-deadline)))
</span></span></code></pre></div><p>We can then have quote blocks stand out a bit more by making them <em>italic</em>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(setq org-fontify-quote-and-verse-blocks <span style=color:#66d9ef>t</span>)
</span></span></code></pre></div></li></ul><ul><li><p>Super agenda</p><p>A super agenda</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! org-super-agenda)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! org-super-agenda
</span></span><span style=display:flex><span>  :commands org-super-agenda-mode)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! org-agenda
</span></span><span style=display:flex><span>  (org-super-agenda-mode))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(setq org-agenda-breadcrumbs-separator  <span style=color:#e6db74>&#34; ❱ &#34;</span>
</span></span><span style=display:flex><span>      org-agenda-compact-blocks         <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      org-agenda-include-deadlines      <span style=color:#66d9ef>t</span>       <span style=color:#75715e>;; Include deadlines in the agenda</span>
</span></span><span style=display:flex><span>      org-agenda-skip-deadline-if-done  <span style=color:#66d9ef>t</span>       <span style=color:#75715e>;; Don&#39;t include deadlines in the agenda if they&#39;re in the `DONE&#39; state</span>
</span></span><span style=display:flex><span>      org-agenda-skip-scheduled-if-done <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>      org-agenda-skip-scheduled-if-done <span style=color:#66d9ef>t</span>       <span style=color:#75715e>;; Don&#39;t include items in the agenda if they&#39;re in the `DONE&#39; state</span>
</span></span><span style=display:flex><span>      org-agenda-tags-column            <span style=color:#ae81ff>100</span>     <span style=color:#75715e>;; from testing this seems to be a good value</span>
</span></span><span style=display:flex><span>      org-super-agenda-header-map       <span style=color:#66d9ef>nil</span>     <span style=color:#75715e>;; Fixes issues with evil-mode</span>
</span></span><span style=display:flex><span>      org-agenda-block-separator        <span style=color:#ae81ff>9472</span>)   <span style=color:#75715e>;; Use a straight line as separator between agenda agenda blocks</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(setq org-agenda-custom-commands
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;o&#34;</span> <span style=color:#e6db74>&#34;Overview&#34;</span>
</span></span><span style=display:flex><span>         ((agenda <span style=color:#e6db74>&#34;&#34;</span> ((org-agenda-span <span style=color:#e6db74>&#39;day</span>)
</span></span><span style=display:flex><span>                      (org-super-agenda-groups
</span></span><span style=display:flex><span>                       <span style=color:#f92672>&#39;</span>((:name <span style=color:#e6db74>&#34;Today&#34;</span>
</span></span><span style=display:flex><span>                          :time-grid <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                          :date today
</span></span><span style=display:flex><span>                          :todo <span style=color:#e6db74>&#34;TODAY&#34;</span>
</span></span><span style=display:flex><span>                          :scheduled today
</span></span><span style=display:flex><span>                          :order <span style=color:#ae81ff>1</span>)))))
</span></span><span style=display:flex><span>          (alltodo <span style=color:#e6db74>&#34;&#34;</span> ((org-agenda-overriding-header <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>                       (org-super-agenda-groups
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#39;</span>((:name <span style=color:#e6db74>&#34;Next to do&#34;</span>
</span></span><span style=display:flex><span>                           :todo <span style=color:#e6db74>&#34;NEXT&#34;</span>
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>                          (:name <span style=color:#e6db74>&#34;Important&#34;</span>
</span></span><span style=display:flex><span>                           :tag <span style=color:#e6db74>&#34;Important&#34;</span>
</span></span><span style=display:flex><span>                           :priority <span style=color:#e6db74>&#34;A&#34;</span>
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>6</span>)
</span></span><span style=display:flex><span>                          (:name <span style=color:#e6db74>&#34;Due Today&#34;</span>
</span></span><span style=display:flex><span>                           :deadline today
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>                          (:name <span style=color:#e6db74>&#34;Due Soon&#34;</span>
</span></span><span style=display:flex><span>                           :deadline future
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>8</span>)
</span></span><span style=display:flex><span>                          (:name <span style=color:#e6db74>&#34;Overdue&#34;</span>
</span></span><span style=display:flex><span>                           :deadline past
</span></span><span style=display:flex><span>                           :face <span style=color:#a6e22e>error</span>
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>7</span>)
</span></span><span style=display:flex><span>                          (:name <span style=color:#e6db74>&#34;Work&#34;</span>
</span></span><span style=display:flex><span>                           :tag <span style=color:#e6db74>&#34;Work&#34;</span>
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>                          (:name <span style=color:#e6db74>&#34;Issues&#34;</span>
</span></span><span style=display:flex><span>                           :tag <span style=color:#e6db74>&#34;Issue&#34;</span>
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>12</span>)
</span></span><span style=display:flex><span>                          (:name <span style=color:#e6db74>&#34;Emacs&#34;</span>
</span></span><span style=display:flex><span>                           :tag <span style=color:#e6db74>&#34;Emacs&#34;</span>
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>13</span>)
</span></span><span style=display:flex><span>                          (:name <span style=color:#e6db74>&#34;Projects&#34;</span>
</span></span><span style=display:flex><span>                           :tag <span style=color:#e6db74>&#34;Project&#34;</span>
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>14</span>)
</span></span><span style=display:flex><span>                          (:name <span style=color:#e6db74>&#34;Research&#34;</span>
</span></span><span style=display:flex><span>                           :tag <span style=color:#e6db74>&#34;Research&#34;</span>
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>15</span>)
</span></span><span style=display:flex><span>                          (:name <span style=color:#e6db74>&#34;To read&#34;</span>
</span></span><span style=display:flex><span>                           :tag <span style=color:#e6db74>&#34;Read&#34;</span>
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>30</span>)
</span></span><span style=display:flex><span>                          (:name <span style=color:#e6db74>&#34;Waiting&#34;</span>
</span></span><span style=display:flex><span>                           :todo <span style=color:#e6db74>&#34;WAITING&#34;</span>
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>                          (:name <span style=color:#e6db74>&#34;University&#34;</span>
</span></span><span style=display:flex><span>                           :tag <span style=color:#e6db74>&#34;uni&#34;</span>
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>32</span>)
</span></span><span style=display:flex><span>                          (:name <span style=color:#e6db74>&#34;Trivial&#34;</span>
</span></span><span style=display:flex><span>                           :priority&lt;= <span style=color:#e6db74>&#34;E&#34;</span>
</span></span><span style=display:flex><span>                           :tag (<span style=color:#e6db74>&#34;Trivial&#34;</span> <span style=color:#e6db74>&#34;Unimportant&#34;</span>)
</span></span><span style=display:flex><span>                           :todo (<span style=color:#e6db74>&#34;SOMEDAY&#34;</span> )
</span></span><span style=display:flex><span>                           :order <span style=color:#ae81ff>90</span>)
</span></span><span style=display:flex><span>                          (:discard (:tag (<span style=color:#e6db74>&#34;Chore&#34;</span> <span style=color:#e6db74>&#34;Routine&#34;</span> <span style=color:#e6db74>&#34;Daily&#34;</span>)))))))))))
</span></span></code></pre></div></li></ul><ul><li><p>Capture templates (DOCT)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! doct)
</span></span><span style=display:flex><span>(package! doct-org-roam
</span></span><span style=display:flex><span>  :recipe (:host <span style=color:#66d9ef>nil</span> :type git :repo <span style=color:#e6db74>&#34;https://gist.github.com/f9b21eeea7d7c9123dc400a30599d50d.git&#34;</span> :files (<span style=color:#e6db74>&#34;doct-org-roam.el&#34;</span>)))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! doct :commands doct)
</span></span></code></pre></div><ul><li><p>Visuals</p><p>This piece of code improves how the capturing templates look.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! org-capture
</span></span><span style=display:flex><span>  (defun org-capture-select-template-prettier (<span style=color:#66d9ef>&amp;optional</span> keys)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Select a capture template, in a prettier way than default
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Lisp programs can force the template by setting KEYS to a string.&#34;</span>
</span></span><span style=display:flex><span>    (let ((org-capture-templates
</span></span><span style=display:flex><span>          (or (org-contextualize-keys
</span></span><span style=display:flex><span>                (org-capture-upgrade-templates org-capture-templates)
</span></span><span style=display:flex><span>                org-capture-templates-contexts)
</span></span><span style=display:flex><span>              <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;t&#34;</span> <span style=color:#e6db74>&#34;Task&#34;</span> entry (file+headline <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;Tasks&#34;</span>)
</span></span><span style=display:flex><span>                  <span style=color:#e6db74>&#34;* TODO %?\n  %u\n  %a&#34;</span>)))))
</span></span><span style=display:flex><span>      (if keys
</span></span><span style=display:flex><span>          (or (<span style=color:#a6e22e>assoc</span> keys org-capture-templates)
</span></span><span style=display:flex><span>              (<span style=color:#a6e22e>error</span> <span style=color:#e6db74>&#34;No capture template referred to by \&#34;%s\&#34; keys&#34;</span> keys))
</span></span><span style=display:flex><span>        (org-mks org-capture-templates
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;Select a capture template\n━━━━━━━━━━━━━━━━━━━━━━━━━&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;Template key: &#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>`</span>((<span style=color:#e6db74>&#34;q&#34;</span> <span style=color:#f92672>,</span>(<span style=color:#a6e22e>concat</span> (all-the-icons-octicon <span style=color:#e6db74>&#34;stop&#34;</span> :face <span style=color:#e6db74>&#39;all-the-icons-red</span> :v-adjust <span style=color:#ae81ff>0.01</span>) <span style=color:#e6db74>&#34;\tAbort&#34;</span>)))))))
</span></span><span style=display:flex><span>  (advice-add <span style=color:#e6db74>&#39;org-capture-select-template</span> :override <span style=color:#a6e22e>#&#39;</span>org-capture-select-template-prettier)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun org-mks-pretty (table title <span style=color:#66d9ef>&amp;optional</span> prompt specials)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Select a member of an alist with multiple keys. Prettified.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TABLE is the alist which should contain entries where the car is a string.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>There should be two types of entries.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>1. prefix descriptions like (\&#34;a\&#34; \&#34;Description\&#34;)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  This indicates that </span><span style=color:#e6db74>`a&#39;</span><span style=color:#e6db74> is a prefix key for multi-letter selection, and
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  that there are entries following with keys like \&#34;ab\&#34;, \&#34;ax\&#34;…
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>2. Select-able members must have more than two elements, with the first
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  being the string of keys that lead to selecting it, and the second a
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  short description string of the item.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>The command will then make a temporary buffer listing all entries
</span></span></span><span style=display:flex><span><span style=color:#e6db74>that can be selected with a single key, and all the single key
</span></span></span><span style=display:flex><span><span style=color:#e6db74>prefixes.  When you press the key for a single-letter entry, it is selected.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>When you press a prefix key, the commands (and maybe further prefixes)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>under this key will be shown and offered for selection.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TITLE will be placed over the selection in the temporary buffer,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>PROMPT will be used when prompting for a key.  SPECIALS is an
</span></span></span><span style=display:flex><span><span style=color:#e6db74>alist with (\&#34;key\&#34; \&#34;description\&#34;) entries.  When one of these
</span></span></span><span style=display:flex><span><span style=color:#e6db74>is selected, only the bare key is returned.&#34;</span>
</span></span><span style=display:flex><span>    (save-window-excursion
</span></span><span style=display:flex><span>      (let ((inhibit-quit <span style=color:#66d9ef>t</span>)
</span></span><span style=display:flex><span>            (buffer (org-switch-to-buffer-other-window <span style=color:#e6db74>&#34;*Org Select*&#34;</span>))
</span></span><span style=display:flex><span>            (prompt (or prompt <span style=color:#e6db74>&#34;Select: &#34;</span>))
</span></span><span style=display:flex><span>            case-fold-search
</span></span><span style=display:flex><span>            current)
</span></span><span style=display:flex><span>        (unwind-protect
</span></span><span style=display:flex><span>            (catch <span style=color:#e6db74>&#39;exit</span>
</span></span><span style=display:flex><span>              (while <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                (setq-local evil-normal-state-cursor (<span style=color:#a6e22e>list</span> <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>                (<span style=color:#a6e22e>erase-buffer</span>)
</span></span><span style=display:flex><span>                (<span style=color:#a6e22e>insert</span> title <span style=color:#e6db74>&#34;\n\n&#34;</span>)
</span></span><span style=display:flex><span>                (let ((des-keys <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>                      (allowed-keys <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\C-g&#34;</span>))
</span></span><span style=display:flex><span>                      (tab-alternatives <span style=color:#f92672>&#39;</span>(<span style=color:#e6db74>&#34;\s&#34;</span> <span style=color:#e6db74>&#34;\t&#34;</span> <span style=color:#e6db74>&#34;\r&#34;</span>))
</span></span><span style=display:flex><span>                      (cursor-type <span style=color:#66d9ef>nil</span>))
</span></span><span style=display:flex><span>                  <span style=color:#75715e>;; Populate allowed keys and descriptions keys</span>
</span></span><span style=display:flex><span>                  <span style=color:#75715e>;; available with CURRENT selector.</span>
</span></span><span style=display:flex><span>                  (let ((re (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;\\`%s\\(.\\)\\&#39;&#34;</span>
</span></span><span style=display:flex><span>                                    (if current (<span style=color:#a6e22e>regexp-quote</span> current) <span style=color:#e6db74>&#34;&#34;</span>)))
</span></span><span style=display:flex><span>                        (prefix (if current (<span style=color:#a6e22e>concat</span> current <span style=color:#e6db74>&#34; &#34;</span>) <span style=color:#e6db74>&#34;&#34;</span>)))
</span></span><span style=display:flex><span>                    (dolist (entry table)
</span></span><span style=display:flex><span>                      (pcase entry
</span></span><span style=display:flex><span>                        <span style=color:#75715e>;; Description.</span>
</span></span><span style=display:flex><span>                        (<span style=color:#f92672>`</span>(<span style=color:#f92672>,</span>(and key (pred (<span style=color:#a6e22e>string-match</span> re))) <span style=color:#f92672>,</span>desc)
</span></span><span style=display:flex><span>                        (let ((k (match-string <span style=color:#ae81ff>1</span> key)))
</span></span><span style=display:flex><span>                          (push k des-keys)
</span></span><span style=display:flex><span>                          <span style=color:#75715e>;; Keys ending in tab, space or RET are equivalent.</span>
</span></span><span style=display:flex><span>                          (if (<span style=color:#a6e22e>member</span> k tab-alternatives)
</span></span><span style=display:flex><span>                              (push <span style=color:#e6db74>&#34;\t&#34;</span> allowed-keys)
</span></span><span style=display:flex><span>                            (push k allowed-keys))
</span></span><span style=display:flex><span>                          (<span style=color:#a6e22e>insert</span> (<span style=color:#a6e22e>propertize</span> prefix <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;font-lock-comment-face</span>) (<span style=color:#a6e22e>propertize</span> k <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;bold</span>) (<span style=color:#a6e22e>propertize</span> <span style=color:#e6db74>&#34;›&#34;</span> <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;font-lock-comment-face</span>) <span style=color:#e6db74>&#34;  &#34;</span> desc <span style=color:#e6db74>&#34;…&#34;</span> <span style=color:#e6db74>&#34;\n&#34;</span>)))
</span></span><span style=display:flex><span>                        <span style=color:#75715e>;; Usable entry.</span>
</span></span><span style=display:flex><span>                        (<span style=color:#f92672>`</span>(<span style=color:#f92672>,</span>(and key (pred (<span style=color:#a6e22e>string-match</span> re))) <span style=color:#f92672>,</span>desc <span style=color:#f92672>.</span> <span style=color:#f92672>,</span>_)
</span></span><span style=display:flex><span>                        (let ((k (match-string <span style=color:#ae81ff>1</span> key)))
</span></span><span style=display:flex><span>                          (<span style=color:#a6e22e>insert</span> (<span style=color:#a6e22e>propertize</span> prefix <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;font-lock-comment-face</span>) (<span style=color:#a6e22e>propertize</span> k <span style=color:#e6db74>&#39;face</span> <span style=color:#e6db74>&#39;bold</span>) <span style=color:#e6db74>&#34;   &#34;</span> desc <span style=color:#e6db74>&#34;\n&#34;</span>)
</span></span><span style=display:flex><span>                          (push k allowed-keys)))
</span></span><span style=display:flex><span>                        (_ <span style=color:#66d9ef>nil</span>))))
</span></span><span style=display:flex><span>                  <span style=color:#75715e>;; Insert special entries, if any.</span>
</span></span><span style=display:flex><span>                  (when specials
</span></span><span style=display:flex><span>                    (<span style=color:#a6e22e>insert</span> <span style=color:#e6db74>&#34;─────────────────────────\n&#34;</span>)
</span></span><span style=display:flex><span>                    (pcase-dolist (<span style=color:#f92672>`</span>(<span style=color:#f92672>,</span>key <span style=color:#f92672>,</span>description) specials)
</span></span><span style=display:flex><span>                      (<span style=color:#a6e22e>insert</span> (<span style=color:#a6e22e>format</span> <span style=color:#e6db74>&#34;%s   %s\n&#34;</span> (<span style=color:#a6e22e>propertize</span> key <span style=color:#e6db74>&#39;face</span> <span style=color:#f92672>&#39;</span>(bold all-the-icons-red)) description))
</span></span><span style=display:flex><span>                      (push key allowed-keys)))
</span></span><span style=display:flex><span>                  <span style=color:#75715e>;; Display UI and let user select an entry or</span>
</span></span><span style=display:flex><span>                  <span style=color:#75715e>;; a sub-level prefix.</span>
</span></span><span style=display:flex><span>                  (<span style=color:#a6e22e>goto-char</span> (<span style=color:#a6e22e>point-min</span>))
</span></span><span style=display:flex><span>                  (unless (<span style=color:#a6e22e>pos-visible-in-window-p</span> (<span style=color:#a6e22e>point-max</span>))
</span></span><span style=display:flex><span>                    (org-fit-window-to-buffer))
</span></span><span style=display:flex><span>                  (let ((pressed (org--mks-read-key allowed-keys
</span></span><span style=display:flex><span>                                                    prompt
</span></span><span style=display:flex><span>                                                    (not (<span style=color:#a6e22e>pos-visible-in-window-p</span> (<span style=color:#a6e22e>1-</span> (<span style=color:#a6e22e>point-max</span>)))))))
</span></span><span style=display:flex><span>                    (setq current (<span style=color:#a6e22e>concat</span> current pressed))
</span></span><span style=display:flex><span>                    (cond
</span></span><span style=display:flex><span>                    ((<span style=color:#a6e22e>equal</span> pressed <span style=color:#e6db74>&#34;\C-g&#34;</span>) (<span style=color:#a6e22e>user-error</span> <span style=color:#e6db74>&#34;Abort&#34;</span>))
</span></span><span style=display:flex><span>                    <span style=color:#75715e>;; Selection is a prefix: open a new menu.</span>
</span></span><span style=display:flex><span>                    ((<span style=color:#a6e22e>member</span> pressed des-keys))
</span></span><span style=display:flex><span>                    <span style=color:#75715e>;; Selection matches an association: return it.</span>
</span></span><span style=display:flex><span>                    ((let ((entry (<span style=color:#a6e22e>assoc</span> current table)))
</span></span><span style=display:flex><span>                        (and entry (throw <span style=color:#e6db74>&#39;exit</span> entry))))
</span></span><span style=display:flex><span>                    <span style=color:#75715e>;; Selection matches a special entry: return the</span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>;; selection prefix.</span>
</span></span><span style=display:flex><span>                    ((<span style=color:#a6e22e>assoc</span> current specials) (throw <span style=color:#e6db74>&#39;exit</span> current))
</span></span><span style=display:flex><span>                    (<span style=color:#66d9ef>t</span> (<span style=color:#a6e22e>error</span> <span style=color:#e6db74>&#34;No entry available&#34;</span>)))))))
</span></span><span style=display:flex><span>          (when buffer (<span style=color:#a6e22e>kill-buffer</span> buffer))))))
</span></span><span style=display:flex><span>  (advice-add <span style=color:#e6db74>&#39;org-mks</span> :override <span style=color:#a6e22e>#&#39;</span>org-mks-pretty))
</span></span></code></pre></div></li></ul><ul><li><p>Templates</p><p>Set up the actual templates for different categories.
<a href=https://www.orgmode.org/manual/Template-expansion.html>Here&rsquo;s</a> a nice overview of <code>org-capture-template</code> variables.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! org-capture
</span></span><span style=display:flex><span>  (defun +doct-icon-declaration-to-icon (declaration)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Convert :icon declaration to icon&#34;</span>
</span></span><span style=display:flex><span>    (let ((name (pop declaration))
</span></span><span style=display:flex><span>          (<span style=color:#a6e22e>set</span>  (<span style=color:#a6e22e>intern</span> (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;all-the-icons-&#34;</span> (<span style=color:#a6e22e>plist-get</span> declaration :set))))
</span></span><span style=display:flex><span>          (face (<span style=color:#a6e22e>intern</span> (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;all-the-icons-&#34;</span> (<span style=color:#a6e22e>plist-get</span> declaration :color))))
</span></span><span style=display:flex><span>          (v-adjust (or (<span style=color:#a6e22e>plist-get</span> declaration :v-adjust) <span style=color:#ae81ff>0.01</span>)))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>apply</span> <span style=color:#a6e22e>set</span> <span style=color:#f92672>`</span>(<span style=color:#f92672>,</span>name :face <span style=color:#f92672>,</span>face :v-adjust <span style=color:#f92672>,</span>v-adjust))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun +doct-iconify-capture-templates (groups)
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Add declaration&#39;s :icon to each template group in GROUPS.&#34;</span>
</span></span><span style=display:flex><span>    (let ((templates (doct-flatten-lists-in groups)))
</span></span><span style=display:flex><span>      (setq doct-templates (<span style=color:#a6e22e>mapcar</span> (lambda (template)
</span></span><span style=display:flex><span>                                     (when-let* ((props (<span style=color:#a6e22e>nthcdr</span> (if (<span style=color:#a6e22e>=</span> (<span style=color:#a6e22e>length</span> template) <span style=color:#ae81ff>4</span>) <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>5</span>) template))
</span></span><span style=display:flex><span>                                                 (spec (<span style=color:#a6e22e>plist-get</span> (<span style=color:#a6e22e>plist-get</span> props :doct) :icon)))
</span></span><span style=display:flex><span>                                       (setf (<span style=color:#a6e22e>nth</span> <span style=color:#ae81ff>1</span> template) (<span style=color:#a6e22e>concat</span> (+doct-icon-declaration-to-icon spec)
</span></span><span style=display:flex><span>                                                                      <span style=color:#e6db74>&#34;\t&#34;</span>
</span></span><span style=display:flex><span>                                                                      (<span style=color:#a6e22e>nth</span> <span style=color:#ae81ff>1</span> template))))
</span></span><span style=display:flex><span>                                     template)
</span></span><span style=display:flex><span>                                   templates))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (setq doct-after-conversion-functions <span style=color:#f92672>&#39;</span>(+doct-iconify-capture-templates))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defvar +org-capture-recipies
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>concat</span> (<span style=color:#a6e22e>file-name-as-directory</span> org-directory) <span style=color:#e6db74>&#34;capture-recipies.org&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defvar +org-capture-blog-file
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>concat</span> (<span style=color:#a6e22e>file-name-as-directory</span> org-hugo-base-dir) <span style=color:#e6db74>&#34;blog.org&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (defun set-org-capture-templates ()
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; `org-roam&#39; capture templates</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; Enabled by the `doct-org-roam&#39; package installed from gist above.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; FIXME - Can&#39;t make this work properly</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; (require &#39;doct-org-roam)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; (setq org-roam-capture-templates</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;       (doct-org-roam `((&#34;Default&#34; :keys &#34;d&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                         :type plain</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                         :file &#34;%&lt;%Y%m%d%H%M%S&gt;-${slug}.org&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                         :head &#34;#+title: ${title}\n\n&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                         :template &#34;* Hallo&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                         :unnarrowed t)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                        (&#34;Blog entry (Hugo)&#34; :keys &#34;b&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                         :headline &#34;Hugo Blog&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                         :type entry</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                         :file &#34;%&lt;%Y%m%d%H%M%S&gt;-${slug}.org&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                         :template (&#34;* %{title}&#34; &#34;:properties:&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                                    &#34;:export_file_name: %\\1&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                                    &#34;:export_description: %^{Description}&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                                    &#34;:export_date: %^{Date}t&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                                    &#34;:export_author: %n&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                                    &#34;🔚&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                                    &#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                                    &#34;%?&#34;)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                         :custom (:title &#34;%^{Title}&#34;)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                         :unnarrowed nil</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;;                         ))))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>;; `org&#39; capture templates</span>
</span></span><span style=display:flex><span>    (setq org-capture-templates
</span></span><span style=display:flex><span>          (doct <span style=color:#f92672>`</span>((<span style=color:#e6db74>&#34;Personal todo&#34;</span> :keys <span style=color:#e6db74>&#34;t&#34;</span>
</span></span><span style=display:flex><span>                   :icon (<span style=color:#e6db74>&#34;checklist&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;green&#34;</span>)
</span></span><span style=display:flex><span>                   :file +org-capture-todo-file
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :headline <span style=color:#e6db74>&#34;Inbox&#34;</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* TODO %? %^G&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%i&#34;</span>))
</span></span><span style=display:flex><span>                  (<span style=color:#e6db74>&#34;Personal note&#34;</span> :keys <span style=color:#e6db74>&#34;n&#34;</span>
</span></span><span style=display:flex><span>                   :icon (<span style=color:#e6db74>&#34;sticky-note-o&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;green&#34;</span>)
</span></span><span style=display:flex><span>                   :file +org-capture-todo-file
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :headline <span style=color:#e6db74>&#34;Inbox&#34;</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* %? %^G&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%i&#34;</span>))
</span></span><span style=display:flex><span>                  <span style=color:#75715e>;; (&#34;Roam&#34; :keys &#34;r&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#75715e>;;  :icon (&#34;pied-piper&#34; :set &#34;faicon&#34; :color &#34;pink&#34;)</span>
</span></span><span style=display:flex><span>                  <span style=color:#75715e>;;  :function org-roam-capture)</span>
</span></span><span style=display:flex><span>                  (<span style=color:#e6db74>&#34;Email&#34;</span> :keys <span style=color:#e6db74>&#34;e&#34;</span>
</span></span><span style=display:flex><span>                   :icon (<span style=color:#e6db74>&#34;envelope&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;blue&#34;</span>)
</span></span><span style=display:flex><span>                   :file +org-capture-todo-file
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :headline <span style=color:#e6db74>&#34;Inbox&#34;</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* TODO %^{type|reply to|contact} %\\3 %? ✉️&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;Send an email %^{urgancy|soon|ASAP|anon|at some point|eventually} to %^{recipiant}&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;about %^{topic}&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%U %i&#34;</span>))
</span></span><span style=display:flex><span>                  (<span style=color:#e6db74>&#34;Interesting&#34;</span> :keys <span style=color:#e6db74>&#34;i&#34;</span>
</span></span><span style=display:flex><span>                   :icon (<span style=color:#e6db74>&#34;eye&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;lcyan&#34;</span>)
</span></span><span style=display:flex><span>                   :file +org-capture-todo-file
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :headline <span style=color:#e6db74>&#34;Interesting&#34;</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* [ ] %{desc}%? :%{i-type}:&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%i&#34;</span>)
</span></span><span style=display:flex><span>                   :children ((<span style=color:#e6db74>&#34;Webpage&#34;</span> :keys <span style=color:#e6db74>&#34;w&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;globe&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;green&#34;</span>)
</span></span><span style=display:flex><span>                               :desc <span style=color:#e6db74>&#34;%(org-cliplink-capture) &#34;</span>
</span></span><span style=display:flex><span>                               :i-type <span style=color:#e6db74>&#34;read:web&#34;</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Article&#34;</span> :keys <span style=color:#e6db74>&#34;a&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;file-text&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;yellow&#34;</span>)
</span></span><span style=display:flex><span>                               :desc <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>                               :i-type <span style=color:#e6db74>&#34;read:reaserch&#34;</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;\tRecipie&#34;</span> :keys <span style=color:#e6db74>&#34;r&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;spoon&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;dorange&#34;</span>)
</span></span><span style=display:flex><span>                               :file +org-capture-recipies
</span></span><span style=display:flex><span>                               :headline <span style=color:#e6db74>&#34;Unsorted&#34;</span>
</span></span><span style=display:flex><span>                               :template <span style=color:#e6db74>&#34;%(org-chef-get-recipe-from-url)&#34;</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Information&#34;</span> :keys <span style=color:#e6db74>&#34;i&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;info-circle&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;blue&#34;</span>)
</span></span><span style=display:flex><span>                               :desc <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>                               :i-type <span style=color:#e6db74>&#34;read:info&#34;</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Idea&#34;</span> :keys <span style=color:#e6db74>&#34;I&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;bubble_chart&#34;</span> :set <span style=color:#e6db74>&#34;material&#34;</span> :color <span style=color:#e6db74>&#34;purple&#34;</span>)
</span></span><span style=display:flex><span>                               :desc <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>                               :i-type <span style=color:#e6db74>&#34;idea&#34;</span>)))
</span></span><span style=display:flex><span>                  (<span style=color:#e6db74>&#34;Tasks&#34;</span> :keys <span style=color:#e6db74>&#34;k&#34;</span>
</span></span><span style=display:flex><span>                   :icon (<span style=color:#e6db74>&#34;inbox&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;yellow&#34;</span>)
</span></span><span style=display:flex><span>                   :file +org-capture-todo-file
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :headline <span style=color:#e6db74>&#34;Tasks&#34;</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* TODO %? %^G%{extra}&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%i&#34;</span>)
</span></span><span style=display:flex><span>                   :children ((<span style=color:#e6db74>&#34;General Task&#34;</span> :keys <span style=color:#e6db74>&#34;k&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;inbox&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;green&#34;</span>)
</span></span><span style=display:flex><span>                               :extra <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Capture point Task&#34;</span> :keys <span style=color:#e6db74>&#34;c&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;pencil&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;yellow&#34;</span>)
</span></span><span style=display:flex><span>                               :extra <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Task with deadline&#34;</span> :keys <span style=color:#e6db74>&#34;d&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;timer&#34;</span> :set <span style=color:#e6db74>&#34;material&#34;</span> :color <span style=color:#e6db74>&#34;orange&#34;</span> :v-adjust <span style=color:#ae81ff>-0.1</span>)
</span></span><span style=display:flex><span>                               :extra <span style=color:#e6db74>&#34;\nDEADLINE: %^{Deadline:}t&#34;</span>)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Scheduled Task&#34;</span> :keys <span style=color:#e6db74>&#34;s&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;calendar&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;orange&#34;</span>)
</span></span><span style=display:flex><span>                               :extra <span style=color:#e6db74>&#34;\nSCHEDULED: %^{Start time:}t&#34;</span>)))
</span></span><span style=display:flex><span>                  (<span style=color:#e6db74>&#34;Project&#34;</span> :keys <span style=color:#e6db74>&#34;p&#34;</span>
</span></span><span style=display:flex><span>                   :icon (<span style=color:#e6db74>&#34;repo&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;purple&#34;</span>)
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :headline <span style=color:#e6db74>&#34;Inbox&#34;</span>
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* %{time-or-todo} %?&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%i&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%a&#34;</span>)
</span></span><span style=display:flex><span>                   :file <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>                   :custom (:time-or-todo <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>                   :children ((<span style=color:#e6db74>&#34;Project-local todo&#34;</span> :keys <span style=color:#e6db74>&#34;t&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;checklist&#34;</span> :set <span style=color:#e6db74>&#34;octicon&#34;</span> :color <span style=color:#e6db74>&#34;green&#34;</span>)
</span></span><span style=display:flex><span>                               :time-or-todo <span style=color:#e6db74>&#34;TODO&#34;</span>
</span></span><span style=display:flex><span>                               :file +org-capture-project-todo-file)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Project-local note&#34;</span> :keys <span style=color:#e6db74>&#34;n&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;sticky-note&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;yellow&#34;</span>)
</span></span><span style=display:flex><span>                               :time-or-todo <span style=color:#e6db74>&#34;%U&#34;</span>
</span></span><span style=display:flex><span>                               :file +org-capture-project-notes-file)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Project-local changelog&#34;</span> :keys <span style=color:#e6db74>&#34;c&#34;</span>
</span></span><span style=display:flex><span>                               :icon (<span style=color:#e6db74>&#34;list&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;blue&#34;</span>)
</span></span><span style=display:flex><span>                               :time-or-todo <span style=color:#e6db74>&#34;%U&#34;</span>
</span></span><span style=display:flex><span>                               :heading <span style=color:#e6db74>&#34;Unreleased&#34;</span>
</span></span><span style=display:flex><span>                               :file +org-capture-project-changelog-file)))
</span></span><span style=display:flex><span>                  (<span style=color:#e6db74>&#34;Blog&#34;</span> :keys <span style=color:#e6db74>&#34;b&#34;</span>
</span></span><span style=display:flex><span>                   :icon (<span style=color:#e6db74>&#34;pied-piper&#34;</span> :set <span style=color:#e6db74>&#34;faicon&#34;</span> :color <span style=color:#e6db74>&#34;pink&#34;</span>)
</span></span><span style=display:flex><span>                   :file +org-capture-blog-file
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* %{title} %^G&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;:properties:&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;:export_file_name: %\\1&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;:export_description: %^{Description}&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;:export_date: %^{Date}t&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;:export_lastmod: %t&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;:export_author: %n&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;🔚&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;\n%?&#34;</span>)
</span></span><span style=display:flex><span>                   :custom (:title <span style=color:#e6db74>&#34;%^{Title}&#34;</span>))
</span></span><span style=display:flex><span>                  (<span style=color:#e6db74>&#34;\t\tCentralised project templates&#34;</span>
</span></span><span style=display:flex><span>                   :keys <span style=color:#e6db74>&#34;o&#34;</span>
</span></span><span style=display:flex><span>                   :type entry
</span></span><span style=display:flex><span>                   :prepend <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>                   :template (<span style=color:#e6db74>&#34;* %{time-or-todo} %?&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%i&#34;</span>
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#34;%a&#34;</span>)
</span></span><span style=display:flex><span>                   :children ((<span style=color:#e6db74>&#34;Project todo&#34;</span>
</span></span><span style=display:flex><span>                               :keys <span style=color:#e6db74>&#34;t&#34;</span>
</span></span><span style=display:flex><span>                               :prepend <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                               :time-or-todo <span style=color:#e6db74>&#34;TODO&#34;</span>
</span></span><span style=display:flex><span>                               :heading <span style=color:#e6db74>&#34;Tasks&#34;</span>
</span></span><span style=display:flex><span>                               :file +org-capture-central-project-todo-file)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Project note&#34;</span>
</span></span><span style=display:flex><span>                               :keys <span style=color:#e6db74>&#34;n&#34;</span>
</span></span><span style=display:flex><span>                               :time-or-todo <span style=color:#e6db74>&#34;%U&#34;</span>
</span></span><span style=display:flex><span>                               :heading <span style=color:#e6db74>&#34;Notes&#34;</span>
</span></span><span style=display:flex><span>                               :file +org-capture-central-project-notes-file)
</span></span><span style=display:flex><span>                              (<span style=color:#e6db74>&#34;Project changelog&#34;</span>
</span></span><span style=display:flex><span>                               :keys <span style=color:#e6db74>&#34;c&#34;</span>
</span></span><span style=display:flex><span>                               :time-or-todo <span style=color:#e6db74>&#34;%U&#34;</span>
</span></span><span style=display:flex><span>                               :heading <span style=color:#e6db74>&#34;Unreleased&#34;</span>
</span></span><span style=display:flex><span>                               :file +org-capture-central-project-changelog-file)))
</span></span><span style=display:flex><span>                  ))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  (set-org-capture-templates)
</span></span><span style=display:flex><span>  (unless (display-graphic-p)
</span></span><span style=display:flex><span>    (add-hook <span style=color:#e6db74>&#39;server-after-make-frame-hook</span>
</span></span><span style=display:flex><span>              (defun org-capture-reinitialise-hook ()
</span></span><span style=display:flex><span>                (when (display-graphic-p)
</span></span><span style=display:flex><span>                  (set-org-capture-templates)
</span></span><span style=display:flex><span>                  (remove-hook <span style=color:#e6db74>&#39;server-after-make-frame-hook</span>
</span></span><span style=display:flex><span>                               <span style=color:#a6e22e>#&#39;</span>org-capture-reinitialise-hook))))))
</span></span></code></pre></div><p>It would also be nice to improve how the capture dialogue looks
The org-capture bin is rather nice, but I’d be nicer with a smaller frame, and no modeline.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; (setf (alist-get &#39;height +org-capture-frame-parameters) 15)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; ;; (alist-get &#39;name +org-capture-frame-parameters) &#34;❖ Capture&#34;) ;; ATM hardcoded in other places, so changing breaks stuff</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;; (setq +org-capture-fn</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;       (lambda ()</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;         (interactive)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;         (set-window-parameter nil &#39;mode-line-format &#39;none)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;         (org-capture)))</span>
</span></span></code></pre></div></li></ul></li></ul><h3 id=web-javascript-typescript>Web/Javascript/Typescript</h3><p>TODO</p><ul><li>Fix <code>.editorconfig</code> should override lsp-formatting</li><li>Must respect <code>.eslintrc</code> and <code>.prettierrc</code></li><li><code>.tsx</code> files are suuuper slow to load - figure out why!</li></ul><p>Don&rsquo;t use LSP formatting for these modes. I usually have a .editorconfig file or something..</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! web-mode
</span></span><span style=display:flex><span>  :init
</span></span><span style=display:flex><span>  (setq-hook! <span style=color:#e6db74>&#39;javascript-mode-hook</span> +format-with-lsp <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>  (setq-hook! <span style=color:#e6db74>&#39;typescript-mode-hook</span> +format-with-lsp <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>  (setq-hook! <span style=color:#e6db74>&#39;typescript-tsx-mode-hook</span> +format-with-lsp <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>  :custom
</span></span><span style=display:flex><span>  (web-mode-markup-indent-offset <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>  (web-mode-code-indent-offset   <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>  (web-mode-sql-indent-offset    <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>  (web-mode-css-indent-offset    <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>  (tab-width                     <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>  (evil-shift-width              <span style=color:#ae81ff>2</span>))
</span></span></code></pre></div><h3 id=python>Python</h3><h3 id=elixir>Elixir</h3><p>Install some extra flycheck packages for Elixir</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! flycheck-credo)
</span></span><span style=display:flex><span>(package! flycheck-dialyxir)
</span></span><span style=display:flex><span>(package! polymode)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! (elixir flycheck lsp-ui)
</span></span><span style=display:flex><span>  (flycheck-credo-setup)
</span></span><span style=display:flex><span>  (flycheck-dialyxir-setup)
</span></span><span style=display:flex><span>  (flycheck-add-next-checker <span style=color:#e6db74>&#39;lsp-ui</span> <span style=color:#e6db74>&#39;elixir-credo</span>))
</span></span></code></pre></div><p>Enable inline syntax highlighting for <code>~H</code> sigils.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! polymode
</span></span><span style=display:flex><span>  :init (setq web-mode-engines-alist <span style=color:#f92672>&#39;</span>((<span style=color:#e6db74>&#34;elixir&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;\\.ex\\&#39;&#34;</span>)))
</span></span><span style=display:flex><span>  <span style=color:#75715e>;; :hook (elixir-mode . poly-elixir-web-mode)         ;; messes up rest of elixir-mode - enable manually for now!</span>
</span></span><span style=display:flex><span>  :config
</span></span><span style=display:flex><span>  (define-hostmode poly-elixir-hostmode :mode <span style=color:#e6db74>&#39;elixir-mode</span>)
</span></span><span style=display:flex><span>  (define-innermode poly-liveview-expr-elixir-innermode
</span></span><span style=display:flex><span>    :mode <span style=color:#e6db74>&#39;web-mode</span>
</span></span><span style=display:flex><span>    :head-matcher (rx line-start (<span style=color:#a6e22e>*</span> space) <span style=color:#e6db74>&#34;~H&#34;</span> (<span style=color:#a6e22e>=</span> <span style=color:#ae81ff>3</span> (char <span style=color:#e6db74>&#34;\&#34;&#39;&#34;</span>)) line-end)
</span></span><span style=display:flex><span>    :tail-matcher (rx line-start (<span style=color:#a6e22e>*</span> space) (<span style=color:#a6e22e>=</span> <span style=color:#ae81ff>3</span> (char <span style=color:#e6db74>&#34;\&#34;&#39;&#34;</span>)) line-end)
</span></span><span style=display:flex><span>    :head-mode <span style=color:#e6db74>&#39;host</span>
</span></span><span style=display:flex><span>    :tail-mode <span style=color:#e6db74>&#39;host</span>
</span></span><span style=display:flex><span>    :allow-nested <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>    :keep-in-mode <span style=color:#e6db74>&#39;host</span>
</span></span><span style=display:flex><span>    :fallback-mode <span style=color:#e6db74>&#39;host</span>)
</span></span><span style=display:flex><span>  (define-polymode poly-elixir-web-mode
</span></span><span style=display:flex><span>    :hostmode <span style=color:#e6db74>&#39;poly-elixir-hostmode</span>
</span></span><span style=display:flex><span>    :innermodes <span style=color:#f92672>&#39;</span>(poly-liveview-expr-elixir-innermode)))
</span></span></code></pre></div><h3 id=dotnet>Dotnet</h3><h4 id=c-sharp>C-sharp</h4><p>NOTE: After too many hours struggling with <code>omnisharp-rosly</code> without managing to make it work,
I settles on just using <code>csharp-ls</code>.
Let&rsquo;s revisit <code>omnisharp-roslyn</code> at a later point.</p><p>The default &ldquo;latest&rdquo; release of omnisharp-roslyn does not target .NET 6 SDK. We override the default
and downloads a newer release that&rsquo;s compatible with .NET 6. See <a href=https://github.com/OmniSharp/omnisharp-roslyn/issues/2407#issuecomment-1170354657>this</a> Github issue for more details.
Omnisharp-roslyn releases can be found <a href=https://github.com/OmniSharp/omnisharp-roslyn/releases>here</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#75715e>;; (after! lsp-csharp</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;   (setq lsp-csharp-omnisharp-roslyn-download-url (cond ((eq system-type &#39;darwin) &#34;https://github.com/OmniSharp/omnisharp-roslyn/releases/download/v1.39.0/omnisharp-osx-x64-net6.0.zip&#34;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;                                                        ((eq system-type &#39;gnu/linux) &#34;https://github.com/OmniSharp/omnisharp-roslyn/releases/download/v1.39.0/omnisharp-linux-x64-net6.0.zip&#34;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;                                                        ((eq system-type &#39;windown-nt) &#34;https://github.com/OmniSharp/omnisharp-roslyn/releases/download/v1.39.0/omnisharp-win-x64-net6.0.zip&#34;)))</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;   (setq lsp-csharp-server-path (f-join lsp-csharp-omnisharp-roslyn-server-dir &#34;OmniSharp&#34;))</span>
</span></span><span style=display:flex><span><span style=color:#75715e>;;   )</span>
</span></span></code></pre></div><p>NOTE: <code>lsp-csharp</code> appends &ldquo;-lsp&rdquo; at the end of &ldquo;OmniSharp&rdquo; command. This seems to not work too great with new version (and should be fixed upstreams).</p><p>Just changing the <code>lsp-csharp-omnisharp-roslyn-download-url</code> didn&rsquo;t work for me, so I manually downloaded the
zip file and extracted it to the <code>lsp-csharp-omnisharp-roslyn-server-dir</code> directory.</p><p>On MacOS, the &ldquo;Malicious Software&rdquo; warning triggered when trying to start the lsp-server, so I had to
whiteliste all the files in the directory manually.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ xattr -r -d com.apple.quarantine ~/.emacs.d-doom/.local/etc/lsp/omnisharp-roslyn/latest/omnisharp-roslyn/*
</span></span></code></pre></div><p>Add the <code>dotnet.el</code> package and load it with <code>c-sharp-mode</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(package! dotnet)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(use-package! dotnet
</span></span><span style=display:flex><span>  :hook (csharp-mode <span style=color:#f92672>.</span> dotnet-mode))
</span></span></code></pre></div><ul><li><p>Keybindings</p><p>Add the <code>sharper-main-transient</code> menu to local leader.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :map csharp-mode-map
</span></span><span style=display:flex><span>      :after csharp
</span></span><span style=display:flex><span>      :localleader
</span></span><span style=display:flex><span>      :desc <span style=color:#e6db74>&#34;Sharper&#34;</span> <span style=color:#e6db74>&#34;s&#34;</span> <span style=color:#a6e22e>#&#39;</span>sharper-main-transient)
</span></span></code></pre></div></li></ul><h3 id=rust>Rust</h3><p><a href=https://robert.kra.hn/posts/rust-emacs-setup/>Here</a> is a good guide for setting up Emacs for Rust development.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! rustic
</span></span><span style=display:flex><span>  (setq rustic-lsp-server <span style=color:#e6db74>&#39;rust-analyzer</span>
</span></span><span style=display:flex><span>        rustic-format-on-save <span style=color:#66d9ef>t</span>))
</span></span></code></pre></div><p>Rebind <code>rustic</code> shortcuts to the <code>localleader</code> menu.</p><p><code>Rustic</code> is an extension of <code>rust-mode</code> which adds a number of useful features. Most <code>rustic</code> features are bound to the <code>C-c C-c</code>
prefix, which I finds a bit cumbersome. Let&rsquo;s rebind them to the <code>localleader</code> so we have them easy accessible.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(map! :map rustic-mode-map
</span></span><span style=display:flex><span>      :after rustic
</span></span><span style=display:flex><span>      :localleader
</span></span><span style=display:flex><span>      (:prefix (<span style=color:#e6db74>&#34;r&#34;</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;rustic&#34;</span>)
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;recompile&#34;</span>               <span style=color:#e6db74>&#34;TAB&#34;</span>   <span style=color:#a6e22e>#&#39;</span>rustic-recompile
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-add&#34;</span>               <span style=color:#e6db74>&#34;a&#34;</span>     <span style=color:#a6e22e>#&#39;</span>rustic-cargo-add
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-bench&#34;</span>             <span style=color:#e6db74>&#34;b&#34;</span>     <span style=color:#a6e22e>#&#39;</span>rustic-cargo-bench
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-clean&#34;</span>             <span style=color:#e6db74>&#34;c&#34;</span>     <span style=color:#a6e22e>#&#39;</span>rustic-cargo-clean
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-doc&#34;</span>               <span style=color:#e6db74>&#34;d&#34;</span>     <span style=color:#a6e22e>#&#39;</span>rustic-cargo-doc
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-clippy-fix&#34;</span>        <span style=color:#e6db74>&#34;f&#34;</span>     <span style=color:#a6e22e>#&#39;</span>rustic-cargo-clippy-fix
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-init&#34;</span>              <span style=color:#e6db74>&#34;i&#34;</span>     <span style=color:#a6e22e>#&#39;</span>rustic-cargo-init
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-clippy&#34;</span>            <span style=color:#e6db74>&#34;k&#34;</span>     <span style=color:#a6e22e>#&#39;</span>rustic-cargo-clippy
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-new&#34;</span>               <span style=color:#e6db74>&#34;n&#34;</span>     <span style=color:#a6e22e>#&#39;</span>rustic-cargo-new
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-rm&#34;</span>                <span style=color:#e6db74>&#34;r&#34;</span>     <span style=color:#a6e22e>#&#39;</span>rustic-cargo-rm
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-upgrade&#34;</span>           <span style=color:#e6db74>&#34;u&#34;</span>     <span style=color:#a6e22e>#&#39;</span>rustic-cargo-upgrade
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;docstring-dwim&#34;</span>          <span style=color:#e6db74>&#34;C-,&#34;</span>   <span style=color:#a6e22e>#&#39;</span>rustic-cargo-docstring-dwim
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-build&#34;</span>             <span style=color:#e6db74>&#34;C-b&#34;</span>   <span style=color:#a6e22e>#&#39;</span>rustic-cargo-build
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-current-test&#34;</span>      <span style=color:#e6db74>&#34;C-c&#34;</span>   <span style=color:#a6e22e>#&#39;</span>rustic-cargo-current-test
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;racer-describe&#34;</span>          <span style=color:#e6db74>&#34;C-d&#34;</span>   <span style=color:#a6e22e>#&#39;</span>rustic-racer-describe
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-fmt&#34;</span>               <span style=color:#e6db74>&#34;C-f&#34;</span>   <span style=color:#a6e22e>#&#39;</span>rustic-cargo-upgrade
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-check&#34;</span>             <span style=color:#e6db74>&#34;C-k&#34;</span>   <span style=color:#a6e22e>#&#39;</span>rustic-cargo-check
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-clippy&#34;</span>            <span style=color:#e6db74>&#34;C-l&#34;</span>   <span style=color:#a6e22e>#&#39;</span>rustic-cargo-clippy
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-outdated&#34;</span>          <span style=color:#e6db74>&#34;C-n&#34;</span>   <span style=color:#a6e22e>#&#39;</span>rustic-cargo-outdated
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;format-buffer&#34;</span>           <span style=color:#e6db74>&#34;C-o&#34;</span>   <span style=color:#a6e22e>#&#39;</span>rustic-format-buffer
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-run&#34;</span>               <span style=color:#e6db74>&#34;C-r&#34;</span>   <span style=color:#a6e22e>#&#39;</span>rustic-cargo-run
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;cargo-test&#34;</span>              <span style=color:#e6db74>&#34;C-t&#34;</span>   <span style=color:#a6e22e>#&#39;</span>rustic-cargo-test
</span></span><span style=display:flex><span>       :desc <span style=color:#e6db74>&#34;compile&#34;</span>                 <span style=color:#e6db74>&#34;C-u&#34;</span>   <span style=color:#a6e22e>#&#39;</span>rustic-compile)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#75715e>;; lsp-rust-analyzer keybindings on localleader</span>
</span></span><span style=display:flex><span>       (:when (<span style=color:#a6e22e>eq</span> rustic-lsp-server <span style=color:#e6db74>&#39;rust-analyzer</span>)
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Open Cargo.toml file&#34;</span>    <span style=color:#e6db74>&#34;c&#34;</span>     <span style=color:#a6e22e>#&#39;</span>lsp-rust-analyzer-open-cargo-toml
</span></span><span style=display:flex><span>        :desc <span style=color:#e6db74>&#34;Open external docs&#34;</span>      <span style=color:#e6db74>&#34;D&#34;</span>     <span style=color:#a6e22e>#&#39;</span>lsp-rust-analyzer-open-external-docs))
</span></span></code></pre></div><p>Advice the <code>*cargo-run*</code> buffer to accept user input (why doesn&rsquo;t it already?).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! rustic
</span></span><span style=display:flex><span>  (defadvice! rustic-cargo-run-accept-user-input ()
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Advices the *cargo-run* buffer to run in comint-mode and accept user input&#34;</span>
</span></span><span style=display:flex><span>    :after <span style=color:#e6db74>&#39;rustic-cargo-run</span>
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (let ((current-window (<span style=color:#a6e22e>selected-window</span>))
</span></span><span style=display:flex><span>          (cargo-window (display-buffer (<span style=color:#a6e22e>get-buffer</span> <span style=color:#e6db74>&#34;*cargo-run*&#34;</span>) <span style=color:#66d9ef>nil</span> <span style=color:#e6db74>&#39;visible</span>)))
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>select-window</span> cargo-window)
</span></span><span style=display:flex><span>      (comint-mode)
</span></span><span style=display:flex><span>      (read-only-mode <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>select-window</span> current-window))))
</span></span></code></pre></div><h4 id=lsp>LSP</h4><p>Configures <code>lsp-mode</code> hints for Rust (using <code>rust-analyzer</code>)
(From <a href=https://robert.kra.hn/posts/rust-emacs-setup/>rust-emacs-setup</a> guide)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! (rustic lsp-mode)
</span></span><span style=display:flex><span>  (when (<span style=color:#a6e22e>eq</span> rustic-lsp-server <span style=color:#e6db74>&#39;rust-analyzer</span>)
</span></span><span style=display:flex><span>    (setq lsp-eldoc-render-all                                                  <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>          lsp-rust-analyzer-cargo-watch-command                                 <span style=color:#e6db74>&#34;clippy&#34;</span>
</span></span><span style=display:flex><span>          lsp-rust-analyzer-display-chaining-hints                              <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>          lsp-rust-analyzer-display-closure-return-type-hints                   <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>          lsp-rust-analyzer-display-lifetime-elision-hints-enable               <span style=color:#e6db74>&#34;skip_trivial&#34;</span>
</span></span><span style=display:flex><span>          lsp-rust-analyzer-display-lifetime-elision-hints-use-parameter-names  <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>          lsp-rust-analyzer-display-parameter-hints                             <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>          lsp-rust-analyzer-display-reborrow-hints                              <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>          lsp-rust-analyzer-server-display-inlay-hints                          <span style=color:#66d9ef>t</span>)))
</span></span></code></pre></div><p>Configures <code>lsp-ui</code> for Rust</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! (rustic lsp-ui-mode)
</span></span><span style=display:flex><span>  (setq lsp-ui-peek-always-show         <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        lsp-ui-sideline-show-hover      <span style=color:#66d9ef>t</span>
</span></span><span style=display:flex><span>        lsp-ui-doc-enable               <span style=color:#66d9ef>nil</span>))
</span></span></code></pre></div><h4 id=debugging>Debugging</h4><p>Configures <code>dap-mode</code> for Rust.</p><p>We need to do some additional work for setting up debugging.
(From <a href=https://robert.kra.hn/posts/rust-emacs-setup/>rust-emacs-setup</a> guide)</p><ol><li>Install <code>llvm</code> and <code>cmake</code> via homebrew</li><li>Checkout the <a href=https://github.com/lldb-tools/lldb-mi>lldb-mi</a> repo</li><li>Build the <code>lldb-mi</code> binary</li><li>Link to a location in <code>$PATH</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ brew install cmake llvm
</span></span><span style=display:flex><span>$ export LLVM_DIR<span style=color:#f92672>=</span>/usr/local/Cellar/llvm/14.0.6/lib/cmake
</span></span><span style=display:flex><span>$ git clone https://github.com/lldb-tools/lldb-mi ~/.local/src/lldb-mi
</span></span><span style=display:flex><span>$ mkdir -p ~/.local/src/lldb-mi/build
</span></span><span style=display:flex><span>$ cd ~/.local/src/lldb-mi/build
</span></span><span style=display:flex><span>$ cmake ..
</span></span><span style=display:flex><span>$ cmake --build .
</span></span><span style=display:flex><span>$ ln -s $PWD/src/lldb-mi ~/.local/bin/lldb-mi
</span></span></code></pre></div><p>TODO - Should set LLVM_DIR a better way?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span>(after! (rustic dap-mode)
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;dap-lldb</span>)
</span></span><span style=display:flex><span>  (require <span style=color:#e6db74>&#39;dap-gdb-lldb</span>)
</span></span><span style=display:flex><span>  (dap-gdb-lldb-setup)
</span></span><span style=display:flex><span>  (dap-register-debug-template <span style=color:#e6db74>&#34;Rust::LLDB Run Configuration&#34;</span>
</span></span><span style=display:flex><span>                               (<span style=color:#a6e22e>list</span> :type      <span style=color:#e6db74>&#34;lldb&#34;</span>
</span></span><span style=display:flex><span>                                     :request   <span style=color:#e6db74>&#34;launch&#34;</span>
</span></span><span style=display:flex><span>                                     :name      <span style=color:#e6db74>&#34;LLDB::Run&#34;</span>
</span></span><span style=display:flex><span>                                     :gdbpath   <span style=color:#e6db74>&#34;rust-lldb&#34;</span>
</span></span><span style=display:flex><span>                                     :target     <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>                                     :cwd       <span style=color:#66d9ef>nil</span>)))
</span></span></code></pre></div><blockquote><p>(dap-gdb-lldb-setup) will install a VS Code extension into user-emacs-dir/.extension/vscode/webfreak.debug.
One problem I observed was that this installation is not always successful. Should you end up without
a “webfreak.debug” directory you might need to delete the vscode/ folder and
run (dap-gdb-lldb-setup) again.</p></blockquote><p>EDIT - It turns out my &ldquo;webfreak.debug&rdquo; directory is empty - Figure this out at some time!</p><p>Finally run <code>sudo DevToolsSecurity --enable</code> to allow the debugger access to processes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ sudo DevToolsSecurity --enable
</span></span><span style=display:flex><span>Enter PIN <span style=color:#66d9ef>for</span> <span style=color:#e6db74>&#39;Certificate For PIV Authentication (Yubico PIV Authentication)&#39;</span>:
</span></span><span style=display:flex><span>Developer mode is now enabled.
</span></span></code></pre></div></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://rhblind.github.io/tags/org-mode/>org-mode</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg><span class=tag><a href=https://rhblind.github.io/categories/emacs/>emacs</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>11217 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2022-08-14</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"/><line x1="1.05" y1="12" x2="7" y2="12"/><line x1="17.01" y1="12" x2="22.96" y2="12"/></svg><a href=a362077aa0ae8441b14ea6755241d1941117c697 target=_blank rel=noopener>a362077</a>
@ 2022-08-14</p></div><div class=pagination><div class=pagination__buttons><span class="button next"><a href=https://rhblind.github.io/posts/2022/08/a-shameless-plug/><span class=button__text>A shameless plug</span>
<span class=button__icon>→</span></a></span></div></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>Powered by <a rel="noreferrer noopener nofollow" target=_blank href=https://gohugo.io/>Hugo</a> and <a rel="noreferrer noopener nofollow" target=_blank href=https://orgmode.org/>Org Mode</a> &#10084;</span></div></div></footer></div><script type=text/javascript src=https://rhblind.github.io/bundle.min.feebdc8d801e3fb1791305e362b6d11557f029604dd5b3c27e2686bc88787ee90ae1ccf0afe81bd7d959d7617cfe1fc73062aa82b4e1fa830d6941193d2cbddf.js integrity="sha512-/uvcjYAeP7F5EwXjYrbRFVfwKWBN1bPCfiaGvIh4fukK4czwr+gb19lZ12F8/h/HMGKqgrTh+oMNaUEZPSy93w=="></script></body></html>